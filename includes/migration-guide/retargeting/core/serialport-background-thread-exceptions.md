### <a name="serialport-background-thread-exceptions"></a><span data-ttu-id="d07b0-101">SerialPort 后台线程异常</span><span class="sxs-lookup"><span data-stu-id="d07b0-101">SerialPort background thread exceptions</span></span>

|   |   |
|---|---|
|<span data-ttu-id="d07b0-102">详细信息</span><span class="sxs-lookup"><span data-stu-id="d07b0-102">Details</span></span>|<span data-ttu-id="d07b0-103">引发操作系统异常时，使用 <xref:System.IO.Ports.SerialPort> 流创建的后台线程不再终止进程。在面向 .NET Framework 4.7 及早期版本的应用程序中，当使用 <xref:System.IO.Ports.SerialPort> 流创建的后台线程上引发了操作系统异常时，进程将终止。在面向 .NET Framework 4.7.1 或更高版本的应用程序中，后台线程等待与活动串行端口相关的操作系统事件，并可能在某些情况下崩溃，例如突然删除串行端口。</span><span class="sxs-lookup"><span data-stu-id="d07b0-103">Background threads created with <xref:System.IO.Ports.SerialPort> streams no longer terminate the process when OS exceptions are thrown.In applications that target the .NET Framework 4.7 and earlier versions, a process is terminated when an operating system exception is thrown on a background thread created with a <xref:System.IO.Ports.SerialPort> stream.In applications that target the .NET Framework 4.7.1 or a later version, background threads wait for OS events related to the active serial port and could crash in some cases, such as sudden removal of the serial port.</span></span>|
|<span data-ttu-id="d07b0-104">建议</span><span class="sxs-lookup"><span data-stu-id="d07b0-104">Suggestion</span></span>|<span data-ttu-id="d07b0-105">对于面向 .NET Framework 4.7.1 的应用，如果无需异常处理，可通过将以下内容添加到 <code>app.config</code> 文件的 <code>&lt;runtime&gt;</code> 部分，从而选择不用异常处理：</span><span class="sxs-lookup"><span data-stu-id="d07b0-105">For apps that target the .NET Framework 4.7.1, you can opt out of the exception handling if it is not desirable by adding the following to the <code>&lt;runtime&gt;</code> section of your <code>app.config</code> file:</span></span><pre><code class="language-xml">&lt;runtime&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.System.IO.Ports.DoNotCatchSerialStreamThreadExceptions=true&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;</code></pre><span data-ttu-id="d07b0-106">对于面向旧版 .NET Framework，但在 .NET Framework 4.7.1 或更高版本上运行的应用，可通过将以下内容添加到 <code>app.config</code> 文件的 <code>&lt;runtime&gt;</code> 部分来选择使用异常处理：</span><span class="sxs-lookup"><span data-stu-id="d07b0-106">For apps that target earlier versions of the .NET Framework but run on the .NET Framework 4.7.1 or later, you can opt in to the exception handling by adding the following to the <code>&lt;runtime&gt;</code> section of your <code>app.config</code> file:</span></span><pre><code class="language-xml">&lt;runtime&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.System.IO.Ports.DoNotCatchSerialStreamThreadExceptions=false&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;</code></pre>|
|<span data-ttu-id="d07b0-107">范围</span><span class="sxs-lookup"><span data-stu-id="d07b0-107">Scope</span></span>|<span data-ttu-id="d07b0-108">次要</span><span class="sxs-lookup"><span data-stu-id="d07b0-108">Minor</span></span>|
|<span data-ttu-id="d07b0-109">版本</span><span class="sxs-lookup"><span data-stu-id="d07b0-109">Version</span></span>|<span data-ttu-id="d07b0-110">4.7.1</span><span class="sxs-lookup"><span data-stu-id="d07b0-110">4.7.1</span></span>|
|<span data-ttu-id="d07b0-111">类型</span><span class="sxs-lookup"><span data-stu-id="d07b0-111">Type</span></span>|<span data-ttu-id="d07b0-112">重定目标</span><span class="sxs-lookup"><span data-stu-id="d07b0-112">Retargeting</span></span>|
|<span data-ttu-id="d07b0-113">受影响的 API</span><span class="sxs-lookup"><span data-stu-id="d07b0-113">Affected APIs</span></span>|<ul><li><xref:System.IO.Ports.SerialPort?displayProperty=nameWithType></li></ul>|

