### <a name="accessibility-improvements-in-windows-forms-controls"></a><span data-ttu-id="4d52a-101">Windows 窗体控件中的辅助功能改进</span><span class="sxs-lookup"><span data-stu-id="4d52a-101">Accessibility improvements in Windows Forms controls</span></span>

|   |   |
|---|---|
|<span data-ttu-id="4d52a-102">详细信息</span><span class="sxs-lookup"><span data-stu-id="4d52a-102">Details</span></span>|<span data-ttu-id="4d52a-103">Windows 窗体正在使用辅助功能技术改进工作方式，以更好地支持 Windows 窗体客户。</span><span class="sxs-lookup"><span data-stu-id="4d52a-103">Windows Forms is improving how it works with accessibility technologies to better support Windows Forms customers.</span></span> <span data-ttu-id="4d52a-104">包括从 .NET Framework 4.7.1 开始的以下改进：</span><span class="sxs-lookup"><span data-stu-id="4d52a-104">These include the following changes starting with the .NET Framework 4.7.1:</span></span><ul><li><span data-ttu-id="4d52a-105">改进高对比度模式的显示效果。</span><span class="sxs-lookup"><span data-stu-id="4d52a-105">Changes to improve display during High Contrast mode.</span></span></li><li><span data-ttu-id="4d52a-106">提升属性浏览器体验。</span><span class="sxs-lookup"><span data-stu-id="4d52a-106">Changes to improve the property browser experience.</span></span> <span data-ttu-id="4d52a-107">属性浏览器改进包括：</span><span class="sxs-lookup"><span data-stu-id="4d52a-107">Property browser improvements include:</span></span></li><li><span data-ttu-id="4d52a-108">更好地通过各种下拉选择窗口使用键盘导航。</span><span class="sxs-lookup"><span data-stu-id="4d52a-108">Better keyboard navigation through the various drop-down selection windows.</span></span></li><li><span data-ttu-id="4d52a-109">减少不必要的制表位。</span><span class="sxs-lookup"><span data-stu-id="4d52a-109">Reduced unnecessary tab stops.</span></span></li><li><span data-ttu-id="4d52a-110">更好地报告控件类型。</span><span class="sxs-lookup"><span data-stu-id="4d52a-110">Better reporting of control types.</span></span></li><li><span data-ttu-id="4d52a-111">改进了讲述人行为。</span><span class="sxs-lookup"><span data-stu-id="4d52a-111">Improved narrator behavior.</span></span></li><li><span data-ttu-id="4d52a-112">在控件中实现缺少 UI 辅助功能模式。</span><span class="sxs-lookup"><span data-stu-id="4d52a-112">Changes to implement missing UI accessibility patterns in controls.</span></span></li></ul>|
|<span data-ttu-id="4d52a-113">建议</span><span class="sxs-lookup"><span data-stu-id="4d52a-113">Suggestion</span></span>|<span data-ttu-id="4d52a-114"><strong>如何选择启用或弃用这些更改</strong></span><span class="sxs-lookup"><span data-stu-id="4d52a-114"><strong>How to opt in or out of these changes</strong></span></span></br><span data-ttu-id="4d52a-115">为使应用程序从这些更改获益，它必须在 .NET Framework 4.7.1 或更高版本上运行。</span><span class="sxs-lookup"><span data-stu-id="4d52a-115">In order for the application to benefit from these changes, it must run on the .NET Framework 4.7.1 or later.</span></span> <span data-ttu-id="4d52a-116">此应用程序可通过以下任何一种方式从这些更改中获益：</span><span class="sxs-lookup"><span data-stu-id="4d52a-116">The application can benefit from these changes in either of the following ways:</span></span><ul><li><span data-ttu-id="4d52a-117">重新编译为面向 .NET Framework 4.7.1。</span><span class="sxs-lookup"><span data-stu-id="4d52a-117">It is recompiled to target the .NET Framework 4.7.1.</span></span> <span data-ttu-id="4d52a-118">对于面向 .NET Framework 4.7.1 或更高版本的 Windows 窗体 应用程序，这些辅助功能默认情况下处于启用状态。</span><span class="sxs-lookup"><span data-stu-id="4d52a-118">These accessibility changes are enabled by default on Windows Forms applications that target the .NET Framework 4.7.1 or later.</span></span></li><li><span data-ttu-id="4d52a-119">通过向 app config 文件的 <code>&lt;runtime&gt;</code> 部分添加以下 [AppContext 交换机](~/docs/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md)并将其设置为 <code>false</code>，可选择退出旧版辅助功能行为，如下例所示。</span><span class="sxs-lookup"><span data-stu-id="4d52a-119">It opts out of the legacy accessibility behaviors by adding the following [AppContext switch](~/docs/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md) to the <code>&lt;runtime&gt;</code> section of the app.config file and setting it to <code>false</code>, as the following example shows.</span></span></li></ul><pre><code class="lang-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;startup&gt;&#13;&#10;&lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.7&quot;/&gt;&#13;&#10;&lt;/startup&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;!-- AppContextSwitchOverrides value attribute is in the form of &#39;key1=true/false;key2=true/false  --&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.UseLegacyAccessibilityFeatures=false&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre></br><span data-ttu-id="4d52a-120">面向 .NET Framework 4.7.1 或更高版本并希望保留旧版辅助功能行为的应用程序，可通过将此 AppContext 开关显式设置为 <code>true</code> 来选择启用旧版辅助功能。</span><span class="sxs-lookup"><span data-stu-id="4d52a-120">Applications that target the .NET Framework 4.7.1 or later and want to preserve the legacy accessibility behavior can opt in to the use of legacy accessibility features by explicitly setting this AppContext switch to <code>true</code>.</span></span><p/><span data-ttu-id="4d52a-121">有关 UI 自动化的概述，请参阅 [UI 自动化概述](~/docs/framework/ui-automation/ui-automation-overview.md)。&lt;/p/&gt;</span><span class="sxs-lookup"><span data-stu-id="4d52a-121">For an overview of UI automation, see the [UI Automation Overview](~/docs/framework/ui-automation/ui-automation-overview.md).&lt;/p/&gt;</span></span><p/><span data-ttu-id="4d52a-122"><strong>为 UI 自动化模式和属性添加的支持</strong></span><span class="sxs-lookup"><span data-stu-id="4d52a-122"><strong>Added support for UI Automation patterns and properties</strong></span></span><br/><span data-ttu-id="4d52a-123">辅助功能客户端可通过使用常用的公开描述调用模式来利用新的 WinForms 辅助功能。</span><span class="sxs-lookup"><span data-stu-id="4d52a-123">Accessibility clients can take advantage of new WinForms accessibility functionality by using common, publicly described invocation patterns.</span></span> <span data-ttu-id="4d52a-124">这些模式并非特定于 WinForms。</span><span class="sxs-lookup"><span data-stu-id="4d52a-124">These patterns are not WinForms-specific.</span></span> <span data-ttu-id="4d52a-125">例如，辅助功能客户端可以在 IAccessible 接口 (MAAS) 上调用 QueryInterface 方法，来获取 IServiceProvider 接口。</span><span class="sxs-lookup"><span data-stu-id="4d52a-125">For instance, accessibility clients can call the QueryInterface method on the IAccessible interface (MAAS) to obtain an IServiceProvider interface.</span></span> <span data-ttu-id="4d52a-126">如果该接口可用，则客户端可以使用其 QueryService 方法来请求 IAccessibleEx 接口。</span><span class="sxs-lookup"><span data-stu-id="4d52a-126">If this interface is available, clients can use its QueryService method to request an IAccessibleEx interface.</span></span> <span data-ttu-id="4d52a-127">有关详细信息，请参阅[从客户端使用 IAccessibleEx](https://msdn.microsoft.com/library/windows/desktop/dd561924.aspx)。</span><span class="sxs-lookup"><span data-stu-id="4d52a-127">For more information, see [Using IAccessibleEx from a Client](https://msdn.microsoft.com/library/windows/desktop/dd561924.aspx).</span></span> <span data-ttu-id="4d52a-128">从 .NET Framework 4.7.1 开始，IServiceProvider 和 [IAccessibleEx](https://msdn.microsoft.com/library/windows/desktop/dd561898.aspx)（在适用情况下）可用于 WinForms 辅助功能对象。</span><span class="sxs-lookup"><span data-stu-id="4d52a-128">Starting with the .NET Framework 4.7.1, IServiceProvider and [IAccessibleEx](https://msdn.microsoft.com/library/windows/desktop/dd561898.aspx) (where applicable) are available for WinForms accessibility objects.</span></span><p/><span data-ttu-id="4d52a-129">.NET Framework 4.7.1 添加了对以下 UI 自动化模式和属性的支持：</span><span class="sxs-lookup"><span data-stu-id="4d52a-129">The .NET Framework 4.7.1 adds support for the following UI automation patterns and properties:</span></span><ul><li><span data-ttu-id="4d52a-130"><xref:System.Windows.Forms.ToolStripSplitButton> 和 <xref:System.Windows.Forms.ComboBox> 控件支持[展开/折叠模式](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)。</span><span class="sxs-lookup"><span data-stu-id="4d52a-130">The <xref:System.Windows.Forms.ToolStripSplitButton> and <xref:System.Windows.Forms.ComboBox> controls support the [Expand/Collapse pattern](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</span></span></li><li><span data-ttu-id="4d52a-131"><xref:System.Windows.Forms.ToolStripMenuItem> 控件具有 [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) 属性值 <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="4d52a-131">The <xref:System.Windows.Forms.ToolStripMenuItem> control has a [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) property value <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</span></span></li><li><span data-ttu-id="4d52a-132"><xref:System.Windows.Forms.ToolStripItem> 控件支持 <xref:System.Windows.Automation.AutomationElement.NameProperty> 属性和[展开/折叠模式](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)。</span><span class="sxs-lookup"><span data-stu-id="4d52a-132">The <xref:System.Windows.Forms.ToolStripItem> control supports the <xref:System.Windows.Automation.AutomationElement.NameProperty> property and the [Expand/Collapse pattern](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</span></span></li><li><span data-ttu-id="4d52a-133"><xref:System.Windows.Forms.ToolStripDropDownItem> 控件支持 <xref:System.Windows.Forms.AccessibleEvents> 在下拉列表展开或折叠时指示 StateChange 和 NameChange。</span><span class="sxs-lookup"><span data-stu-id="4d52a-133">The <xref:System.Windows.Forms.ToolStripDropDownItem> control supports <xref:System.Windows.Forms.AccessibleEvents> indicating StateChange and NameChange when drop down is expanded or collapsed.</span></span></li><li><span data-ttu-id="4d52a-134"><xref:System.Windows.Forms.ToolStripDropDownButton> 控件具有 <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType> 的 [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) 属性值。</span><span class="sxs-lookup"><span data-stu-id="4d52a-134">The <xref:System.Windows.Forms.ToolStripDropDownButton> control has a [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) property value of <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</span></span></li><li><span data-ttu-id="4d52a-135"><xref:System.Windows.Forms.DataGridViewCheckBoxCell> 控件支持 <xref:System.Windows.Automation.TogglePattern>。</span><span class="sxs-lookup"><span data-stu-id="4d52a-135">The <xref:System.Windows.Forms.DataGridViewCheckBoxCell> control supports the <xref:System.Windows.Automation.TogglePattern>.</span></span></li><li><span data-ttu-id="4d52a-136"><xref:System.Windows.Forms.NumericUpDown> 和 <xref:System.Windows.Forms.DomainUpDown> 控件支持 <xref:System.Windows.Automation.AutomationElement.NameProperty> 属性并具有 <xref:System.Windows.Automation.ControlType.Spinner?displayProperty=nameWithType> 的 [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-spinner-control-type.md)。</span><span class="sxs-lookup"><span data-stu-id="4d52a-136">The <xref:System.Windows.Forms.NumericUpDown> and <xref:System.Windows.Forms.DomainUpDown> controls support the <xref:System.Windows.Automation.AutomationElement.NameProperty> property and have a [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-spinner-control-type.md) of <xref:System.Windows.Automation.ControlType.Spinner?displayProperty=nameWithType>.</span></span></p></li></ul><span data-ttu-id="4d52a-137"><strong>对 PropertyGrid 控件的改进</strong></span><span class="sxs-lookup"><span data-stu-id="4d52a-137"><strong>Improvements to the PropertyGrid control</strong></span></span></br><span data-ttu-id="4d52a-138">.NET Framework 4.7.1 对 PropertyBrowser 控件添加了以下改进：</span><span class="sxs-lookup"><span data-stu-id="4d52a-138">The .NET Framework 4.7.1 adds the following improvements to the PropertyBrowser control:</span></span><ul><li><span data-ttu-id="4d52a-139">如果用户在 <xref:System.Windows.Forms.PropertyGrid> 控件中输入错误值，则会显示错误对话框，该对话框中的“详细信息”按钮支持[展开/折叠模式](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)、状态和名称更改通知以及带有 <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType> 值的 [ControlType]~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) 属性。</span><span class="sxs-lookup"><span data-stu-id="4d52a-139">The <strong>Details</strong> button in the error dialog that is displayed when the user enters an incorrect value in the <xref:System.Windows.Forms.PropertyGrid> control supports the [Expand/Collapse pattern](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md), state and name change notifications, and a [ControlType]~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) property with a value of <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</span></span></li><li><span data-ttu-id="4d52a-140">展开错误对话框的“详细信息”按钮时显示的信息窗格，现在可以通过键盘访问并允许讲述人宣布错误信息内容。</span><span class="sxs-lookup"><span data-stu-id="4d52a-140">The message pane displayed when the <strong>Details</strong> button of the error dialog is expanded is now keyboard accessible and allows Narrator to announce the content of the error message.</span></span></li><li><span data-ttu-id="4d52a-141"><xref:System.Windows.Forms.PropertyGrid> 控件中的 <xref:System.Windows.Forms.AccessibleRole> 行已从&quot;行&quot;更改为&quot;单元格&quot;。</span><span class="sxs-lookup"><span data-stu-id="4d52a-141">The <xref:System.Windows.Forms.AccessibleRole> of rows in the <xref:System.Windows.Forms.PropertyGrid> control have changed from &quot;Row&quot; to &quot;Cell&quot;.</span></span> <span data-ttu-id="4d52a-142">映射到 UIA ControlType &quot;DataItem&quot; 的单元，使其支持相应的键盘快捷方式和讲述人朗读。</span><span class="sxs-lookup"><span data-stu-id="4d52a-142">The cell maps to UIA ControlType &quot;DataItem&quot;, which allows it to support appropriate keyboard shortcuts and Narrator announcements.</span></span></li><li><span data-ttu-id="4d52a-143"><xref:System.Windows.Forms.PropertyGrid> 控件行，当 <xref:System.Windows.Forms.PropertyGrid> 控件设置为 <xref:System.Windows.Forms.PropertySort.Categorized?displayProperty=nameWithType> 的 <xref:System.Windows.Forms.PropertyGrid.PropertySort> 属性具有 <xref:System.Windows.Automation.ControlType.Button?displayProperty=nameWithType> 的 [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) 属性值时，它代表标头项。</span><span class="sxs-lookup"><span data-stu-id="4d52a-143">The <xref:System.Windows.Forms.PropertyGrid> control rows that represent header items when the <xref:System.Windows.Forms.PropertyGrid> control has a <xref:System.Windows.Forms.PropertyGrid.PropertySort> property set to <xref:System.Windows.Forms.PropertySort.Categorized?displayProperty=nameWithType> have a [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) property value of <xref:System.Windows.Automation.ControlType.Button?displayProperty=nameWithType>.</span></span></li><li><span data-ttu-id="4d52a-144"><xref:System.Windows.Forms.PropertyGrid> 控件行，当 <xref:System.Windows.Forms.PropertyGrid> 控件设置为 <xref:System.Windows.Forms.PropertySort.Categorized?displayProperty=nameWithType> 的 <xref:System.Windows.Forms.PropertyGrid.PropertySort> 属性支持[展开/折叠模式](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)时，它代表标头项。</span><span class="sxs-lookup"><span data-stu-id="4d52a-144">The <xref:System.Windows.Forms.PropertyGrid> control rows that represent header items when the <xref:System.Windows.Forms.PropertyGrid> control has a <xref:System.Windows.Forms.PropertyGrid.PropertySort>  property set to <xref:System.Windows.Forms.PropertySort.Categorized?displayProperty=nameWithType> support the [Expand/Collapse pattern](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</span></span></li><li><span data-ttu-id="4d52a-145">改进了网格与其上工具栏之间的键盘导航。</span><span class="sxs-lookup"><span data-stu-id="4d52a-145">Improved keyboard navigation between the grid and the ToolBar above it.</span></span> <span data-ttu-id="4d52a-146">,现在按 &quot;Shift-Tab&quot; 会选中第一个工具栏按钮而不是整个工具栏。</span><span class="sxs-lookup"><span data-stu-id="4d52a-146">Pressing &quot;Shift-Tab&quot; now selects the first ToolBar button, instead of the whole ToolBar.</span></span></li><li><span data-ttu-id="4d52a-147">在高对比度模式中显示的 <xref:System.Windows.Forms.PropertyGrid> 控件现在将围绕与当前 <xref:System.Windows.Forms.PropertyGrid.PropertySort> 属性值相对应的工具栏按钮绘制焦点矩形。</span><span class="sxs-lookup"><span data-stu-id="4d52a-147"><xref:System.Windows.Forms.PropertyGrid> controls displayed in High Contrast mode will now draw a focus rectangle around the ToolBar button which corresponds to the current <xref:System.Windows.Forms.PropertyGrid.PropertySort> property value.</span></span></li><li><span data-ttu-id="4d52a-148">在高对比度模式中显示 <xref:System.Windows.Forms.PropertyGrid> 控件且 <xref:System.Windows.Forms.PropertyGrid.PropertySort> 属性设置为 <xref:System.Windows.Forms.PropertySort.Categorized?displayProperty=nameWithType>，现在将以高对比度颜色显示类别标题的背景。</span><span class="sxs-lookup"><span data-stu-id="4d52a-148"><xref:System.Windows.Forms.PropertyGrid> controls displayed in High Contrast mode and with a <xref:System.Windows.Forms.PropertyGrid.PropertySort> property set to <xref:System.Windows.Forms.PropertySort.Categorized?displayProperty=nameWithType> will now display the background of category headers in a highly contrasting color.</span></span></li><li><span data-ttu-id="4d52a-149"><xref:System.Windows.Forms.PropertyGrid> 控件更好地区分具有焦点的工具栏项和指示 <xref:System.Windows.Forms.PropertyGrid.PropertySort> 属性当前值的工具栏项。</span><span class="sxs-lookup"><span data-stu-id="4d52a-149"><xref:System.Windows.Forms.PropertyGrid> controls better differentiates between ToolBar items with focus and the ToolBar items which indicate the current value of the <xref:System.Windows.Forms.PropertyGrid.PropertySort> property.</span></span> <span data-ttu-id="4d52a-150">此修补程序包含高对比度更改和非高对比度方案的更改。</span><span class="sxs-lookup"><span data-stu-id="4d52a-150">This fix consists of a High Contrast change and a change for non-High Contrast scenarios.</span></span></li><li><span data-ttu-id="4d52a-151">指示 <xref:System.Windows.Forms.PropertyGrid.PropertySort> 属性当前值的 <xref:System.Windows.Forms.PropertyGrid> 控件工具栏项支持 <xref:System.Windows.Automation.TogglePattern>。</span><span class="sxs-lookup"><span data-stu-id="4d52a-151"><xref:System.Windows.Forms.PropertyGrid> control ToolBar items which indicates the current value of the <xref:System.Windows.Forms.PropertyGrid.PropertySort> property support the <xref:System.Windows.Automation.TogglePattern>.</span></span></li><li><span data-ttu-id="4d52a-152">改进的讲述人支持在对齐方式选择器中区分所选对齐。</span><span class="sxs-lookup"><span data-stu-id="4d52a-152">Improved Narrator support for distinguishing the selected alignment in the Alignment Picker.</span></span></li><li><span data-ttu-id="4d52a-153">当窗体上显示空 <xref:System.Windows.Forms.PropertyGrid> 控件时，现可将焦点置于其上，而之前不能。</span><span class="sxs-lookup"><span data-stu-id="4d52a-153">When an empty <xref:System.Windows.Forms.PropertyGrid> control is displayed on a form, it will now receive focus where previously it would not.</span></span></p></li></ul><span data-ttu-id="4d52a-154"><strong>在高对比度主题中使用 OS 定义的颜色</strong></span><span class="sxs-lookup"><span data-stu-id="4d52a-154"><strong>Use of OS-defined colors in High Contrast themes</strong></span></span></br><ul><li><span data-ttu-id="4d52a-155"><xref:System.Windows.Forms.Button> 和 <xref:System.Windows.Forms.CheckBox> 控件的 <xref:System.Windows.Forms.ButtonBase.FlatStyle> 属性设置为 <xref:System.Windows.Forms.FlatStyle.System?displayProperty=nameWithType>（默认样式），现在，在高对比度主题中选中这两个控件时，它们会使用 OS 定义的颜色。</span><span class="sxs-lookup"><span data-stu-id="4d52a-155">The <xref:System.Windows.Forms.Button> and <xref:System.Windows.Forms.CheckBox> controls with their <xref:System.Windows.Forms.ButtonBase.FlatStyle> property set to <xref:System.Windows.Forms.FlatStyle.System?displayProperty=nameWithType>, which is the default style, now use OS-defined colors in High Contrast theme when selected.</span></span> <span data-ttu-id="4d52a-156">以前，文本和背景颜色对比度低，难以阅读。</span><span class="sxs-lookup"><span data-stu-id="4d52a-156">Previously, text and background colors were not contrasting and were hard to read.</span></span></li><li><span data-ttu-id="4d52a-157">将 <xref:System.Windows.Forms.Control.Enabled> 属性设置为“false”的 <xref:System.Windows.Forms.Button>、<xref:System.Windows.Forms.CheckBox>、<xref:System.Windows.Forms.RadioButton>、<xref:System.Windows.Forms.Label>、<xref:System.Windows.Forms.LinkLabel> 和 <xref:System.Windows.Forms.GroupBox> 控件，在高对比度主题中使用阴影颜色呈现文本，降低与背景的对比度。</span><span class="sxs-lookup"><span data-stu-id="4d52a-157">The <xref:System.Windows.Forms.Button>, <xref:System.Windows.Forms.CheckBox>, <xref:System.Windows.Forms.RadioButton>, <xref:System.Windows.Forms.Label>, <xref:System.Windows.Forms.LinkLabel> and <xref:System.Windows.Forms.GroupBox> controls with their <xref:System.Windows.Forms.Control.Enabled> property set to <strong>false</strong> used a shaded color to render text in High Contrast themes, resulting in low contrast against the background.</span></span> <span data-ttu-id="4d52a-158">现在这些控件使用 OS 定义的&quot;无效文本&quot;颜色。</span><span class="sxs-lookup"><span data-stu-id="4d52a-158">Now these controls use the &quot;Disabled Text&quot; color defined by the OS.</span></span> <span data-ttu-id="4d52a-159">此修补程序适用于将 <code>FlatStyle</code> 属性设置为某个值而不是 <xref:System.Windows.Forms.FlatStyle.System?displayProperty=nameWithType> 的控件。</span><span class="sxs-lookup"><span data-stu-id="4d52a-159">This fix applies to controls with their <code>FlatStyle</code> property set to a value other than <xref:System.Windows.Forms.FlatStyle.System?displayProperty=nameWithType>.</span></span> <span data-ttu-id="4d52a-160">后一种控件由 OS 呈现。</span><span class="sxs-lookup"><span data-stu-id="4d52a-160">The latter controls are rendered by the OS.</span></span></li><li><span data-ttu-id="4d52a-161"><xref:System.Windows.Forms.DataGridView> 现在围绕具有当前焦点的单元内容呈现可见的矩形。</span><span class="sxs-lookup"><span data-stu-id="4d52a-161"><xref:System.Windows.Forms.DataGridView> now renders a visible rectangle around the content of the cell which has the current focus.</span></span> <span data-ttu-id="4d52a-162">以前，在某些高对比度主题中这是不可见的。</span><span class="sxs-lookup"><span data-stu-id="4d52a-162">Previously, this was not visible in certain High Contrast themes.</span></span></li><li><span data-ttu-id="4d52a-163">将 <xref:System.Windows.Forms.ToolStripMenuItem.Enabled> 属性设置为“false”的 <xref:System.Windows.Forms.ToolStripMenuItem> 控件现在使用 OS 定义的&quot;无效文本&quot;颜色。</span><span class="sxs-lookup"><span data-stu-id="4d52a-163"><xref:System.Windows.Forms.ToolStripMenuItem> controls with their <xref:System.Windows.Forms.ToolStripMenuItem.Enabled> property set to <strong>false</strong> now use the &quot;Disabled Text&quot; color defined by the OS.</span></span></li><li><span data-ttu-id="4d52a-164">将 <xref:System.Windows.Forms.ToolStripMenuItem.Checked> 属性设置为“true”的 <xref:System.Windows.Forms.ToolStripMenuItem> 控件现以系统颜色的对比色呈现相关复选标记。</span><span class="sxs-lookup"><span data-stu-id="4d52a-164"><xref:System.Windows.Forms.ToolStripMenuItem> controls with their <xref:System.Windows.Forms.ToolStripMenuItem.Checked> property set to <strong>true</strong> now render the associated check mark in a contrasting system color.</span></span>  <span data-ttu-id="4d52a-165">以前，复选标记颜色的对比度不足，在高对比度主题中不可见。</span><span class="sxs-lookup"><span data-stu-id="4d52a-165">Previously the check mark color was not contrasting enough and not visible in High Contrast themes.</span></span></li></ul><span data-ttu-id="4d52a-166">请注意：Windows 10 已更改部分高对比度系统颜色的值。</span><span class="sxs-lookup"><span data-stu-id="4d52a-166">NOTE: Windows 10 has changed values for some high contrast system colors.</span></span> <span data-ttu-id="4d52a-167">Windows 窗体框架基于 Win32 框架。</span><span class="sxs-lookup"><span data-stu-id="4d52a-167">Windows Forms Framework is based on the Win32 framework.</span></span> <span data-ttu-id="4d52a-168">为获得最佳体验，请运行最新版本的 Windows，并通过在测试应用程序中添加 app.manifest 文件选择使用最新的 OS 更改，同时取消注释以下代码：</span><span class="sxs-lookup"><span data-stu-id="4d52a-168">For the best experience, run on the latest version of Windows and opt in to the latest OS changes by adding an app.manifest file in a test application and uncommenting the following code:</span></span><pre><code class="lang-xml">&lt;!-- Windows 10 --&gt;&#13;&#10;&lt;supportedOS Id=&quot;{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}&quot; /&gt;&#13;&#10;</code></pre></br><span data-ttu-id="4d52a-169"><strong>改进了的键盘导航</strong></span><span class="sxs-lookup"><span data-stu-id="4d52a-169"><strong>Improved keyboard navigation</strong></span></span><ul><li><span data-ttu-id="4d52a-170">当 <xref:System.Windows.Forms.ComboBox> 控件将其 <xref:System.Windows.Forms.ComboBox.DropDownStyle> 属性设置为 <xref:System.Windows.Forms.ComboBoxStyle.DropDownList?displayProperty=nameWithType> 并且为窗体上 Tab 键顺序中的第一个控件时，在使用键盘打开父级窗体时，该控件现在将显示焦点矩形。</span><span class="sxs-lookup"><span data-stu-id="4d52a-170">When a <xref:System.Windows.Forms.ComboBox> control has its <xref:System.Windows.Forms.ComboBox.DropDownStyle> property set to <xref:System.Windows.Forms.ComboBoxStyle.DropDownList?displayProperty=nameWithType> and is the first control in the tab order on the form, it now displays a focus rectangle when the parent form is opened using the keyboard.</span></span> <span data-ttu-id="4d52a-171">在此更改之前，键盘焦点在控件上，但不会呈现焦点指示器。</span><span class="sxs-lookup"><span data-stu-id="4d52a-171">Before this change, keyboard focus was on this control, but a focus indicator was not rendered.</span></span></li></ul><span data-ttu-id="4d52a-172"><strong>改进了讲述人支持</strong></span><span class="sxs-lookup"><span data-stu-id="4d52a-172"><strong>Improved Narrator support</strong></span></span><ul><li><span data-ttu-id="4d52a-173"><xref:System.Windows.Forms.MonthCalendar> 控件对访问控件添加了辅助技术支持，包括使讲述人朗读控件值的功能（以前无法读取）。</span><span class="sxs-lookup"><span data-stu-id="4d52a-173">The <xref:System.Windows.Forms.MonthCalendar> control has added support for assistive technologies to access the control, including the ability for Narrator to read the value of the control when previously it could not.</span></span></li><li><span data-ttu-id="4d52a-174">当 <xref:System.Windows.Forms.CheckBox.CheckState?displayProperty=nameWithType> 属性发生更改时，<xref:System.Windows.Forms.CheckedListBox> 控件现在会通知讲述人。</span><span class="sxs-lookup"><span data-stu-id="4d52a-174">The <xref:System.Windows.Forms.CheckedListBox> control now notifies Narrator when a <xref:System.Windows.Forms.CheckBox.CheckState?displayProperty=nameWithType> property has been changed.</span></span> <span data-ttu-id="4d52a-175">以前，讲述人不会收到通知，因此在 <xref:System.Windows.Forms.CheckBox.CheckState> 属性更新时，用户也不会收到通知。</span><span class="sxs-lookup"><span data-stu-id="4d52a-175">Previously, Narrator did not receive notification and as a result users would not be informed that the <xref:System.Windows.Forms.CheckBox.CheckState> property had been updated.</span></span></li><li><span data-ttu-id="4d52a-176"><xref:System.Windows.Forms.LinkLabel> 控件更改了通知讲述人控件文本的方式。</span><span class="sxs-lookup"><span data-stu-id="4d52a-176">The <xref:System.Windows.Forms.LinkLabel> control has changed the way it notifies Narrator of the text of in the control.</span></span> <span data-ttu-id="4d52a-177">以前，讲述人公布此文本两次并将 &quot;&amp;&quot; 符号作为实际文本进行朗读，即使这些符号对用户不可见。</span><span class="sxs-lookup"><span data-stu-id="4d52a-177">Previously, Narrator announced this text twice and read &quot;&amp;&quot; symbols as real text even though they are not visible to a user.</span></span> <span data-ttu-id="4d52a-178">已从讲述人朗读中删除重复的文本以及不必要的 &quot;&amp;&quot; 符号。</span><span class="sxs-lookup"><span data-stu-id="4d52a-178">The duplicated text was removed from the Narrator announcements, as well as unnecessary &quot;&amp;&quot; symbols.</span></span></li><li><span data-ttu-id="4d52a-179"><xref:System.Windows.Forms.DataGridViewCell> 控件类型现在正确地向讲述人和其他辅助技术报告只读状态。</span><span class="sxs-lookup"><span data-stu-id="4d52a-179">The <xref:System.Windows.Forms.DataGridViewCell> control types now correctly report the read-only status to Narrator and other assistive technologies.</span></span></li><li><span data-ttu-id="4d52a-180">讲述人现在可在 [多文档界面]~/docs/framework/winforms/advanced/multiple-document-interface-mdi-applications.md) 应用程序中读取子窗口的系统菜单。</span><span class="sxs-lookup"><span data-stu-id="4d52a-180">Narrator is now able to read the System Menu of child windows in [Multiple-Document Interface]~/docs/framework/winforms/advanced/multiple-document-interface-mdi-applications.md) applications.</span></span></li><li><span data-ttu-id="4d52a-181">讲述人现在能朗读将 <xref:System.Windows.Forms.ToolStripItem.Enabled?displayProperty=nameWithType> 属性设置为 <strong>false</strong> 的 <xref:System.Windows.Forms.ToolStripMenuItem> 控件。</span><span class="sxs-lookup"><span data-stu-id="4d52a-181">Narrator is now able to read <xref:System.Windows.Forms.ToolStripMenuItem> controls with a <xref:System.Windows.Forms.ToolStripItem.Enabled?displayProperty=nameWithType> property set to <strong>false</strong>.</span></span> <span data-ttu-id="4d52a-182">以前，讲述人无法将焦点置于已禁用的菜单项来朗读内容。</span><span class="sxs-lookup"><span data-stu-id="4d52a-182">Previously, Narrator was unable to focus on disabled menu items to read the content.</span></span></li></ul>|
|<span data-ttu-id="4d52a-183">范围</span><span class="sxs-lookup"><span data-stu-id="4d52a-183">Scope</span></span>|<span data-ttu-id="4d52a-184">主要</span><span class="sxs-lookup"><span data-stu-id="4d52a-184">Major</span></span>|
|<span data-ttu-id="4d52a-185">版本</span><span class="sxs-lookup"><span data-stu-id="4d52a-185">Version</span></span>|<span data-ttu-id="4d52a-186">4.7.1</span><span class="sxs-lookup"><span data-stu-id="4d52a-186">4.7.1</span></span>|
|<span data-ttu-id="4d52a-187">类型</span><span class="sxs-lookup"><span data-stu-id="4d52a-187">Type</span></span>|<span data-ttu-id="4d52a-188">重定目标</span><span class="sxs-lookup"><span data-stu-id="4d52a-188">Retargeting</span></span>|
|<span data-ttu-id="4d52a-189">受影响的 API</span><span class="sxs-lookup"><span data-stu-id="4d52a-189">Affected APIs</span></span>|<ul><li><xref:System.Windows.Forms.ToolStripDropDownButton.CreateAccessibilityInstance?displayProperty=nameWithType></li><li><xref:System.Windows.Forms.DomainUpDown.DomainUpDownAccessibleObject.Name?displayProperty=nameWithType></li><li>[<span data-ttu-id="4d52a-190">MonthCalendar.AccessibilityObject</span><span class="sxs-lookup"><span data-stu-id="4d52a-190">MonthCalendar.AccessibilityObject</span></span>](xref:System.Windows.Forms.Control.AccessibilityObject)</li></ul>|

