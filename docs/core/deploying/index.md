---
title: 应用程序发布
description: 了解如何发布 .NET Core 应用程序。 .NET Core 可以发布特定于平台或跨平台的应用。 可将应用发布为独立应用或依赖于运行时的应用。 每个模式都会影响用户运行应用的方式。
ms.date: 01/31/2020
ms.openlocfilehash: 696cca436c73601a3e7825033152d43a659a7dce
ms.sourcegitcommit: 700ea803fb06c5ce98de017c7f76463ba33ff4a9
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/19/2020
ms.locfileid: "77448979"
---
# <a name="net-core-application-publishing-overview"></a><span data-ttu-id="6f2c8-106">.NET Core 应用程序发布概述</span><span class="sxs-lookup"><span data-stu-id="6f2c8-106">.NET Core application publishing overview</span></span>

<span data-ttu-id="6f2c8-107">可在两种模式下发布使用 .NET Core 创建的应用程序，模式会影响用户运行应用的方式。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-107">Applications you create with .NET Core can be published in two different modes, and the mode affects how a user runs your app.</span></span>

<span data-ttu-id="6f2c8-108">将应用作为独立应用，生成的应用程序将包含 .NET Core 运行时和库，以及该应用程序及其依赖项。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-108">Publishing your app as *self-contained* produces an application that includes the .NET Core runtime and libraries, and your application and its dependencies.</span></span> <span data-ttu-id="6f2c8-109">应用程序的用户可以在未安装 .NET Core 运行时的计算机上运行该应用程序。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-109">Users of the application can run it on a machine that doesn't have the .NET Core runtime installed.</span></span> 

<span data-ttu-id="6f2c8-110">将应用发布为依赖于运行时的应用，生成的应用程序仅包含该应用程序本身及其依赖项。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-110">Publishing your app as *runtime-dependent* produces an application that includes only your application itself and its dependencies.</span></span> <span data-ttu-id="6f2c8-111">应用程序的用户必须单独安装 .NET Core 运行时。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-111">Users of the application have to separately install the .NET Core runtime.</span></span>

<span data-ttu-id="6f2c8-112">默认情况下，这两种发布模式都会生成特定于平台的可执行文件。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-112">Both publishing modes produce a platform-specific executable by default.</span></span> <span data-ttu-id="6f2c8-113">不使用可执行文件也可以创建依赖于运行时的应用程序，这些应用程序是跨平台的。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-113">Runtime-dependent applications can be created without an executable, and these applications are cross-platform.</span></span>

<span data-ttu-id="6f2c8-114">生成可执行文件时，可以使用运行时标识符 (RID) 指定目标平台。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-114">When an executable is produced, you can specify the target platform with a runtime identifier (RID).</span></span> <span data-ttu-id="6f2c8-115">有关 RID 的详细信息，请参阅 [.NET Core RID 目录](../rid-catalog.md)。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-115">For more information about RIDs, see [.NET Core RID Catalog](../rid-catalog.md).</span></span>

<span data-ttu-id="6f2c8-116">下表概述了每个 SDK 版本用于将应用发布为依赖于运行时的应用或独立应用的命令：</span><span class="sxs-lookup"><span data-stu-id="6f2c8-116">The following table outlines the commands used to publish an app as runtime-dependent or self-contained, per SDK version:</span></span>

| <span data-ttu-id="6f2c8-117">类型</span><span class="sxs-lookup"><span data-stu-id="6f2c8-117">Type</span></span>                                                                                 | <span data-ttu-id="6f2c8-118">SDK 2.1</span><span class="sxs-lookup"><span data-stu-id="6f2c8-118">SDK 2.1</span></span> | <span data-ttu-id="6f2c8-119">SDK 3.x</span><span class="sxs-lookup"><span data-stu-id="6f2c8-119">SDK 3.x</span></span> | <span data-ttu-id="6f2c8-120">命令</span><span class="sxs-lookup"><span data-stu-id="6f2c8-120">Command</span></span> |
| -----------------------------------------------------------------------------------  | ------- | ------- | ------- |
| <span data-ttu-id="6f2c8-121">适用于当前平台的[依赖于运行时的可执行文件](#publish-runtime-dependent)。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-121">[runtime-dependent executable](#publish-runtime-dependent) for the current platform.</span></span> |         | <span data-ttu-id="6f2c8-122">✔️</span><span class="sxs-lookup"><span data-stu-id="6f2c8-122">✔️</span></span>      | [`dotnet publish`](../tools/dotnet-publish.md) |
| <span data-ttu-id="6f2c8-123">适用于特定平台的[依赖于运行时的可执行文件](#publish-runtime-dependent)。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-123">[runtime-dependent executable](#publish-runtime-dependent) for a specific platform.</span></span>  |         | <span data-ttu-id="6f2c8-124">✔️</span><span class="sxs-lookup"><span data-stu-id="6f2c8-124">✔️</span></span>      | [`dotnet publish -r <RID> --self-contained false`](../tools/dotnet-publish.md) |
| <span data-ttu-id="6f2c8-125">[依赖于运行时的跨平台二进制文件](#publish-runtime-dependent)。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-125">[runtime-dependent cross-platform binary](#publish-runtime-dependent).</span></span>               | <span data-ttu-id="6f2c8-126">✔️</span><span class="sxs-lookup"><span data-stu-id="6f2c8-126">✔️</span></span>      | <span data-ttu-id="6f2c8-127">✔️</span><span class="sxs-lookup"><span data-stu-id="6f2c8-127">✔️</span></span>      | [`dotnet publish`](../tools/dotnet-publish.md) |
| <span data-ttu-id="6f2c8-128">[独立可执行文件](#publish-self-contained)。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-128">[self-contained executable](#publish-self-contained).</span></span>                                | <span data-ttu-id="6f2c8-129">✔️</span><span class="sxs-lookup"><span data-stu-id="6f2c8-129">✔️</span></span>      | <span data-ttu-id="6f2c8-130">✔️</span><span class="sxs-lookup"><span data-stu-id="6f2c8-130">✔️</span></span>      | [`dotnet publish -r <RID>`](../tools/dotnet-publish.md) |

<span data-ttu-id="6f2c8-131">有关详细信息，请参阅 [.NET Core dotnet publish 命令](../tools/dotnet-publish.md)。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-131">For more information, see [.NET Core dotnet publish command](../tools/dotnet-publish.md).</span></span>

## <a name="produce-an-executable"></a><span data-ttu-id="6f2c8-132">生成可执行文件</span><span class="sxs-lookup"><span data-stu-id="6f2c8-132">Produce an executable</span></span>

<span data-ttu-id="6f2c8-133">可执行文件不是跨平台的。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-133">Executables aren't cross-platform.</span></span> <span data-ttu-id="6f2c8-134">它们特定于操作系统和 CPU 体系结构。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-134">They're specific to an operating system and CPU architecture.</span></span> <span data-ttu-id="6f2c8-135">发布应用并创建可执行文件时，可以将应用发布为[独立应用](#publish-self-contained)或[依赖于运行时的应用](#publish-runtime-dependent)。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-135">When publishing your app and creating an executable, you can publish the app as [self-contained](#publish-self-contained) or [runtime-dependent](#publish-runtime-dependent).</span></span> <span data-ttu-id="6f2c8-136">将应用发布为独立应用，会在应用中包含 .NET Core 运行时，该应用的用户无需在运行应用前安装 .NET Core。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-136">Publishing an app as self-contained includes the .NET Core runtime with the app, and users of the app don't have to worry about installing .NET Core before running the app.</span></span> <span data-ttu-id="6f2c8-137">如果将应用发布为依赖于运行时的应用，则该应用不包含 .NET Core 运行时和库，而仅包含该应用和第三方依赖项。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-137">Apps published as runtime-dependent don't include the .NET Core runtime and libraries; only the app and 3rd-party dependencies are included.</span></span>

<span data-ttu-id="6f2c8-138">以下命令可生成可执行文件：</span><span class="sxs-lookup"><span data-stu-id="6f2c8-138">The following commands produce an executable:</span></span>

| <span data-ttu-id="6f2c8-139">类型</span><span class="sxs-lookup"><span data-stu-id="6f2c8-139">Type</span></span>                                                                                 | <span data-ttu-id="6f2c8-140">SDK 2.1</span><span class="sxs-lookup"><span data-stu-id="6f2c8-140">SDK 2.1</span></span> | <span data-ttu-id="6f2c8-141">SDK 3.x</span><span class="sxs-lookup"><span data-stu-id="6f2c8-141">SDK 3.x</span></span> | <span data-ttu-id="6f2c8-142">命令</span><span class="sxs-lookup"><span data-stu-id="6f2c8-142">Command</span></span> |
| ------------------------------------------------------------------------------------ | ------- | ------- | ------- |
| <span data-ttu-id="6f2c8-143">适用于当前平台的[依赖于运行时的可执行文件](#publish-runtime-dependent)。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-143">[runtime-dependent executable](#publish-runtime-dependent) for the current platform.</span></span> |         | <span data-ttu-id="6f2c8-144">✔️</span><span class="sxs-lookup"><span data-stu-id="6f2c8-144">✔️</span></span>      | [`dotnet publish`](../tools/dotnet-publish.md) |
| <span data-ttu-id="6f2c8-145">适用于特定平台的[依赖于运行时的可执行文件](#publish-runtime-dependent)。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-145">[runtime-dependent executable](#publish-runtime-dependent) for a specific platform.</span></span>  |         | <span data-ttu-id="6f2c8-146">✔️</span><span class="sxs-lookup"><span data-stu-id="6f2c8-146">✔️</span></span>      | [`dotnet publish -r <RID> --self-contained false`](../tools/dotnet-publish.md) |
| <span data-ttu-id="6f2c8-147">[独立可执行文件](#publish-self-contained)。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-147">[self-contained executable](#publish-self-contained).</span></span>                                | <span data-ttu-id="6f2c8-148">✔️</span><span class="sxs-lookup"><span data-stu-id="6f2c8-148">✔️</span></span>      | <span data-ttu-id="6f2c8-149">✔️</span><span class="sxs-lookup"><span data-stu-id="6f2c8-149">✔️</span></span>      | [`dotnet publish -r <RID>`](../tools/dotnet-publish.md) |

## <a name="produce-a-cross-platform-binary"></a><span data-ttu-id="6f2c8-150">生成跨平台二进制文件</span><span class="sxs-lookup"><span data-stu-id="6f2c8-150">Produce a cross-platform binary</span></span>

<span data-ttu-id="6f2c8-151">以 dll 文件的形式将应用发布为[依赖于运行时的应用](#publish-runtime-dependent)时，将创建跨平台二进制文件。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-151">Cross-platform binaries are created when you publish your app as [runtime-dependent](#publish-runtime-dependent), in the form of a *dll* file.</span></span> <span data-ttu-id="6f2c8-152">dll 文件将与项目同名。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-152">The *dll* file is named after your project.</span></span> <span data-ttu-id="6f2c8-153">例如，如果有名为 word_reader 的应用，则会创建名为 word_reader.dll 的文件。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-153">For example, if you have an app named **word_reader**, a file named *word_reader.dll* is created.</span></span> <span data-ttu-id="6f2c8-154">以这种方式发布的应用可通过 `dotnet <filename.dll>` 命令运行，并且可在任意平台上运行。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-154">Apps published in this way are run with the `dotnet <filename.dll>` command and can be run on any platform.</span></span>

<span data-ttu-id="6f2c8-155">只要安装了目标 .NET Core 运行时，就可以在任何操作系统上运行跨平台二进制文件。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-155">Cross-platform binaries can be run on any operating system as long as the targeted .NET Core runtime is already installed.</span></span> <span data-ttu-id="6f2c8-156">如果未安装目标 .NET Core 运行时，如果将应用配置为前滚，则它可以使用较新的运行时运行。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-156">If the targeted .NET Core runtime isn't installed, the app may run using a newer runtime if the app is configured to roll-forward.</span></span> <span data-ttu-id="6f2c8-157">有关详细信息，请参阅[依赖于运行时的应用前滚](../versions/selection.md#framework-dependent-apps-roll-forward)。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-157">For more information, see [runtime-dependent apps roll forward](../versions/selection.md#framework-dependent-apps-roll-forward).</span></span>

<span data-ttu-id="6f2c8-158">以下命令可生成跨平台二进制文件：</span><span class="sxs-lookup"><span data-stu-id="6f2c8-158">The following command produces a cross-platform binary:</span></span>

| <span data-ttu-id="6f2c8-159">类型</span><span class="sxs-lookup"><span data-stu-id="6f2c8-159">Type</span></span>                                                                                 | <span data-ttu-id="6f2c8-160">SDK 2.1</span><span class="sxs-lookup"><span data-stu-id="6f2c8-160">SDK 2.1</span></span> | <span data-ttu-id="6f2c8-161">SDK 3.x</span><span class="sxs-lookup"><span data-stu-id="6f2c8-161">SDK 3.x</span></span> | <span data-ttu-id="6f2c8-162">命令</span><span class="sxs-lookup"><span data-stu-id="6f2c8-162">Command</span></span> |
| -----------------------------------------------------------------------------------  | ------- | ------- | ------- |
| <span data-ttu-id="6f2c8-163">[依赖于运行时的跨平台二进制文件](#publish-runtime-dependent)。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-163">[runtime-dependent cross-platform binary](#publish-runtime-dependent).</span></span>               | <span data-ttu-id="6f2c8-164">✔️</span><span class="sxs-lookup"><span data-stu-id="6f2c8-164">✔️</span></span>      | <span data-ttu-id="6f2c8-165">✔️</span><span class="sxs-lookup"><span data-stu-id="6f2c8-165">✔️</span></span>      | [`dotnet publish`](../tools/dotnet-publish.md) |

## <a name="publish-runtime-dependent"></a><span data-ttu-id="6f2c8-166">发布依赖于运行时的应用</span><span class="sxs-lookup"><span data-stu-id="6f2c8-166">Publish runtime-dependent</span></span>

<span data-ttu-id="6f2c8-167">如果将应用发布为依赖于运行时的应用，则该应用是跨平台的，且不包含 .NET Core 运行时。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-167">Apps published as runtime-dependent are cross-platform and don't include the .NET Core runtime.</span></span> <span data-ttu-id="6f2c8-168">应用的用户需要安装 .NET Core 运行时。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-168">The user of your app is required to install the .NET Core runtime.</span></span>

<span data-ttu-id="6f2c8-169">将应用发布为依赖于运行时的应用，会以 *dll* 文件的形式生成一个 [跨平台二进制文件](#produce-a-cross-platform-binary)，还会生成面向当前平台的[特定于平台的可执行文件](#produce-an-executable)。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-169">Publishing an app as runtime-dependent produces a [cross-platform binary](#produce-a-cross-platform-binary) as a *dll* file, and a [platform-specific executable](#produce-an-executable) that targets your current platform.</span></span> <span data-ttu-id="6f2c8-170">dll 是跨平台的，而可执行文件不是。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-170">The *dll* is cross-platform while the executable isn't.</span></span> <span data-ttu-id="6f2c8-171">例如，如果发布名为 word_reader 的应用且面向 Windows，则将创建 word_reader.exe 和 word_reader.dll。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-171">For example, if you publish an app named **word_reader** and target Windows, a *word_reader.exe* executable is created along with *word_reader.dll*.</span></span> <span data-ttu-id="6f2c8-172">面向 Linux 或 macOS 时，将创建 word_reader 可执行文件和 word_reader.dll。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-172">When targeting Linux or macOS, a *word_reader* executable is created along with *word_reader.dll*.</span></span> <span data-ttu-id="6f2c8-173">有关 RID 的详细信息，请参阅 [.NET Core RID 目录](../rid-catalog.md)。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-173">For more information about RIDs, see [.NET Core RID Catalog](../rid-catalog.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="6f2c8-174">发布依赖于运行时的应用时，.NET Core SDK 2.1 不会生成特定于平台的可执行文件。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-174">.NET Core SDK 2.1 doesn't produce platform-specific executables when you publish an app runtime-dependent.</span></span>

<span data-ttu-id="6f2c8-175">可以通过 `dotnet <filename.dll>` 命令运行应用的跨平台二进制文件，并且它可以在任何平台上运行。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-175">The cross-platform binary of your app can be run with the `dotnet <filename.dll>` command, and can be run on any platform.</span></span> <span data-ttu-id="6f2c8-176">如果应用使用具有特定于平台的实现的 NuGet 包，则所有平台的依赖项都将连同应用一起复制到发布文件夹。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-176">If the app uses a NuGet package that has platform-specific implementations, all platforms' dependencies are copied to the publish folder along with the app.</span></span>

<span data-ttu-id="6f2c8-177">可以通过将 `-r <RID> --self-contained false` 参数传递到 [`dotnet publish`](../tools/dotnet-publish.md) 命令，为特定平台创建可执行文件。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-177">You can create an executable for a specific platform by passing the `-r <RID> --self-contained false` parameters to the [`dotnet publish`](../tools/dotnet-publish.md) command.</span></span> <span data-ttu-id="6f2c8-178">省略 `-r` 参数时，将为当前平台创建可执行文件。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-178">When the `-r` parameter is omitted, an executable is created for your current platform.</span></span> <span data-ttu-id="6f2c8-179">具有特定于目标平台的依赖项的任何 NuGet 包都将复制到发布文件夹。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-179">Any NuGet packages that have platform-specific dependencies for the targeted platform are copied to the publish folder.</span></span>

### <a name="advantages"></a><span data-ttu-id="6f2c8-180">优点</span><span class="sxs-lookup"><span data-stu-id="6f2c8-180">Advantages</span></span>

- <span data-ttu-id="6f2c8-181">小型部署</span><span class="sxs-lookup"><span data-stu-id="6f2c8-181">**Small deployment**</span></span>\
<span data-ttu-id="6f2c8-182">仅分发应用及其依赖项。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-182">Only your app and its dependencies are distributed.</span></span> <span data-ttu-id="6f2c8-183">.NET Core 运行时和库由用户安装，所有应用共享运行时。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-183">The .NET Core runtime and libraries are installed by the user and all apps share the runtime.</span></span>

- <span data-ttu-id="6f2c8-184">跨平台</span><span class="sxs-lookup"><span data-stu-id="6f2c8-184">**Cross-platform**</span></span>\
<span data-ttu-id="6f2c8-185">应用和任何基于 .NET 的库都可在不同的操作系统上运行。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-185">Your app and any .NET-based library runs on other operating systems.</span></span> <span data-ttu-id="6f2c8-186">无需为应用定义目标平台。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-186">You don't need to define a target platform for your app.</span></span> <span data-ttu-id="6f2c8-187">有关 .NET 文件格式的详细信息，请参阅 [.NET 程序集文件格式](../../standard/assembly/file-format.md)。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-187">For information about the .NET file format, see [.NET Assembly File Format](../../standard/assembly/file-format.md).</span></span>

- <span data-ttu-id="6f2c8-188">使用最新修补运行时</span><span class="sxs-lookup"><span data-stu-id="6f2c8-188">**Uses the latest patched runtime**</span></span>\
<span data-ttu-id="6f2c8-189">应用会使用目标系统上安装的最新运行时（在 .NET Core 的目标大小系列中）。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-189">The app uses the latest runtime (within the targeted major-minor family of .NET Core) installed on the target system.</span></span> <span data-ttu-id="6f2c8-190">这意味着应用将自动使用 .NET Core 运行时的最新修补版本。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-190">This means your app automatically uses the latest patched version of the .NET Core runtime.</span></span> <span data-ttu-id="6f2c8-191">可以重写这一默认行为。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-191">This default behavior can be overridden.</span></span> <span data-ttu-id="6f2c8-192">有关详细信息，请参阅[依赖于运行时的应用前滚](../versions/selection.md#framework-dependent-apps-roll-forward)。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-192">For more information, see [runtime-dependent apps roll forward](../versions/selection.md#framework-dependent-apps-roll-forward).</span></span>

### <a name="disadvantages"></a><span data-ttu-id="6f2c8-193">缺点</span><span class="sxs-lookup"><span data-stu-id="6f2c8-193">Disadvantages</span></span>

- <span data-ttu-id="6f2c8-194">**要求预先安装运行时**</span><span class="sxs-lookup"><span data-stu-id="6f2c8-194">**Requires pre-installing the runtime**</span></span>\
<span data-ttu-id="6f2c8-195">仅当主机系统上已安装应用设为目标的 .NET Core 版本时，应用才能运行。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-195">Your app can run only if the version of .NET Core your app targets is already installed on the host system.</span></span> <span data-ttu-id="6f2c8-196">可以为应用配置前滚行为，要求使用特定版本的 .NET Core 或允许使用较新版本的 .NET Core。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-196">You can configure roll-forward behavior for the app to either require a specific version of .NET Core or allow a newer version of .NET Core.</span></span> <span data-ttu-id="6f2c8-197">有关详细信息，请参阅[依赖于运行时的应用前滚](../versions/selection.md#framework-dependent-apps-roll-forward)。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-197">For more information, see [runtime-dependent apps roll forward](../versions/selection.md#framework-dependent-apps-roll-forward).</span></span>

- <span data-ttu-id="6f2c8-198">.NET Core 可能更改</span><span class="sxs-lookup"><span data-stu-id="6f2c8-198">**.NET Core may change**</span></span>\
<span data-ttu-id="6f2c8-199">可以在运行应用的计算机上更新 .NET Core 运行时和库。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-199">It's possible for the .NET Core runtime and libraries to be updated on the machine where the app is run.</span></span> <span data-ttu-id="6f2c8-200">在极少数情况下，如果使用 .NET Core 库（大多数应用都会使用），这可能会更改应用的行为。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-200">In rare cases, this may change the behavior of your app if you use the .NET Core libraries, which most apps do.</span></span> <span data-ttu-id="6f2c8-201">可以配置应用如何使用较新版本的 .NET Core。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-201">You can configure how your app uses newer versions of .NET Core.</span></span> <span data-ttu-id="6f2c8-202">有关详细信息，请参阅[依赖于运行时的应用前滚](../versions/selection.md#framework-dependent-apps-roll-forward)。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-202">For more information, see [runtime-dependent apps roll forward](../versions/selection.md#framework-dependent-apps-roll-forward).</span></span>

<span data-ttu-id="6f2c8-203">以下缺陷仅限于.NET Core 2.1 SDK。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-203">The following disadvantage only applies to .NET Core 2.1 SDK.</span></span>

- <span data-ttu-id="6f2c8-204">使用 `dotnet` 命令启动应用</span><span class="sxs-lookup"><span data-stu-id="6f2c8-204">**Use the `dotnet` command to start the app**</span></span>\
<span data-ttu-id="6f2c8-205">用户必须运行 `dotnet <filename.dll>` 命令来启动你的应用。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-205">Users must run the `dotnet <filename.dll>` command to start your app.</span></span> <span data-ttu-id="6f2c8-206">如果将应用发布为依赖于运行时的应用，则 .NET Core 2.1 SDK 不会生成特定于平台的可执行文件。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-206">.NET Core 2.1 SDK doesn't produce platform-specific executables for apps published runtime-dependent.</span></span>

### <a name="examples"></a><span data-ttu-id="6f2c8-207">示例</span><span class="sxs-lookup"><span data-stu-id="6f2c8-207">Examples</span></span>

<span data-ttu-id="6f2c8-208">发布依赖于运行时的跨平台应用。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-208">Publish an app cross-platform runtime-dependent.</span></span> <span data-ttu-id="6f2c8-209">与 *dll* 文件一起创建面向当前平台的可执行文件。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-209">An executable that targets your current platform is created along with the *dll* file.</span></span>

```dotnet
dotnet publish
```

<span data-ttu-id="6f2c8-210">发布依赖于运行时的跨平台应用。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-210">Publish an app cross-platform runtime-dependent.</span></span> <span data-ttu-id="6f2c8-211">与 *dll* 文件一起创建 Linux 64 位可执行文件。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-211">A Linux 64-bit executable is created along with the *dll* file.</span></span> <span data-ttu-id="6f2c8-212">此命令对于 .NET Core SDK 2.1 无效。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-212">This command doesn't work with .NET Core SDK 2.1.</span></span>

```dotnet
dotnet publish -r linux-x64 --self-contained false
```

## <a name="publish-self-contained"></a><span data-ttu-id="6f2c8-213">发布独立应用</span><span class="sxs-lookup"><span data-stu-id="6f2c8-213">Publish self-contained</span></span>

<span data-ttu-id="6f2c8-214">将应用发布为独立应用，将生成特定于平台的可执行文件。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-214">Publishing your app as self-contained produces a platform-specific executable.</span></span> <span data-ttu-id="6f2c8-215">输出发布文件夹包含应用的所有组件，包括 .NET Core 库和目标运行时。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-215">The output publishing folder contains all components of the app, including the .NET Core libraries and target runtime.</span></span> <span data-ttu-id="6f2c8-216">应用独立于其他 .NET Core 应用，且不使用本地安装的共享运行时。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-216">The app is isolated from other .NET Core apps and doesn't use a locally installed shared runtime.</span></span> <span data-ttu-id="6f2c8-217">应用的用户无需下载和安装 .NET Core。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-217">The user of your app isn't required to download and install .NET Core.</span></span>

<span data-ttu-id="6f2c8-218">针对指定的目标平台生成可执行二进制文件。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-218">The executable binary is produced for the specified target platform.</span></span> <span data-ttu-id="6f2c8-219">例如，如果你有一个名为 word_reader 的应用，并发布适用于 Windows 的独立可执行文件，则将创建 word_reader.exe 文件。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-219">For example, if you have an app named **word_reader**, and you publish a self-contained executable for Windows, a *word_reader.exe* file is created.</span></span> <span data-ttu-id="6f2c8-220">针对 Linux 或 macOS 发布时，将创建 word_reader 文件。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-220">Publishing for Linux or macOS, a *word_reader* file is created.</span></span> <span data-ttu-id="6f2c8-221">用 [`dotnet publish`](../tools/dotnet-publish.md) 命令的 `-r <RID>` 参数指定目标平台和体系结构。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-221">The target platform and architecture is specified with the `-r <RID>` parameter for the [`dotnet publish`](../tools/dotnet-publish.md) command.</span></span> <span data-ttu-id="6f2c8-222">有关 RID 的详细信息，请参阅 [.NET Core RID 目录](../rid-catalog.md)。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-222">For more information about RIDs, see [.NET Core RID Catalog](../rid-catalog.md).</span></span>

<span data-ttu-id="6f2c8-223">如果应用具有特定于平台的依赖项（例如包含特定于平台的依赖项的 NuGet 包），这些依赖项将与应用一起复制到发布文件夹。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-223">If the app has platform-specific dependencies, such as a NuGet package containing platform-specific dependencies, these are copied to the publish folder along with the app.</span></span>

### <a name="advantages"></a><span data-ttu-id="6f2c8-224">优点</span><span class="sxs-lookup"><span data-stu-id="6f2c8-224">Advantages</span></span>

- <span data-ttu-id="6f2c8-225">控制 .NET Core 版本</span><span class="sxs-lookup"><span data-stu-id="6f2c8-225">**Control .NET Core version**</span></span>\
<span data-ttu-id="6f2c8-226">你可以控制随应用部署的 .NET Core 版本。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-226">You control which version of .NET Core is deployed with your app.</span></span>

- <span data-ttu-id="6f2c8-227">特定于平台的定向</span><span class="sxs-lookup"><span data-stu-id="6f2c8-227">**Platform-specific targeting**</span></span>\
<span data-ttu-id="6f2c8-228">由于你必须为每个平台发布应用，因此你知道应用可运行于哪些平台。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-228">Because you have to publish your app for each platform, you know where your app will run.</span></span> <span data-ttu-id="6f2c8-229">如果 .NET Core 引入了新平台，则用户无法在该新平台上运行你的应用，直到你发布面向该平台的版本。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-229">If .NET Core introduces a new platform, users can't run your app on that platform until you release a version targeting that platform.</span></span> <span data-ttu-id="6f2c8-230">在用户在新平台上运行你的应用之前，你可以测试应用以排除兼容性问题。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-230">You can test your app for compatibility problems before your users run your app on the new platform.</span></span>

### <a name="disadvantages"></a><span data-ttu-id="6f2c8-231">缺点</span><span class="sxs-lookup"><span data-stu-id="6f2c8-231">Disadvantages</span></span>

- <span data-ttu-id="6f2c8-232">大型部署</span><span class="sxs-lookup"><span data-stu-id="6f2c8-232">**Larger deployments**</span></span>\
<span data-ttu-id="6f2c8-233">由于你的应用包含 .NET Core 运行时和所有应用依赖项，因此下载大小和所需硬盘空间比[依赖于运行时的](#publish-runtime-dependent)版本大。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-233">Because your app includes the .NET Core runtime and all of your app dependencies, the download size and hard drive space required is greater than a [runtime-dependent](#publish-runtime-dependent) version.</span></span>

  > [!TIP]
  > <span data-ttu-id="6f2c8-234">可以通过使用 .NET Core [*全球化固定模式*](https://github.com/dotnet/runtime/blob/master/docs/design/features/globalization-invariant-mode.md)在 Linux 系统上减少大约 28 MB 的部署大小。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-234">You can reduce the size of your deployment on Linux systems by approximately 28 MB by using .NET Core [*globalization invariant mode*](https://github.com/dotnet/runtime/blob/master/docs/design/features/globalization-invariant-mode.md).</span></span> <span data-ttu-id="6f2c8-235">这会强制应用像处理[固定区域性](xref:System.Globalization.CultureInfo.InvariantCulture?displayProperty=nameWithType)一样处理所有区域性。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-235">This forces your app to treat all cultures like the [invariant culture](xref:System.Globalization.CultureInfo.InvariantCulture?displayProperty=nameWithType).</span></span>

- <span data-ttu-id="6f2c8-236">较难更新 .NET Core 版本</span><span class="sxs-lookup"><span data-stu-id="6f2c8-236">**Harder to update the .NET Core version**</span></span>\
<span data-ttu-id="6f2c8-237">只能通过发布新版本的应用来升级（与应用一起分发的）.NET Core 运行时。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-237">.NET Core Runtime (distributed with your app) can only be upgraded by releasing a new version of your app.</span></span> <span data-ttu-id="6f2c8-238">你负责向 .NET Core 运行时的安全修补程序提供应用程序的更新版本。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-238">You're responsible for supplying an updated version of your application for security patches to the .NET Core Runtime.</span></span> 

### <a name="examples"></a><span data-ttu-id="6f2c8-239">示例</span><span class="sxs-lookup"><span data-stu-id="6f2c8-239">Examples</span></span>

<span data-ttu-id="6f2c8-240">发布独立应用。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-240">Publish an app self-contained.</span></span> <span data-ttu-id="6f2c8-241">创建 macOS 64 位可执行文件。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-241">A macOS 64-bit executable is created.</span></span>

```dotnet
dotnet publish -r osx-x64
```

<span data-ttu-id="6f2c8-242">发布独立应用。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-242">Publish an app self-contained.</span></span> <span data-ttu-id="6f2c8-243">创建 Windows 64 位可执行文件。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-243">A Windows 64-bit executable is created.</span></span>

```dotnet
dotnet publish -r win-x64
```

## <a name="see-also"></a><span data-ttu-id="6f2c8-244">请参阅</span><span class="sxs-lookup"><span data-stu-id="6f2c8-244">See also</span></span>

- [<span data-ttu-id="6f2c8-245">使用 .NET Core CLI 部署 .NET Core 应用。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-245">Deploying .NET Core Apps with .NET Core CLI.</span></span>](deploy-with-cli.md)
- [<span data-ttu-id="6f2c8-246">使用 Visual Studio 部署 .NET Core 应用。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-246">Deploying .NET Core Apps with Visual Studio.</span></span>](deploy-with-vs.md)
- [<span data-ttu-id="6f2c8-247">包、元包和框架。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-247">Packages, Metapackages, and Frameworks.</span></span>](../packages.md)
- [<span data-ttu-id="6f2c8-248">.NET Core 运行时标识符 (RID) 目录。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-248">.NET Core Runtime IDentifier (RID) catalog.</span></span>](../rid-catalog.md)
- [<span data-ttu-id="6f2c8-249">选择要使用的 .NET Core 版本。</span><span class="sxs-lookup"><span data-stu-id="6f2c8-249">Select the .NET Core version to use.</span></span>](../versions/selection.md)
