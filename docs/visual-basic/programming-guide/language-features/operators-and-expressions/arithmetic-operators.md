---
title: 算术运算符
ms.date: 07/20/2015
helpviewer_keywords:
- type safety
- operators [Visual Basic], bitwise
- operators [Visual Basic], bit-shift
- bitwise operators [Visual Basic]
- bit-shift operators [Visual Basic]
- zero, division by zero
- operators [Visual Basic], arithmetic
- division [Visual Basic], by zero
- Visual Basic code, operators
- arithmetic operators [Visual Basic], about arithmetic operators
ms.assetid: 325dac7a-ea4f-41d5-8b48-f6e904211569
ms.openlocfilehash: 8ded8d7111bd37cf8762a202b728e814aa5a082b
ms.sourcegitcommit: 17ee6605e01ef32506f8fdc686954244ba6911de
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/22/2019
ms.locfileid: "74352661"
---
# <a name="arithmetic-operators-in-visual-basic"></a><span data-ttu-id="31f2e-102">算术运算符 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="31f2e-102">Arithmetic Operators in Visual Basic</span></span>
<span data-ttu-id="31f2e-103">Arithmetic operators are used to perform many of the familiar arithmetic operations that involve the calculation of numeric values represented by literals, variables, other expressions, function and property calls, and constants.</span><span class="sxs-lookup"><span data-stu-id="31f2e-103">Arithmetic operators are used to perform many of the familiar arithmetic operations that involve the calculation of numeric values represented by literals, variables, other expressions, function and property calls, and constants.</span></span> <span data-ttu-id="31f2e-104">Also classified with arithmetic operators are the bit-shift operators, which act at the level of the individual bits of the operands and shift their bit patterns to the left or right.</span><span class="sxs-lookup"><span data-stu-id="31f2e-104">Also classified with arithmetic operators are the bit-shift operators, which act at the level of the individual bits of the operands and shift their bit patterns to the left or right.</span></span>  
  
## <a name="arithmetic-operations"></a><span data-ttu-id="31f2e-105">Arithmetic Operations</span><span class="sxs-lookup"><span data-stu-id="31f2e-105">Arithmetic Operations</span></span>  
 <span data-ttu-id="31f2e-106">You can add two values in an expression together with the [+ Operator](../../../../visual-basic/language-reference/operators/addition-operator.md), or subtract one from another with the [- Operator (Visual Basic)](../../../../visual-basic/language-reference/operators/subtraction-operator.md), as the following example demonstrates.</span><span class="sxs-lookup"><span data-stu-id="31f2e-106">You can add two values in an expression together with the [+ Operator](../../../../visual-basic/language-reference/operators/addition-operator.md), or subtract one from another with the [- Operator (Visual Basic)](../../../../visual-basic/language-reference/operators/subtraction-operator.md), as the following example demonstrates.</span></span>  
  
 [!code-vb[VbVbalrOperators#57](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrOperators/VB/Class1.vb#57)]  
  
 <span data-ttu-id="31f2e-107">Negation also uses the [- Operator (Visual Basic)](../../../../visual-basic/language-reference/operators/subtraction-operator.md), but with only one operand, as the following example demonstrates.</span><span class="sxs-lookup"><span data-stu-id="31f2e-107">Negation also uses the [- Operator (Visual Basic)](../../../../visual-basic/language-reference/operators/subtraction-operator.md), but with only one operand, as the following example demonstrates.</span></span>  
  
 [!code-vb[VbVbalrOperators#58](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrOperators/VB/Class1.vb#58)]  
  
 <span data-ttu-id="31f2e-108">Multiplication and division use the [\* Operator](../../../../visual-basic/language-reference/operators/multiplication-operator.md) and [/ Operator (Visual Basic)](../../../../visual-basic/language-reference/operators/floating-point-division-operator.md), respectively, as the following example demonstrates.</span><span class="sxs-lookup"><span data-stu-id="31f2e-108">Multiplication and division use the [\* Operator](../../../../visual-basic/language-reference/operators/multiplication-operator.md) and [/ Operator (Visual Basic)](../../../../visual-basic/language-reference/operators/floating-point-division-operator.md), respectively, as the following example demonstrates.</span></span>  
  
 [!code-vb[VbVbalrOperators#59](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrOperators/VB/Class1.vb#59)]  
  
 <span data-ttu-id="31f2e-109">Exponentiation uses the [^ Operator](../../../../visual-basic/language-reference/operators/exponentiation-operator.md), as the following example demonstrates.</span><span class="sxs-lookup"><span data-stu-id="31f2e-109">Exponentiation uses the [^ Operator](../../../../visual-basic/language-reference/operators/exponentiation-operator.md), as the following example demonstrates.</span></span>  
  
 [!code-vb[VbVbalrOperators#60](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrOperators/VB/Class1.vb#60)]  
  
 <span data-ttu-id="31f2e-110">Integer division is carried out using the [\ Operator (Visual Basic)](../../../../visual-basic/language-reference/operators/integer-division-operator.md).</span><span class="sxs-lookup"><span data-stu-id="31f2e-110">Integer division is carried out using the [\ Operator (Visual Basic)](../../../../visual-basic/language-reference/operators/integer-division-operator.md).</span></span> <span data-ttu-id="31f2e-111">Integer division returns the quotient, that is, the integer that represents the number of times the divisor can divide into the dividend without consideration of any remainder.</span><span class="sxs-lookup"><span data-stu-id="31f2e-111">Integer division returns the quotient, that is, the integer that represents the number of times the divisor can divide into the dividend without consideration of any remainder.</span></span> <span data-ttu-id="31f2e-112">Both the divisor and the dividend must be integral types (`SByte`, `Byte`, `Short`, `UShort`, `Integer`, `UInteger`, `Long`, and `ULong`) for this operator.</span><span class="sxs-lookup"><span data-stu-id="31f2e-112">Both the divisor and the dividend must be integral types (`SByte`, `Byte`, `Short`, `UShort`, `Integer`, `UInteger`, `Long`, and `ULong`) for this operator.</span></span> <span data-ttu-id="31f2e-113">All other types must be converted to an integral type first.</span><span class="sxs-lookup"><span data-stu-id="31f2e-113">All other types must be converted to an integral type first.</span></span> <span data-ttu-id="31f2e-114">The following example demonstrates integer division.</span><span class="sxs-lookup"><span data-stu-id="31f2e-114">The following example demonstrates integer division.</span></span>  
  
 [!code-vb[VbVbalrOperators#61](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrOperators/VB/Class1.vb#61)]  
  
 <span data-ttu-id="31f2e-115">Modulus arithmetic is performed using the [Mod Operator](../../../../visual-basic/language-reference/operators/mod-operator.md).</span><span class="sxs-lookup"><span data-stu-id="31f2e-115">Modulus arithmetic is performed using the [Mod Operator](../../../../visual-basic/language-reference/operators/mod-operator.md).</span></span> <span data-ttu-id="31f2e-116">This operator returns the remainder after dividing the divisor into the dividend an integral number of times.</span><span class="sxs-lookup"><span data-stu-id="31f2e-116">This operator returns the remainder after dividing the divisor into the dividend an integral number of times.</span></span> <span data-ttu-id="31f2e-117">If both divisor and dividend are integral types, the returned value is integral.</span><span class="sxs-lookup"><span data-stu-id="31f2e-117">If both divisor and dividend are integral types, the returned value is integral.</span></span> <span data-ttu-id="31f2e-118">If divisor and dividend are floating-point types, the returned value is also floating-point.</span><span class="sxs-lookup"><span data-stu-id="31f2e-118">If divisor and dividend are floating-point types, the returned value is also floating-point.</span></span> <span data-ttu-id="31f2e-119">The following example demonstrates this behavior.</span><span class="sxs-lookup"><span data-stu-id="31f2e-119">The following example demonstrates this behavior.</span></span>  
  
 [!code-vb[VbVbalrOperators#62](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrOperators/VB/Class1.vb#62)]  
  
 [!code-vb[VbVbalrOperators#63](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrOperators/VB/Class1.vb#63)]  
  
### <a name="attempted-division-by-zero"></a><span data-ttu-id="31f2e-120">Attempted Division by Zero</span><span class="sxs-lookup"><span data-stu-id="31f2e-120">Attempted Division by Zero</span></span>  
 <span data-ttu-id="31f2e-121">Division by zero has different results depending on the data types involved.</span><span class="sxs-lookup"><span data-stu-id="31f2e-121">Division by zero has different results depending on the data types involved.</span></span> <span data-ttu-id="31f2e-122">In integral divisions (`SByte`, `Byte`, `Short`, `UShort`, `Integer`, `UInteger`, `Long`, `ULong`), the .NET Framework throws a <xref:System.DivideByZeroException> exception.</span><span class="sxs-lookup"><span data-stu-id="31f2e-122">In integral divisions (`SByte`, `Byte`, `Short`, `UShort`, `Integer`, `UInteger`, `Long`, `ULong`), the .NET Framework throws a <xref:System.DivideByZeroException> exception.</span></span> <span data-ttu-id="31f2e-123">In division operations on the `Decimal` or `Single` data type, the .NET Framework also throws a <xref:System.DivideByZeroException> exception.</span><span class="sxs-lookup"><span data-stu-id="31f2e-123">In division operations on the `Decimal` or `Single` data type, the .NET Framework also throws a <xref:System.DivideByZeroException> exception.</span></span>  
  
 <span data-ttu-id="31f2e-124">In floating-point divisions involving the `Double` data type, no exception is thrown, and the result is the class member representing <xref:System.Double.NaN>, <xref:System.Double.PositiveInfinity>, or <xref:System.Double.NegativeInfinity>, depending on the dividend.</span><span class="sxs-lookup"><span data-stu-id="31f2e-124">In floating-point divisions involving the `Double` data type, no exception is thrown, and the result is the class member representing <xref:System.Double.NaN>, <xref:System.Double.PositiveInfinity>, or <xref:System.Double.NegativeInfinity>, depending on the dividend.</span></span> <span data-ttu-id="31f2e-125">The following table summarizes the various results of attempting to divide a `Double` value by zero.</span><span class="sxs-lookup"><span data-stu-id="31f2e-125">The following table summarizes the various results of attempting to divide a `Double` value by zero.</span></span>  
  
|<span data-ttu-id="31f2e-126">Dividend data type</span><span class="sxs-lookup"><span data-stu-id="31f2e-126">Dividend data type</span></span>|<span data-ttu-id="31f2e-127">Divisor data type</span><span class="sxs-lookup"><span data-stu-id="31f2e-127">Divisor data type</span></span>|<span data-ttu-id="31f2e-128">Dividend value</span><span class="sxs-lookup"><span data-stu-id="31f2e-128">Dividend value</span></span>|<span data-ttu-id="31f2e-129">结果</span><span class="sxs-lookup"><span data-stu-id="31f2e-129">Result</span></span>|  
|---|---|---|---|  
|`Double`|`Double`|<span data-ttu-id="31f2e-130">0</span><span class="sxs-lookup"><span data-stu-id="31f2e-130">0</span></span>|<span data-ttu-id="31f2e-131"><xref:System.Double.NaN> (not a mathematically defined number)</span><span class="sxs-lookup"><span data-stu-id="31f2e-131"><xref:System.Double.NaN> (not a mathematically defined number)</span></span>|  
|`Double`|`Double`|<span data-ttu-id="31f2e-132">> 0</span><span class="sxs-lookup"><span data-stu-id="31f2e-132">> 0</span></span>|<xref:System.Double.PositiveInfinity>|  
|`Double`|`Double`|<span data-ttu-id="31f2e-133">\< 0</span><span class="sxs-lookup"><span data-stu-id="31f2e-133">\< 0</span></span>|<xref:System.Double.NegativeInfinity>|  
  
 <span data-ttu-id="31f2e-134">When you catch a <xref:System.DivideByZeroException> exception, you can use its members to help you handle it.</span><span class="sxs-lookup"><span data-stu-id="31f2e-134">When you catch a <xref:System.DivideByZeroException> exception, you can use its members to help you handle it.</span></span> <span data-ttu-id="31f2e-135">For example, the <xref:System.Exception.Message%2A> property holds the message text for the exception.</span><span class="sxs-lookup"><span data-stu-id="31f2e-135">For example, the <xref:System.Exception.Message%2A> property holds the message text for the exception.</span></span> <span data-ttu-id="31f2e-136">有关详细信息，请参阅 [Try...Catch...Finally 语句](../../../../visual-basic/language-reference/statements/try-catch-finally-statement.md)。</span><span class="sxs-lookup"><span data-stu-id="31f2e-136">For more information, see [Try...Catch...Finally Statement](../../../../visual-basic/language-reference/statements/try-catch-finally-statement.md).</span></span>  
  
## <a name="bit-shift-operations"></a><span data-ttu-id="31f2e-137">Bit-Shift Operations</span><span class="sxs-lookup"><span data-stu-id="31f2e-137">Bit-Shift Operations</span></span>  
 <span data-ttu-id="31f2e-138">A bit-shift operation performs an arithmetic shift on a bit pattern.</span><span class="sxs-lookup"><span data-stu-id="31f2e-138">A bit-shift operation performs an arithmetic shift on a bit pattern.</span></span> <span data-ttu-id="31f2e-139">The pattern is contained in the operand on the left, while the operand on the right specifies the number of positions to shift the pattern.</span><span class="sxs-lookup"><span data-stu-id="31f2e-139">The pattern is contained in the operand on the left, while the operand on the right specifies the number of positions to shift the pattern.</span></span> <span data-ttu-id="31f2e-140">You can shift the pattern to the right with the [>> Operator](../../../../visual-basic/language-reference/operators/right-shift-operator.md) or to the left with the [<< Operator](../../../../visual-basic/language-reference/operators/left-shift-operator.md).</span><span class="sxs-lookup"><span data-stu-id="31f2e-140">You can shift the pattern to the right with the [>> Operator](../../../../visual-basic/language-reference/operators/right-shift-operator.md) or to the left with the [<< Operator](../../../../visual-basic/language-reference/operators/left-shift-operator.md).</span></span>  
  
 <span data-ttu-id="31f2e-141">The data type of the pattern operand must be `SByte`, `Byte`, `Short`, `UShort`, `Integer`, `UInteger`, `Long`, or `ULong`.</span><span class="sxs-lookup"><span data-stu-id="31f2e-141">The data type of the pattern operand must be `SByte`, `Byte`, `Short`, `UShort`, `Integer`, `UInteger`, `Long`, or `ULong`.</span></span> <span data-ttu-id="31f2e-142">The data type of the shift amount operand must be `Integer` or must widen to `Integer`.</span><span class="sxs-lookup"><span data-stu-id="31f2e-142">The data type of the shift amount operand must be `Integer` or must widen to `Integer`.</span></span>  
  
 <span data-ttu-id="31f2e-143">Arithmetic shifts are not circular, which means the bits shifted off one end of the result are not reintroduced at the other end.</span><span class="sxs-lookup"><span data-stu-id="31f2e-143">Arithmetic shifts are not circular, which means the bits shifted off one end of the result are not reintroduced at the other end.</span></span> <span data-ttu-id="31f2e-144">The bit positions vacated by a shift are set as follows:</span><span class="sxs-lookup"><span data-stu-id="31f2e-144">The bit positions vacated by a shift are set as follows:</span></span>  
  
- <span data-ttu-id="31f2e-145">0 for an arithmetic left shift</span><span class="sxs-lookup"><span data-stu-id="31f2e-145">0 for an arithmetic left shift</span></span>  
  
- <span data-ttu-id="31f2e-146">0 for an arithmetic right shift of a positive number</span><span class="sxs-lookup"><span data-stu-id="31f2e-146">0 for an arithmetic right shift of a positive number</span></span>  
  
- <span data-ttu-id="31f2e-147">0 for an arithmetic right shift of an unsigned data type (`Byte`, `UShort`, `UInteger`, `ULong`)</span><span class="sxs-lookup"><span data-stu-id="31f2e-147">0 for an arithmetic right shift of an unsigned data type (`Byte`, `UShort`, `UInteger`, `ULong`)</span></span>  
  
- <span data-ttu-id="31f2e-148">1 for an arithmetic right shift of a negative number (`SByte`, `Short`, `Integer`, or `Long`)</span><span class="sxs-lookup"><span data-stu-id="31f2e-148">1 for an arithmetic right shift of a negative number (`SByte`, `Short`, `Integer`, or `Long`)</span></span>  
  
 <span data-ttu-id="31f2e-149">The following example shifts an `Integer` value both left and right.</span><span class="sxs-lookup"><span data-stu-id="31f2e-149">The following example shifts an `Integer` value both left and right.</span></span>  
  
 [!code-vb[VbVbalrOperators#64](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrOperators/VB/Class1.vb#64)]  
  
 <span data-ttu-id="31f2e-150">Arithmetic shifts never generate overflow exceptions.</span><span class="sxs-lookup"><span data-stu-id="31f2e-150">Arithmetic shifts never generate overflow exceptions.</span></span>  
  
## <a name="bitwise-operations"></a><span data-ttu-id="31f2e-151">Bitwise Operations</span><span class="sxs-lookup"><span data-stu-id="31f2e-151">Bitwise Operations</span></span>  
 <span data-ttu-id="31f2e-152">In addition to being logical operators, `Not`, `Or`, `And`, and `Xor` also perform bitwise arithmetic when used on numeric values.</span><span class="sxs-lookup"><span data-stu-id="31f2e-152">In addition to being logical operators, `Not`, `Or`, `And`, and `Xor` also perform bitwise arithmetic when used on numeric values.</span></span> <span data-ttu-id="31f2e-153">For more information, see "Bitwise Operations" in [Logical and Bitwise Operators in Visual Basic](../../../../visual-basic/programming-guide/language-features/operators-and-expressions/logical-and-bitwise-operators.md).</span><span class="sxs-lookup"><span data-stu-id="31f2e-153">For more information, see "Bitwise Operations" in [Logical and Bitwise Operators in Visual Basic](../../../../visual-basic/programming-guide/language-features/operators-and-expressions/logical-and-bitwise-operators.md).</span></span>  
  
## <a name="type-safety"></a><span data-ttu-id="31f2e-154">Type Safety</span><span class="sxs-lookup"><span data-stu-id="31f2e-154">Type Safety</span></span>  
 <span data-ttu-id="31f2e-155">Operands should normally be of the same type.</span><span class="sxs-lookup"><span data-stu-id="31f2e-155">Operands should normally be of the same type.</span></span> <span data-ttu-id="31f2e-156">For example, if you are doing addition with an `Integer` variable, you should add it to another `Integer` variable, and you should assign the result to a variable of type `Integer` as well.</span><span class="sxs-lookup"><span data-stu-id="31f2e-156">For example, if you are doing addition with an `Integer` variable, you should add it to another `Integer` variable, and you should assign the result to a variable of type `Integer` as well.</span></span>  
  
 <span data-ttu-id="31f2e-157">One way to ensure good type-safe coding practice is to use the [Option Strict Statement](../../../../visual-basic/language-reference/statements/option-strict-statement.md).</span><span class="sxs-lookup"><span data-stu-id="31f2e-157">One way to ensure good type-safe coding practice is to use the [Option Strict Statement](../../../../visual-basic/language-reference/statements/option-strict-statement.md).</span></span> <span data-ttu-id="31f2e-158">If you set `Option Strict On`, Visual Basic automatically performs *type-safe* conversions.</span><span class="sxs-lookup"><span data-stu-id="31f2e-158">If you set `Option Strict On`, Visual Basic automatically performs *type-safe* conversions.</span></span> <span data-ttu-id="31f2e-159">For example, if you try to add an `Integer` variable to a `Double` variable and assign the value to a `Double` variable, the operation proceeds normally, because an `Integer` value can be converted to `Double` without loss of data.</span><span class="sxs-lookup"><span data-stu-id="31f2e-159">For example, if you try to add an `Integer` variable to a `Double` variable and assign the value to a `Double` variable, the operation proceeds normally, because an `Integer` value can be converted to `Double` without loss of data.</span></span> <span data-ttu-id="31f2e-160">Type-unsafe conversions, on the other hand, cause a compiler error with `Option Strict On`.</span><span class="sxs-lookup"><span data-stu-id="31f2e-160">Type-unsafe conversions, on the other hand, cause a compiler error with `Option Strict On`.</span></span> <span data-ttu-id="31f2e-161">For example, if you try to add an `Integer` variable to a `Double` variable and assign the value to an `Integer` variable, a compiler error results, because a `Double` variable cannot be implicitly converted to type `Integer`.</span><span class="sxs-lookup"><span data-stu-id="31f2e-161">For example, if you try to add an `Integer` variable to a `Double` variable and assign the value to an `Integer` variable, a compiler error results, because a `Double` variable cannot be implicitly converted to type `Integer`.</span></span>  
  
 <span data-ttu-id="31f2e-162">If you set `Option Strict Off`, however, Visual Basic allows implicit narrowing conversions to take place, although they can result in the unexpected loss of data or precision.</span><span class="sxs-lookup"><span data-stu-id="31f2e-162">If you set `Option Strict Off`, however, Visual Basic allows implicit narrowing conversions to take place, although they can result in the unexpected loss of data or precision.</span></span> <span data-ttu-id="31f2e-163">For this reason, we recommend that you use `Option Strict On` when writing production code.</span><span class="sxs-lookup"><span data-stu-id="31f2e-163">For this reason, we recommend that you use `Option Strict On` when writing production code.</span></span> <span data-ttu-id="31f2e-164">有关详细信息，请参阅 [Widening and Narrowing Conversions](../../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)。</span><span class="sxs-lookup"><span data-stu-id="31f2e-164">For more information, see [Widening and Narrowing Conversions](../../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="31f2e-165">请参阅</span><span class="sxs-lookup"><span data-stu-id="31f2e-165">See also</span></span>

- [<span data-ttu-id="31f2e-166">算术运算符</span><span class="sxs-lookup"><span data-stu-id="31f2e-166">Arithmetic Operators</span></span>](../../../../visual-basic/language-reference/operators/arithmetic-operators.md)
- [<span data-ttu-id="31f2e-167">移位运算符</span><span class="sxs-lookup"><span data-stu-id="31f2e-167">Bit Shift Operators</span></span>](../../../../visual-basic/language-reference/operators/bit-shift-operators.md)
- [<span data-ttu-id="31f2e-168">Comparison Operators in Visual Basic</span><span class="sxs-lookup"><span data-stu-id="31f2e-168">Comparison Operators in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/operators-and-expressions/comparison-operators.md)
- [<span data-ttu-id="31f2e-169">Concatenation Operators in Visual Basic</span><span class="sxs-lookup"><span data-stu-id="31f2e-169">Concatenation Operators in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/operators-and-expressions/concatenation-operators.md)
- [<span data-ttu-id="31f2e-170">Logical and Bitwise Operators in Visual Basic</span><span class="sxs-lookup"><span data-stu-id="31f2e-170">Logical and Bitwise Operators in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/operators-and-expressions/logical-and-bitwise-operators.md)
- [<span data-ttu-id="31f2e-171">运算符的有效组合</span><span class="sxs-lookup"><span data-stu-id="31f2e-171">Efficient Combination of Operators</span></span>](../../../../visual-basic/programming-guide/language-features/operators-and-expressions/efficient-combination-of-operators.md)
