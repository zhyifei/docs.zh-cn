---
title: 在 MaskedTextBox 控件中使用正则表达式
ms.date: 07/20/2015
helpviewer_keywords:
- strings [Visual Basic], regular expressions
- strings [Visual Basic], masked edit
ms.assetid: 2a048fb0-7053-487d-b2c5-ffa5e22ed6f9
ms.openlocfilehash: 12d500fa0ff4945dcf2d5009bdba6d337834707e
ms.sourcegitcommit: 17ee6605e01ef32506f8fdc686954244ba6911de
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/22/2019
ms.locfileid: "74346267"
---
# <a name="using-regular-expressions-with-the-maskedtextbox-control-in-visual-basic"></a><span data-ttu-id="34620-102">在 MaskedTextBox 控件中使用正则表达式 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="34620-102">Using Regular Expressions with the MaskedTextBox Control in Visual Basic</span></span>
<span data-ttu-id="34620-103">This example demonstrates how to convert simple regular expressions to work with the <xref:System.Windows.Forms.MaskedTextBox> control.</span><span class="sxs-lookup"><span data-stu-id="34620-103">This example demonstrates how to convert simple regular expressions to work with the <xref:System.Windows.Forms.MaskedTextBox> control.</span></span>  
  
## <a name="description-of-the-masking-language"></a><span data-ttu-id="34620-104">Description of the Masking Language</span><span class="sxs-lookup"><span data-stu-id="34620-104">Description of the Masking Language</span></span>  
 <span data-ttu-id="34620-105">The standard <xref:System.Windows.Forms.MaskedTextBox> masking language is based on the one used by the `Masked Edit` control in Visual Basic 6.0 and should be familiar to users migrating from that platform.</span><span class="sxs-lookup"><span data-stu-id="34620-105">The standard <xref:System.Windows.Forms.MaskedTextBox> masking language is based on the one used by the `Masked Edit` control in Visual Basic 6.0 and should be familiar to users migrating from that platform.</span></span>  
  
 <span data-ttu-id="34620-106">The <xref:System.Windows.Forms.MaskedTextBox.Mask%2A> property of the <xref:System.Windows.Forms.MaskedTextBox> control specifies what input mask to use.</span><span class="sxs-lookup"><span data-stu-id="34620-106">The <xref:System.Windows.Forms.MaskedTextBox.Mask%2A> property of the <xref:System.Windows.Forms.MaskedTextBox> control specifies what input mask to use.</span></span> <span data-ttu-id="34620-107">The mask must be a string composed of one or more of the masking elements from the following table.</span><span class="sxs-lookup"><span data-stu-id="34620-107">The mask must be a string composed of one or more of the masking elements from the following table.</span></span>  
  
|<span data-ttu-id="34620-108">Masking element</span><span class="sxs-lookup"><span data-stu-id="34620-108">Masking element</span></span>|<span data-ttu-id="34620-109">描述</span><span class="sxs-lookup"><span data-stu-id="34620-109">Description</span></span>|<span data-ttu-id="34620-110">Regular expression element</span><span class="sxs-lookup"><span data-stu-id="34620-110">Regular expression element</span></span>|  
|---------------------|-----------------|--------------------------------|  
|<span data-ttu-id="34620-111">0</span><span class="sxs-lookup"><span data-stu-id="34620-111">0</span></span>|<span data-ttu-id="34620-112">Any single digit between 0 and 9.</span><span class="sxs-lookup"><span data-stu-id="34620-112">Any single digit between 0 and 9.</span></span> <span data-ttu-id="34620-113">Entry required.</span><span class="sxs-lookup"><span data-stu-id="34620-113">Entry required.</span></span>|<span data-ttu-id="34620-114">\d</span><span class="sxs-lookup"><span data-stu-id="34620-114">\d</span></span>|  
|<span data-ttu-id="34620-115">9</span><span class="sxs-lookup"><span data-stu-id="34620-115">9</span></span>|<span data-ttu-id="34620-116">Digit or space.</span><span class="sxs-lookup"><span data-stu-id="34620-116">Digit or space.</span></span> <span data-ttu-id="34620-117">Entry optional.</span><span class="sxs-lookup"><span data-stu-id="34620-117">Entry optional.</span></span>|<span data-ttu-id="34620-118">[ \d]?</span><span class="sxs-lookup"><span data-stu-id="34620-118">[ \d]?</span></span>|  
|#|<span data-ttu-id="34620-119">Digit or space.</span><span class="sxs-lookup"><span data-stu-id="34620-119">Digit or space.</span></span> <span data-ttu-id="34620-120">Entry optional.</span><span class="sxs-lookup"><span data-stu-id="34620-120">Entry optional.</span></span> <span data-ttu-id="34620-121">If this position is left blank in the mask, it will be rendered as a space.</span><span class="sxs-lookup"><span data-stu-id="34620-121">If this position is left blank in the mask, it will be rendered as a space.</span></span> <span data-ttu-id="34620-122">Plus (+) and minus (-) signs are allowed.</span><span class="sxs-lookup"><span data-stu-id="34620-122">Plus (+) and minus (-) signs are allowed.</span></span>|<span data-ttu-id="34620-123">[ \d+-]?</span><span class="sxs-lookup"><span data-stu-id="34620-123">[ \d+-]?</span></span>|  
|<span data-ttu-id="34620-124">L</span><span class="sxs-lookup"><span data-stu-id="34620-124">L</span></span>|<span data-ttu-id="34620-125">ASCII letter.</span><span class="sxs-lookup"><span data-stu-id="34620-125">ASCII letter.</span></span> <span data-ttu-id="34620-126">Entry required.</span><span class="sxs-lookup"><span data-stu-id="34620-126">Entry required.</span></span>|<span data-ttu-id="34620-127">[a-zA-Z]</span><span class="sxs-lookup"><span data-stu-id="34620-127">[a-zA-Z]</span></span>|  
|<span data-ttu-id="34620-128">?</span><span class="sxs-lookup"><span data-stu-id="34620-128">?</span></span>|<span data-ttu-id="34620-129">ASCII letter.</span><span class="sxs-lookup"><span data-stu-id="34620-129">ASCII letter.</span></span> <span data-ttu-id="34620-130">Entry optional.</span><span class="sxs-lookup"><span data-stu-id="34620-130">Entry optional.</span></span>|<span data-ttu-id="34620-131">[a-zA-Z]?</span><span class="sxs-lookup"><span data-stu-id="34620-131">[a-zA-Z]?</span></span>|  
|&|<span data-ttu-id="34620-132">字符。</span><span class="sxs-lookup"><span data-stu-id="34620-132">Character.</span></span> <span data-ttu-id="34620-133">Entry required.</span><span class="sxs-lookup"><span data-stu-id="34620-133">Entry required.</span></span>|<span data-ttu-id="34620-134">[\p{Ll}\p{Lu}\p{Lt}\p{Lm}\p{Lo}]</span><span class="sxs-lookup"><span data-stu-id="34620-134">[\p{Ll}\p{Lu}\p{Lt}\p{Lm}\p{Lo}]</span></span>|  
|<span data-ttu-id="34620-135">C</span><span class="sxs-lookup"><span data-stu-id="34620-135">C</span></span>|<span data-ttu-id="34620-136">字符。</span><span class="sxs-lookup"><span data-stu-id="34620-136">Character.</span></span> <span data-ttu-id="34620-137">Entry optional.</span><span class="sxs-lookup"><span data-stu-id="34620-137">Entry optional.</span></span>|<span data-ttu-id="34620-138">[\p{Ll}\p{Lu}\p{Lt}\p{Lm}\p{Lo}]?</span><span class="sxs-lookup"><span data-stu-id="34620-138">[\p{Ll}\p{Lu}\p{Lt}\p{Lm}\p{Lo}]?</span></span>|  
|<span data-ttu-id="34620-139">包含当前请求的 URL 的</span><span class="sxs-lookup"><span data-stu-id="34620-139">A</span></span>|<span data-ttu-id="34620-140">Alphanumeric.</span><span class="sxs-lookup"><span data-stu-id="34620-140">Alphanumeric.</span></span> <span data-ttu-id="34620-141">Entry optional.</span><span class="sxs-lookup"><span data-stu-id="34620-141">Entry optional.</span></span>|<span data-ttu-id="34620-142">\W</span><span class="sxs-lookup"><span data-stu-id="34620-142">\W</span></span>|  
|<span data-ttu-id="34620-143">方法。</span><span class="sxs-lookup"><span data-stu-id="34620-143">.</span></span>|<span data-ttu-id="34620-144">Culture-appropriate decimal placeholder.</span><span class="sxs-lookup"><span data-stu-id="34620-144">Culture-appropriate decimal placeholder.</span></span>|<span data-ttu-id="34620-145">不可用。</span><span class="sxs-lookup"><span data-stu-id="34620-145">Not available.</span></span>|  
|<span data-ttu-id="34620-146">,</span><span class="sxs-lookup"><span data-stu-id="34620-146">,</span></span>|<span data-ttu-id="34620-147">Culture-appropriate thousands placeholder.</span><span class="sxs-lookup"><span data-stu-id="34620-147">Culture-appropriate thousands placeholder.</span></span>|<span data-ttu-id="34620-148">不可用。</span><span class="sxs-lookup"><span data-stu-id="34620-148">Not available.</span></span>|  
|<span data-ttu-id="34620-149">:</span><span class="sxs-lookup"><span data-stu-id="34620-149">:</span></span>|<span data-ttu-id="34620-150">Culture-appropriate time separator.</span><span class="sxs-lookup"><span data-stu-id="34620-150">Culture-appropriate time separator.</span></span>|<span data-ttu-id="34620-151">不可用。</span><span class="sxs-lookup"><span data-stu-id="34620-151">Not available.</span></span>|  
|/|<span data-ttu-id="34620-152">Culture-appropriate date separator.</span><span class="sxs-lookup"><span data-stu-id="34620-152">Culture-appropriate date separator.</span></span>|<span data-ttu-id="34620-153">不可用。</span><span class="sxs-lookup"><span data-stu-id="34620-153">Not available.</span></span>|  
|$|<span data-ttu-id="34620-154">Culture-appropriate currency symbol.</span><span class="sxs-lookup"><span data-stu-id="34620-154">Culture-appropriate currency symbol.</span></span>|<span data-ttu-id="34620-155">不可用。</span><span class="sxs-lookup"><span data-stu-id="34620-155">Not available.</span></span>|  
|\<|<span data-ttu-id="34620-156">Converts all characters that follow to lowercase.</span><span class="sxs-lookup"><span data-stu-id="34620-156">Converts all characters that follow to lowercase.</span></span>|<span data-ttu-id="34620-157">不可用。</span><span class="sxs-lookup"><span data-stu-id="34620-157">Not available.</span></span>|  
|>|<span data-ttu-id="34620-158">Converts all characters that follow to uppercase.</span><span class="sxs-lookup"><span data-stu-id="34620-158">Converts all characters that follow to uppercase.</span></span>|<span data-ttu-id="34620-159">不可用。</span><span class="sxs-lookup"><span data-stu-id="34620-159">Not available.</span></span>|  
|<span data-ttu-id="34620-160">&#124;</span><span class="sxs-lookup"><span data-stu-id="34620-160">&#124;</span></span>|<span data-ttu-id="34620-161">Undoes a previous shift up or shift down.</span><span class="sxs-lookup"><span data-stu-id="34620-161">Undoes a previous shift up or shift down.</span></span>|<span data-ttu-id="34620-162">不可用。</span><span class="sxs-lookup"><span data-stu-id="34620-162">Not available.</span></span>|  
|<span data-ttu-id="34620-163">&#92;</span><span class="sxs-lookup"><span data-stu-id="34620-163">&#92;</span></span>|<span data-ttu-id="34620-164">Escapes a mask character, turning it into a literal.</span><span class="sxs-lookup"><span data-stu-id="34620-164">Escapes a mask character, turning it into a literal.</span></span> <span data-ttu-id="34620-165">"\\\\" is the escape sequence for a backslash.</span><span class="sxs-lookup"><span data-stu-id="34620-165">"\\\\" is the escape sequence for a backslash.</span></span>|<span data-ttu-id="34620-166">&#92;</span><span class="sxs-lookup"><span data-stu-id="34620-166">&#92;</span></span>|  
|<span data-ttu-id="34620-167">All other characters.</span><span class="sxs-lookup"><span data-stu-id="34620-167">All other characters.</span></span>|<span data-ttu-id="34620-168">Literals.</span><span class="sxs-lookup"><span data-stu-id="34620-168">Literals.</span></span> <span data-ttu-id="34620-169">All non-mask elements will appear as themselves within <xref:System.Windows.Forms.MaskedTextBox>.</span><span class="sxs-lookup"><span data-stu-id="34620-169">All non-mask elements will appear as themselves within <xref:System.Windows.Forms.MaskedTextBox>.</span></span>|<span data-ttu-id="34620-170">All other characters.</span><span class="sxs-lookup"><span data-stu-id="34620-170">All other characters.</span></span>|  
  
 <span data-ttu-id="34620-171">The decimal (.), thousandths (,), time (:), date (/), and currency ($) symbols default to displaying those symbols as defined by the application's culture.</span><span class="sxs-lookup"><span data-stu-id="34620-171">The decimal (.), thousandths (,), time (:), date (/), and currency ($) symbols default to displaying those symbols as defined by the application's culture.</span></span> <span data-ttu-id="34620-172">You can force them to display symbols for another culture by using the <xref:System.Windows.Forms.MaskedTextBox.FormatProvider%2A> property.</span><span class="sxs-lookup"><span data-stu-id="34620-172">You can force them to display symbols for another culture by using the <xref:System.Windows.Forms.MaskedTextBox.FormatProvider%2A> property.</span></span>  
  
## <a name="regular-expressions-and-masks"></a><span data-ttu-id="34620-173">Regular Expressions and Masks</span><span class="sxs-lookup"><span data-stu-id="34620-173">Regular Expressions and Masks</span></span>  
 <span data-ttu-id="34620-174">Although you can use regular expressions and masks to validate user input, they are not completely equivalent.</span><span class="sxs-lookup"><span data-stu-id="34620-174">Although you can use regular expressions and masks to validate user input, they are not completely equivalent.</span></span> <span data-ttu-id="34620-175">Regular expressions can express more complex patterns than masks, but masks can express the same information more succinctly and in a culturally relevant format.</span><span class="sxs-lookup"><span data-stu-id="34620-175">Regular expressions can express more complex patterns than masks, but masks can express the same information more succinctly and in a culturally relevant format.</span></span>  
  
 <span data-ttu-id="34620-176">The following table compares four regular expressions and the equivalent mask for each.</span><span class="sxs-lookup"><span data-stu-id="34620-176">The following table compares four regular expressions and the equivalent mask for each.</span></span>  
  
|<span data-ttu-id="34620-177">正则表达式</span><span class="sxs-lookup"><span data-stu-id="34620-177">Regular Expression</span></span>|<span data-ttu-id="34620-178">掩码</span><span class="sxs-lookup"><span data-stu-id="34620-178">Mask</span></span>|<span data-ttu-id="34620-179">注意</span><span class="sxs-lookup"><span data-stu-id="34620-179">Notes</span></span>|  
|------------------------|----------|-----------|  
|`\d{2}/\d{2}/\d{4}`|`00/00/0000`|<span data-ttu-id="34620-180">The `/` character in the mask is a logical date separator, and it will appear to the user as the date separator appropriate to the application's current culture.</span><span class="sxs-lookup"><span data-stu-id="34620-180">The `/` character in the mask is a logical date separator, and it will appear to the user as the date separator appropriate to the application's current culture.</span></span>|  
|`\d{2}-[A-Z][a-z]{2}-\d{4}`|`00->L<LL-0000`|<span data-ttu-id="34620-181">A date (day, month abbreviation, and year) in United States format in which the three-letter month abbreviation is displayed with an initial uppercase letter followed by two lowercase letters.</span><span class="sxs-lookup"><span data-stu-id="34620-181">A date (day, month abbreviation, and year) in United States format in which the three-letter month abbreviation is displayed with an initial uppercase letter followed by two lowercase letters.</span></span>|  
|`(\(\d{3}\)-)?\d{3}-d{4}`|`(999)-000-0000`|<span data-ttu-id="34620-182">United States phone number, area code optional.</span><span class="sxs-lookup"><span data-stu-id="34620-182">United States phone number, area code optional.</span></span> <span data-ttu-id="34620-183">If the user does not wish to enter the optional characters, she can either enter spaces or place the mouse pointer directly at the position in the mask represented by the first 0.</span><span class="sxs-lookup"><span data-stu-id="34620-183">If the user does not wish to enter the optional characters, she can either enter spaces or place the mouse pointer directly at the position in the mask represented by the first 0.</span></span>|  
|`$\d{6}.00`|`$999,999.00`|<span data-ttu-id="34620-184">A currency value in the range of 0 to 999999.</span><span class="sxs-lookup"><span data-stu-id="34620-184">A currency value in the range of 0 to 999999.</span></span> <span data-ttu-id="34620-185">The currency, thousandth, and decimal characters will be replaced at run-time with their culture-specific equivalents.</span><span class="sxs-lookup"><span data-stu-id="34620-185">The currency, thousandth, and decimal characters will be replaced at run-time with their culture-specific equivalents.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="34620-186">请参阅</span><span class="sxs-lookup"><span data-stu-id="34620-186">See also</span></span>

- <xref:System.Windows.Forms.MaskedTextBox.Mask%2A>
- <xref:System.Windows.Forms.MaskedTextBox>
- [<span data-ttu-id="34620-187">在 Visual Basic 中验证字符串</span><span class="sxs-lookup"><span data-stu-id="34620-187">Validating Strings in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/strings/validating-strings.md)
- [<span data-ttu-id="34620-188">MaskedTextBox 控件</span><span class="sxs-lookup"><span data-stu-id="34620-188">MaskedTextBox Control</span></span>](../../../../framework/winforms/controls/maskedtextbox-control-windows-forms.md)
