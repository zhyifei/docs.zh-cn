---
title: 区域性对字符串的影响
ms.date: 07/20/2015
helpviewer_keywords:
- locale [Visual Basic], effect on strings
- strings [Visual Basic], locale dependence
ms.assetid: c4664444-ee0d-47bf-bef1-eaa3c54bdd7f
ms.openlocfilehash: 2520a7684b8710abd949543e3f17f77d3c631d22
ms.sourcegitcommit: 17ee6605e01ef32506f8fdc686954244ba6911de
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/22/2019
ms.locfileid: "74352476"
---
# <a name="how-culture-affects-strings-in-visual-basic"></a><span data-ttu-id="b49ba-102">区域性对字符串的影响 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="b49ba-102">How Culture Affects Strings in Visual Basic</span></span>
<span data-ttu-id="b49ba-103">此帮助页讨论 Visual Basic 如何使用区域性信息来执行字符串转换和比较。</span><span class="sxs-lookup"><span data-stu-id="b49ba-103">This Help page discusses how Visual Basic uses culture information to perform string conversions and comparisons.</span></span>  
  
## <a name="when-to-use-culture-specific-strings"></a><span data-ttu-id="b49ba-104">何时使用特定于区域性的字符串</span><span class="sxs-lookup"><span data-stu-id="b49ba-104">When to Use Culture-Specific Strings</span></span>  
 <span data-ttu-id="b49ba-105">通常，应为向用户显示的所有数据使用特定于区域性的字符串，并对应用程序的内部数据使用区域性固定字符串。</span><span class="sxs-lookup"><span data-stu-id="b49ba-105">Typically, you should use culture-specific strings for all data presented to and read from users, and use culture-invariant strings for your application's internal data.</span></span>  
  
 <span data-ttu-id="b49ba-106">例如，如果您的应用程序要求用户以字符串的形式输入日期，则应期望用户根据其区域性设置字符串的格式，并且应用程序应正确地转换字符串。</span><span class="sxs-lookup"><span data-stu-id="b49ba-106">For example, if your application asks users to enter a date as a string, it should expect users to format the strings according to their culture, and the application should convert the string appropriately.</span></span> <span data-ttu-id="b49ba-107">如果你的应用程序在其用户界面中显示该日期，则它应以用户的区域性显示该日期。</span><span class="sxs-lookup"><span data-stu-id="b49ba-107">If your application then presents that date in its user interface, it should present it in the user's culture.</span></span>  
  
 <span data-ttu-id="b49ba-108">但是，如果应用程序将日期上传到中央服务器，则应根据特定区域性设置字符串的格式，以防止可能不同的日期格式之间发生混淆。</span><span class="sxs-lookup"><span data-stu-id="b49ba-108">However, if the application uploads the date to a central server, it should format the string according to one specific culture, to prevent confusion between potentially different date formats.</span></span>  
  
## <a name="culture-sensitive-functions"></a><span data-ttu-id="b49ba-109">区分区域性的函数</span><span class="sxs-lookup"><span data-stu-id="b49ba-109">Culture-Sensitive Functions</span></span>  
 <span data-ttu-id="b49ba-110">所有 Visual Basic 字符串转换函数（`Str` 和 `Val` 函数除外）都使用应用程序的区域性信息来确保转换和比较适用于应用程序用户的区域性。</span><span class="sxs-lookup"><span data-stu-id="b49ba-110">All of the Visual Basic string-conversion functions (except for the `Str` and `Val` functions) use the application's culture information to make sure that the conversions and comparisons are appropriate for the culture of the application's user.</span></span>  
  
 <span data-ttu-id="b49ba-111">在具有不同区域性设置的计算机上运行的应用程序中成功使用字符串转换函数的关键是要了解哪些函数使用特定的区域性设置，以及哪些函数使用当前区域性设置。</span><span class="sxs-lookup"><span data-stu-id="b49ba-111">The key to successfully using string-conversion functions in applications that run on computers with different culture settings is to understand which functions use a specific culture setting, and which use the current culture setting.</span></span> <span data-ttu-id="b49ba-112">请注意，应用程序的区域性设置默认情况下从操作系统的区域性设置继承而来。</span><span class="sxs-lookup"><span data-stu-id="b49ba-112">Notice that the application's culture settings are, by default, inherited from the culture settings of the operating system.</span></span> <span data-ttu-id="b49ba-113">有关详细信息，请参阅 <xref:Microsoft.VisualBasic.Strings.Asc%2A>、<xref:Microsoft.VisualBasic.Strings.AscW%2A>、<xref:Microsoft.VisualBasic.Strings.Chr%2A>、<xref:Microsoft.VisualBasic.Strings.ChrW%2A>、<xref:Microsoft.VisualBasic.Strings.Format%2A>、<xref:Microsoft.VisualBasic.Conversion.Hex%2A>、<xref:Microsoft.VisualBasic.Conversion.Oct%2A>和[类型转换函数](../../../../visual-basic/language-reference/functions/type-conversion-functions.md)。</span><span class="sxs-lookup"><span data-stu-id="b49ba-113">For more information, see <xref:Microsoft.VisualBasic.Strings.Asc%2A>, <xref:Microsoft.VisualBasic.Strings.AscW%2A>, <xref:Microsoft.VisualBasic.Strings.Chr%2A>, <xref:Microsoft.VisualBasic.Strings.ChrW%2A>, <xref:Microsoft.VisualBasic.Strings.Format%2A>, <xref:Microsoft.VisualBasic.Conversion.Hex%2A>, <xref:Microsoft.VisualBasic.Conversion.Oct%2A>, and [Type Conversion Functions](../../../../visual-basic/language-reference/functions/type-conversion-functions.md).</span></span>  
  
 <span data-ttu-id="b49ba-114">在字符串和数字之间进行转换时，`Str` （将数字转换为字符串）和 `Val` （将字符串转换为数字）函数不使用应用程序的区域性信息。</span><span class="sxs-lookup"><span data-stu-id="b49ba-114">The `Str` (converts numbers to strings) and `Val` (converts strings to numbers) functions do not use the application's culture information when converting between strings and numbers.</span></span> <span data-ttu-id="b49ba-115">相反，它们仅将句点（.）识别为有效的小数点分隔符。</span><span class="sxs-lookup"><span data-stu-id="b49ba-115">Instead, they recognize only the period (.) as a valid decimal separator.</span></span> <span data-ttu-id="b49ba-116">这些函数的区域性感知物是：</span><span class="sxs-lookup"><span data-stu-id="b49ba-116">The culturally-aware analogues of these functions are:</span></span>  
  
- <span data-ttu-id="b49ba-117">**使用当前区域性的转换。**</span><span class="sxs-lookup"><span data-stu-id="b49ba-117">**Conversions that use the current culture.**</span></span> <span data-ttu-id="b49ba-118">`CStr` 和 `Format` 函数将数字转换为字符串，`CDbl` 和 `CInt` 函数将字符串转换为数字。</span><span class="sxs-lookup"><span data-stu-id="b49ba-118">The `CStr` and `Format` functions convert a number to a string, and the `CDbl` and `CInt` functions convert a string to a number.</span></span>  
  
- <span data-ttu-id="b49ba-119">**使用特定区域性的转换。**</span><span class="sxs-lookup"><span data-stu-id="b49ba-119">**Conversions that use a specific culture.**</span></span> <span data-ttu-id="b49ba-120">每个 number 对象都有一个 `ToString(IFormatProvider)` 方法，该方法将数字转换为字符串，并使用将字符串转换为数字的 `Parse(String, IFormatProvider)` 方法。</span><span class="sxs-lookup"><span data-stu-id="b49ba-120">Each number object has a `ToString(IFormatProvider)` method that converts a number to a string, and a `Parse(String, IFormatProvider)` method that converts a string to a number.</span></span> <span data-ttu-id="b49ba-121">例如，`Double` 类型提供 <xref:System.Double.ToString%28System.IFormatProvider%29> 和 <xref:System.Double.Parse%28System.String%2CSystem.IFormatProvider%29> 方法。</span><span class="sxs-lookup"><span data-stu-id="b49ba-121">For example, the `Double` type provides the <xref:System.Double.ToString%28System.IFormatProvider%29> and <xref:System.Double.Parse%28System.String%2CSystem.IFormatProvider%29> methods.</span></span>  
  
 <span data-ttu-id="b49ba-122">有关详细信息，请参阅 <xref:Microsoft.VisualBasic.Conversion.Str%2A> 和 <xref:Microsoft.VisualBasic.Conversion.Val%2A>。</span><span class="sxs-lookup"><span data-stu-id="b49ba-122">For more information, see <xref:Microsoft.VisualBasic.Conversion.Str%2A> and <xref:Microsoft.VisualBasic.Conversion.Val%2A>.</span></span>  
  
## <a name="using-a-specific-culture"></a><span data-ttu-id="b49ba-123">使用特定区域性</span><span class="sxs-lookup"><span data-stu-id="b49ba-123">Using a Specific Culture</span></span>  
 <span data-ttu-id="b49ba-124">假设您正在开发一个应用程序，该应用程序将日期（格式为字符串）发送到 Web 服务。</span><span class="sxs-lookup"><span data-stu-id="b49ba-124">Imagine that you are developing an application that sends a date (formatted as a string) to a Web service.</span></span> <span data-ttu-id="b49ba-125">在这种情况下，应用程序必须使用特定的区域性进行字符串转换。</span><span class="sxs-lookup"><span data-stu-id="b49ba-125">In this case, your application must use a specific culture for the string conversion.</span></span> <span data-ttu-id="b49ba-126">为了阐明原因，请考虑使用日期的 <xref:System.DateTime.ToString> 方法的结果：如果应用程序使用该方法格式化日期2005年7月4日，则当使用美国英语（zh-cn）区域性运行时，它将返回 "7/4/2005 12:00:00 AM"，但当使用德语（de）区域性运行时，它将返回 "04.07.2005 00:00:00"。</span><span class="sxs-lookup"><span data-stu-id="b49ba-126">To illustrate why, consider the result of using the date's <xref:System.DateTime.ToString> method: If your application uses that method to format the date July 4, 2005, it returns "7/4/2005 12:00:00 AM" when run with the United States English (en-US) culture, but it returns "04.07.2005 00:00:00" when run with the German (de-DE) culture.</span></span>  
  
 <span data-ttu-id="b49ba-127">如果需要以特定的区域性格式执行字符串转换，则应使用 .NET Framework 中内置的 `CultureInfo` 类。</span><span class="sxs-lookup"><span data-stu-id="b49ba-127">When you need to perform a string conversion in a specific culture format, you should use the `CultureInfo` class that is built into the .NET Framework.</span></span> <span data-ttu-id="b49ba-128">可以通过将区域性名称传递到 <xref:System.Globalization.CultureInfo.%23ctor%2A> 构造函数，为特定区域性创建新的 `CultureInfo` 对象。</span><span class="sxs-lookup"><span data-stu-id="b49ba-128">You can create a new `CultureInfo` object for a specific culture by passing the culture's name to the <xref:System.Globalization.CultureInfo.%23ctor%2A> constructor.</span></span> <span data-ttu-id="b49ba-129"><xref:System.Globalization.CultureInfo> 类帮助页中列出了支持的区域性名称。</span><span class="sxs-lookup"><span data-stu-id="b49ba-129">The supported culture names are listed in the <xref:System.Globalization.CultureInfo> class Help page.</span></span>  
  
 <span data-ttu-id="b49ba-130">或者，可以从 <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType> 属性获取*固定区域性*的实例。</span><span class="sxs-lookup"><span data-stu-id="b49ba-130">Alternatively, you can get an instance of the *invariant culture* from the <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="b49ba-131">固定区域性基于英语区域性，但有一些差异。</span><span class="sxs-lookup"><span data-stu-id="b49ba-131">The invariant culture is based on the English culture, but there are some differences.</span></span> <span data-ttu-id="b49ba-132">例如，固定区域性指定24小时制，而不是12小时制时钟。</span><span class="sxs-lookup"><span data-stu-id="b49ba-132">For example, the invariant culture specifies a 24-hour clock instead of a 12-hour clock.</span></span>  
  
 <span data-ttu-id="b49ba-133">若要将日期转换为区域性的字符串，请将 <xref:System.Globalization.CultureInfo> 对象传递到 date 对象的 <xref:System.DateTime.ToString%28System.IFormatProvider%29> 方法。</span><span class="sxs-lookup"><span data-stu-id="b49ba-133">To convert a date to the culture's string, pass the <xref:System.Globalization.CultureInfo> object to the date object's <xref:System.DateTime.ToString%28System.IFormatProvider%29> method.</span></span> <span data-ttu-id="b49ba-134">例如，下面的代码显示 "07/04/2005 00:00:00"，而不管应用程序的区域性设置如何。</span><span class="sxs-lookup"><span data-stu-id="b49ba-134">For example, the following code displays "07/04/2005 00:00:00", regardless of the application's culture settings.</span></span>  
  
 [!code-vb[VbVbalrConcepts#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrConcepts/VB/Class1.vb#1)]  
  
> [!NOTE]
> <span data-ttu-id="b49ba-135">始终根据英语区域性解释日期文本。</span><span class="sxs-lookup"><span data-stu-id="b49ba-135">Date literals are always interpreted according to the English culture.</span></span>  
  
## <a name="comparing-strings"></a><span data-ttu-id="b49ba-136">比较字符串</span><span class="sxs-lookup"><span data-stu-id="b49ba-136">Comparing Strings</span></span>  
 <span data-ttu-id="b49ba-137">需要进行字符串比较的两个重要情况如下：</span><span class="sxs-lookup"><span data-stu-id="b49ba-137">There are two important situations where string comparisons are needed:</span></span>  
  
- <span data-ttu-id="b49ba-138">**为向用户显示的数据排序。**</span><span class="sxs-lookup"><span data-stu-id="b49ba-138">**Sorting data for display to the user.**</span></span> <span data-ttu-id="b49ba-139">使用基于当前区域性的操作，以便字符串进行适当排序。</span><span class="sxs-lookup"><span data-stu-id="b49ba-139">Use operations based on the current culture so the strings sort appropriately.</span></span>  
  
- <span data-ttu-id="b49ba-140">**确定两个应用程序内部字符串是否完全匹配（通常出于安全目的）。**</span><span class="sxs-lookup"><span data-stu-id="b49ba-140">**Determining if two application-internal strings exactly match (typically for security purposes).**</span></span> <span data-ttu-id="b49ba-141">使用忽略当前区域性的操作。</span><span class="sxs-lookup"><span data-stu-id="b49ba-141">Use operations that disregard the current culture.</span></span>  
  
 <span data-ttu-id="b49ba-142">您可以与 Visual Basic <xref:Microsoft.VisualBasic.Strings.StrComp%2A> 函数同时执行这两种类型的比较。</span><span class="sxs-lookup"><span data-stu-id="b49ba-142">You can perform both types of comparisons with the Visual Basic <xref:Microsoft.VisualBasic.Strings.StrComp%2A> function.</span></span> <span data-ttu-id="b49ba-143">指定可选 `Compare` 参数以控制比较的类型：用于确定完全匹配项的大多数输入和输出 `Binary` `Text`。</span><span class="sxs-lookup"><span data-stu-id="b49ba-143">Specify the optional `Compare` argument to control the type of comparison: `Text` for most input and output `Binary` for determining exact matches.</span></span>  
  
 <span data-ttu-id="b49ba-144">`StrComp` 函数返回一个整数，该整数指示这两个比较的字符串之间的关系，这两个字符串基于排序顺序。</span><span class="sxs-lookup"><span data-stu-id="b49ba-144">The `StrComp` function returns an integer that indicates the relationship between the two compared strings based on the sorting order.</span></span> <span data-ttu-id="b49ba-145">如果结果为正值，则指示第一个字符串大于第二个字符串。</span><span class="sxs-lookup"><span data-stu-id="b49ba-145">A positive value for the result indicates that the first string is greater than the second string.</span></span> <span data-ttu-id="b49ba-146">如果结果为负，则指示第一个字符串较小，0表示字符串之间相等。</span><span class="sxs-lookup"><span data-stu-id="b49ba-146">A negative result indicates the first string is smaller, and zero indicates equality between the strings.</span></span>  
  
 [!code-vb[VbVbalrStrings#22](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStrings/VB/Class1.vb#22)]  
  
 <span data-ttu-id="b49ba-147">你还可以使用 `StrComp` 函数 .NET Framework 合作伙伴，<xref:System.String.Compare%2A?displayProperty=nameWithType> 方法。</span><span class="sxs-lookup"><span data-stu-id="b49ba-147">You can also use the .NET Framework partner of the `StrComp` function, the <xref:System.String.Compare%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="b49ba-148">这是基字符串类的静态重载方法。</span><span class="sxs-lookup"><span data-stu-id="b49ba-148">This is a static, overloaded method of the base string class.</span></span> <span data-ttu-id="b49ba-149">下面的示例演示如何使用此方法：</span><span class="sxs-lookup"><span data-stu-id="b49ba-149">The following example illustrates how this method is used:</span></span>  
  
 [!code-vb[VbVbalrStrings#48](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStrings/VB/Class2.vb#48)]  
  
 <span data-ttu-id="b49ba-150">为了更好地控制执行比较的方式，可以使用 <xref:System.String.Compare%2A> 方法的其他重载。</span><span class="sxs-lookup"><span data-stu-id="b49ba-150">For finer control over how the comparisons are performed, you can use additional overloads of the <xref:System.String.Compare%2A> method.</span></span> <span data-ttu-id="b49ba-151">使用 <xref:System.String.Compare%2A?displayProperty=nameWithType> 方法，您可以使用 `comparisonType` 参数指定要使用的比较类型。</span><span class="sxs-lookup"><span data-stu-id="b49ba-151">With the <xref:System.String.Compare%2A?displayProperty=nameWithType> method, you can use the `comparisonType` argument to specify which type of comparison to use.</span></span>  
  
|<span data-ttu-id="b49ba-152">`comparisonType` 参数的值</span><span class="sxs-lookup"><span data-stu-id="b49ba-152">Value for `comparisonType` argument</span></span>|<span data-ttu-id="b49ba-153">比较类型</span><span class="sxs-lookup"><span data-stu-id="b49ba-153">Type of comparison</span></span>|<span data-ttu-id="b49ba-154">何时使用</span><span class="sxs-lookup"><span data-stu-id="b49ba-154">When to use</span></span>|  
|---|---|---|  
|`Ordinal`|<span data-ttu-id="b49ba-155">基于字符串的组件字节的比较。</span><span class="sxs-lookup"><span data-stu-id="b49ba-155">Comparison based on strings' component bytes.</span></span>|<span data-ttu-id="b49ba-156">比较时使用此值：区分大小写的标识符、与安全相关的设置，或字节必须完全匹配的其他非语言标识符。</span><span class="sxs-lookup"><span data-stu-id="b49ba-156">Use this value when comparing: case-sensitive identifiers, security-related settings, or other non-linguistic identifiers where the bytes must match exactly.</span></span>|  
|`OrdinalIgnoreCase`|<span data-ttu-id="b49ba-157">基于字符串的组件字节的比较。</span><span class="sxs-lookup"><span data-stu-id="b49ba-157">Comparison based on strings' component bytes.</span></span><br /><br /> <span data-ttu-id="b49ba-158">`OrdinalIgnoreCase` 使用固定区域性信息确定两个字符的大小写不同。</span><span class="sxs-lookup"><span data-stu-id="b49ba-158">`OrdinalIgnoreCase` uses the invariant culture information to determine when two characters differ only in capitalization.</span></span>|<span data-ttu-id="b49ba-159">比较时使用此值：不区分大小写的标识符、与安全相关的设置和存储在 Windows 中的数据。</span><span class="sxs-lookup"><span data-stu-id="b49ba-159">Use this value when comparing: case-insensitive identifiers, security-related settings, and data stored in Windows.</span></span>|  
|<span data-ttu-id="b49ba-160">`CurrentCulture` 或 `CurrentCultureIgnoreCase`</span><span class="sxs-lookup"><span data-stu-id="b49ba-160">`CurrentCulture` or `CurrentCultureIgnoreCase`</span></span>|<span data-ttu-id="b49ba-161">基于当前区域性中的字符串解释的比较。</span><span class="sxs-lookup"><span data-stu-id="b49ba-161">Comparison based on the strings' interpretation in the current culture.</span></span>|<span data-ttu-id="b49ba-162">比较时使用这些值：向用户显示的数据、大多数用户输入和需要语言解释的其他数据。</span><span class="sxs-lookup"><span data-stu-id="b49ba-162">Use these values when comparing: data that is displayed to the user, most user input, and other data that requires linguistic interpretation.</span></span>|  
|<span data-ttu-id="b49ba-163">`InvariantCulture` 或 `InvariantCultureIgnoreCase`</span><span class="sxs-lookup"><span data-stu-id="b49ba-163">`InvariantCulture` or `InvariantCultureIgnoreCase`</span></span>|<span data-ttu-id="b49ba-164">基于字符串在固定区域性中的解释的比较。</span><span class="sxs-lookup"><span data-stu-id="b49ba-164">Comparison based on the strings' interpretation in the invariant culture.</span></span><br /><br /> <span data-ttu-id="b49ba-165">这不同于 `Ordinal` 和 `OrdinalIgnoreCase`，因为固定区域性会将其接受范围外的字符视为等效的固定字符。</span><span class="sxs-lookup"><span data-stu-id="b49ba-165">This is different than the `Ordinal` and `OrdinalIgnoreCase`, because the invariant culture treats characters outside its accepted range as equivalent invariant characters.</span></span>|<span data-ttu-id="b49ba-166">仅在比较持久化数据或显示需要固定排序顺序的语言相关数据时，才使用这些值。</span><span class="sxs-lookup"><span data-stu-id="b49ba-166">Use these values only when comparing persisting data or displaying linguistically-relevant data that requires a fixed sort order.</span></span>|  
  
### <a name="security-considerations"></a><span data-ttu-id="b49ba-167">安全注意事项</span><span class="sxs-lookup"><span data-stu-id="b49ba-167">Security Considerations</span></span>  
 <span data-ttu-id="b49ba-168">如果你的应用程序根据比较或大小写更改操作的结果做出安全决策，则操作应使用 <xref:System.String.Compare%2A?displayProperty=nameWithType> 方法，并为 `comparisonType` 参数传递 `Ordinal` 或 `OrdinalIgnoreCase`。</span><span class="sxs-lookup"><span data-stu-id="b49ba-168">If your application makes security decisions based on the result of a comparison or case-change operation, then the operation should use the <xref:System.String.Compare%2A?displayProperty=nameWithType> method, and pass `Ordinal` or `OrdinalIgnoreCase` for the `comparisonType` argument.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b49ba-169">另请参阅</span><span class="sxs-lookup"><span data-stu-id="b49ba-169">See also</span></span>

- <xref:System.Globalization.CultureInfo>
- [<span data-ttu-id="b49ba-170">Visual Basic 中的字符串简介</span><span class="sxs-lookup"><span data-stu-id="b49ba-170">Introduction to Strings in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/strings/introduction-to-strings.md)
- [<span data-ttu-id="b49ba-171">Type Conversion Functions</span><span class="sxs-lookup"><span data-stu-id="b49ba-171">Type Conversion Functions</span></span>](../../../../visual-basic/language-reference/functions/type-conversion-functions.md)
