---
title: 导出 WCF 扩展的自定义元数据
ms.date: 03/30/2017
ms.assetid: 53c93882-f8ba-4192-965b-787b5e3f09c0
ms.openlocfilehash: 5134b57c59268b139239021bc2b4f6f4538ad27d
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "61857956"
---
# <a name="exporting-custom-metadata-for-a-wcf-extension"></a><span data-ttu-id="8ffcd-102">导出 WCF 扩展的自定义元数据</span><span class="sxs-lookup"><span data-stu-id="8ffcd-102">Exporting Custom Metadata for a WCF Extension</span></span>
<span data-ttu-id="8ffcd-103">在 Windows Communication Foundation (WCF) 中，元数据导出是描述服务终结点并将它们投影到客户端可用来了解如何使用服务的并行的标准化表示形式的过程。</span><span class="sxs-lookup"><span data-stu-id="8ffcd-103">In Windows Communication Foundation (WCF), metadata export is the process of describing service endpoints and projecting them into a parallel, standardized representation that clients can use to understand how to use the service.</span></span> <span data-ttu-id="8ffcd-104">自定义元数据包含系统提供的元数据导出程序无法导出的 XML 元素。</span><span class="sxs-lookup"><span data-stu-id="8ffcd-104">Custom metadata consists of XML elements that the system-provided metadata exporters cannot export.</span></span> <span data-ttu-id="8ffcd-105">通常，这包括自定义 WSDL 元素（用于用户定义的行为）、绑定元素和策略断言（与绑定和协定的功能和需求有关）。</span><span class="sxs-lookup"><span data-stu-id="8ffcd-105">Typically, this includes custom WSDL elements for user-defined behaviors and binding elements and policy assertions about the capabilities and requirements of bindings and contracts.</span></span>  
  
 <span data-ttu-id="8ffcd-106">本节介绍如何导出自定义 WSDL 或策略断言，而不关注导出过程本身。</span><span class="sxs-lookup"><span data-stu-id="8ffcd-106">This section describes exporting custom WSDL or policy assertions, and does not focus on the exporting process itself.</span></span> <span data-ttu-id="8ffcd-107">有关如何使用导出和导入元数据，而不管元数据是自定义的还是系统构造的类型的详细信息，请参阅[导出和导入元数据](../../../../docs/framework/wcf/feature-details/exporting-and-importing-metadata.md)。</span><span class="sxs-lookup"><span data-stu-id="8ffcd-107">For more information about how to use the types that export and import metadata regardless of whether the metadata is custom or system-constructed, see [Exporting and Importing Metadata](../../../../docs/framework/wcf/feature-details/exporting-and-importing-metadata.md).</span></span>  
  
## <a name="overview"></a><span data-ttu-id="8ffcd-108">概述</span><span class="sxs-lookup"><span data-stu-id="8ffcd-108">Overview</span></span>  
 <span data-ttu-id="8ffcd-109">当使用发布元数据<xref:System.ServiceModel.Description.ServiceMetadataBehavior?displayProperty=nameWithType>，则<xref:System.ServiceModel.Description.ServiceDescription?displayProperty=nameWithType>检查和 XSD 和 WSDL-包括策略断言-生成的所有协定和 WCF 可以支持使用系统提供的属性和绑定的绑定。</span><span class="sxs-lookup"><span data-stu-id="8ffcd-109">When metadata is published using the <xref:System.ServiceModel.Description.ServiceMetadataBehavior?displayProperty=nameWithType>, the <xref:System.ServiceModel.Description.ServiceDescription?displayProperty=nameWithType> is examined and XSD and WSDL -- including policy assertions -- are generated for all contracts and bindings that WCF can support using system-provided attributes and bindings.</span></span> <span data-ttu-id="8ffcd-110">但是，自定义行为属性或绑定元素需要获得支持才能正确导出。</span><span class="sxs-lookup"><span data-stu-id="8ffcd-110">However, custom behavior attributes or binding elements require support before they can be exported properly.</span></span>  
  
 <span data-ttu-id="8ffcd-111">本节介绍以下内容：</span><span class="sxs-lookup"><span data-stu-id="8ffcd-111">This section describes:</span></span>  
  
1. <span data-ttu-id="8ffcd-112">如何实现和使用 <xref:System.ServiceModel.Description.IWsdlExportExtension?displayProperty=nameWithType> 接口，该接口在发布 WSDL 之前向您公开 WSDL 生成数据。</span><span class="sxs-lookup"><span data-stu-id="8ffcd-112">How to implement and use the <xref:System.ServiceModel.Description.IWsdlExportExtension?displayProperty=nameWithType> interface, which exposes the WSDL generation data to you prior to publishing the WSDL.</span></span>  
  
2. <span data-ttu-id="8ffcd-113">如何实现和使用 <xref:System.ServiceModel.Description.IPolicyExportExtension?displayProperty=nameWithType> 接口，该接口在导出 WSDL 数据中的策略断言之前向您公开策略数据。</span><span class="sxs-lookup"><span data-stu-id="8ffcd-113">How to implement and use the <xref:System.ServiceModel.Description.IPolicyExportExtension?displayProperty=nameWithType> interface, which exposes the policy data to you prior to exporting the policy assertions in WSDL data.</span></span>  
  
 <span data-ttu-id="8ffcd-114">有关导入自定义 WSDL 和策略断言的详细信息，请参阅[导入 WCF 扩展的自定义元数据](../../../../docs/framework/wcf/extending/importing-custom-metadata-for-a-wcf-extension.md)。</span><span class="sxs-lookup"><span data-stu-id="8ffcd-114">For more information about importing custom WSDL and policy assertions, see [Importing Custom Metadata for a WCF Extension](../../../../docs/framework/wcf/extending/importing-custom-metadata-for-a-wcf-extension.md).</span></span>  
  
## <a name="exporting-custom-wsdl-elements"></a><span data-ttu-id="8ffcd-115">导出自定义 WSDL 元素</span><span class="sxs-lookup"><span data-stu-id="8ffcd-115">Exporting Custom WSDL Elements</span></span>  
 <span data-ttu-id="8ffcd-116">在操作行为、协定行为、终结点行为或绑定元素（分别为 <xref:System.ServiceModel.Description.IWsdlExportExtension>、<xref:System.ServiceModel.Description.IOperationBehavior>、<xref:System.ServiceModel.Description.IContractBehavior> 或 <xref:System.ServiceModel.Description.IEndpointBehavior>）上实现 <xref:System.ServiceModel.Channels.BindingElement?displayProperty=nameWithType>，并将行为或绑定元素插入正试图导出的服务的说明中。</span><span class="sxs-lookup"><span data-stu-id="8ffcd-116">Implement the <xref:System.ServiceModel.Description.IWsdlExportExtension> on an operation behavior, contract behavior, endpoint behavior or binding element (<xref:System.ServiceModel.Description.IOperationBehavior>, <xref:System.ServiceModel.Description.IContractBehavior>, <xref:System.ServiceModel.Description.IEndpointBehavior>, or <xref:System.ServiceModel.Channels.BindingElement?displayProperty=nameWithType> respectively) and insert the behaviors or binding elements into the description of the service that you are trying to export.</span></span> <span data-ttu-id="8ffcd-117">(有关插入行为的详细信息，请参阅[配置和扩展的运行时行为带有](../../../../docs/framework/wcf/extending/configuring-and-extending-the-runtime-with-behaviors.md))。</span><span class="sxs-lookup"><span data-stu-id="8ffcd-117">(For more information about inserting behaviors, see [Configuring and Extending the Runtime with Behaviors](../../../../docs/framework/wcf/extending/configuring-and-extending-the-runtime-with-behaviors.md)).</span></span> <span data-ttu-id="8ffcd-118">为每个终结点调用 <xref:System.ServiceModel.Description.IWsdlExportExtension>，然后每个终结点首先导出协定（如果协定尚未导出）。</span><span class="sxs-lookup"><span data-stu-id="8ffcd-118">The <xref:System.ServiceModel.Description.IWsdlExportExtension> is called for each endpoint and each endpoint exports the contract first if it has not already been exported.</span></span> <span data-ttu-id="8ffcd-119">您可以执行以下任一导出过程，具体取决于您的需要：</span><span class="sxs-lookup"><span data-stu-id="8ffcd-119">You can participate in either export process, depending upon your needs:</span></span>  
  
- <span data-ttu-id="8ffcd-120">使用 <xref:System.ServiceModel.Description.WsdlContractConversionContext> 修改 <xref:System.ServiceModel.Description.IWsdlExportExtension.ExportContract%2A> 方法中导出的元数据。</span><span class="sxs-lookup"><span data-stu-id="8ffcd-120">Use the <xref:System.ServiceModel.Description.WsdlContractConversionContext> to modify the exported metadata in the <xref:System.ServiceModel.Description.IWsdlExportExtension.ExportContract%2A> method.</span></span>  
  
- <span data-ttu-id="8ffcd-121">使用 <xref:System.ServiceModel.Description.WsdlEndpointConversionContext> 修改 <xref:System.ServiceModel.Description.IWsdlExportExtension.ExportEndpoint%2A> 方法导出的终结点的元数据。</span><span class="sxs-lookup"><span data-stu-id="8ffcd-121">Use the <xref:System.ServiceModel.Description.WsdlEndpointConversionContext> to modify the exported metadata for the endpoint in the <xref:System.ServiceModel.Description.IWsdlExportExtension.ExportEndpoint%2A> method.</span></span>  
  
 <span data-ttu-id="8ffcd-122">在正在导出的 <xref:System.ServiceModel.Description.IWsdlExportExtension.ExportContract%2A> 实例中，所有 <xref:System.ServiceModel.Description.IWsdlExportExtension> 实现上都会调用 <xref:System.ServiceModel.Description.ContractDescription?displayProperty=nameWithType> 方法。</span><span class="sxs-lookup"><span data-stu-id="8ffcd-122">The <xref:System.ServiceModel.Description.IWsdlExportExtension.ExportContract%2A> method is called on all <xref:System.ServiceModel.Description.IWsdlExportExtension> implementations within the <xref:System.ServiceModel.Description.ContractDescription?displayProperty=nameWithType> instance that is being exported.</span></span>  <span data-ttu-id="8ffcd-123">在正在导出的 <xref:System.ServiceModel.Description.IWsdlExportExtension.ExportEndpoint%2A> 实例中，所有 <xref:System.ServiceModel.Description.IWsdlExportExtension> 实现上都会调用 <xref:System.ServiceModel.Description.ServiceEndpoint?displayProperty=nameWithType> 方法。</span><span class="sxs-lookup"><span data-stu-id="8ffcd-123">The <xref:System.ServiceModel.Description.IWsdlExportExtension.ExportEndpoint%2A> method is called on all <xref:System.ServiceModel.Description.IWsdlExportExtension> implementations with the <xref:System.ServiceModel.Description.ServiceEndpoint?displayProperty=nameWithType> instance that is being exported.</span></span>  
  
 <span data-ttu-id="8ffcd-124">有关详细信息，请参阅[如何：导出自定义 WSDL](../../../../docs/framework/wcf/extending/how-to-export-custom-wsdl.md)示例和示例[自定义 WSDL 发布](../../../../docs/framework/wcf/samples/custom-wsdl-publication.md)。</span><span class="sxs-lookup"><span data-stu-id="8ffcd-124">For more information, see [How to: Export Custom WSDL](../../../../docs/framework/wcf/extending/how-to-export-custom-wsdl.md) and the sample [Custom WSDL Publication](../../../../docs/framework/wcf/samples/custom-wsdl-publication.md).</span></span>  
  
## <a name="exporting-custom-policy-assertions"></a><span data-ttu-id="8ffcd-125">导出自定义策略断言</span><span class="sxs-lookup"><span data-stu-id="8ffcd-125">Exporting Custom Policy Assertions</span></span>  
 <span data-ttu-id="8ffcd-126">在 <xref:System.ServiceModel.Description.IPolicyExportExtension> 上实现 <xref:System.ServiceModel.Channels.BindingElement> 并将绑定元素添加到绑定，可以将有关绑定支持和协定功能的自定义策略断言写入 WSDL。</span><span class="sxs-lookup"><span data-stu-id="8ffcd-126">Implement the <xref:System.ServiceModel.Description.IPolicyExportExtension> on a <xref:System.ServiceModel.Channels.BindingElement> and add the binding element to the binding to write custom policy assertions about binding support and contract capabilities into the WSDL.</span></span> <span data-ttu-id="8ffcd-127">在导出绑定中的已实现绑定元素后，即会调用 <xref:System.ServiceModel.Description.IPolicyExportExtension>，并将 <xref:System.ServiceModel.Description.PolicyConversionContext> 传递到 <xref:System.ServiceModel.Description.IPolicyExportExtension.ExportPolicy%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="8ffcd-127">The <xref:System.ServiceModel.Description.IPolicyExportExtension> is called once when exporting the implemented binding element in a binding and passes the <xref:System.ServiceModel.Description.PolicyConversionContext> to the <xref:System.ServiceModel.Description.IPolicyExportExtension.ExportPolicy%2A> method.</span></span> <span data-ttu-id="8ffcd-128">使用 <xref:System.ServiceModel.Description.PolicyConversionContext> 实例的方法，可以向附加到 WSDL 绑定的消息、操作或终结点主题的策略断言进行添加操作。</span><span class="sxs-lookup"><span data-stu-id="8ffcd-128">You can use the methods on the <xref:System.ServiceModel.Description.PolicyConversionContext> instance to add to the policy assertions attached to the WSDL binding at the message, operation or endpoint subjects.</span></span>  
  
 <span data-ttu-id="8ffcd-129">有关详细信息，请参阅[如何：导出自定义策略断言](../../../../docs/framework/wcf/extending/how-to-export-custom-policy-assertions.md)。</span><span class="sxs-lookup"><span data-stu-id="8ffcd-129">For more information, see [How to: Export Custom Policy Assertions](../../../../docs/framework/wcf/extending/how-to-export-custom-policy-assertions.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8ffcd-130">请参阅</span><span class="sxs-lookup"><span data-stu-id="8ffcd-130">See also</span></span>

- [<span data-ttu-id="8ffcd-131">如何：导出自定义 WSDL</span><span class="sxs-lookup"><span data-stu-id="8ffcd-131">How to: Export Custom WSDL</span></span>](../../../../docs/framework/wcf/extending/how-to-export-custom-wsdl.md)
- [<span data-ttu-id="8ffcd-132">如何：导出自定义策略断言</span><span class="sxs-lookup"><span data-stu-id="8ffcd-132">How to: Export Custom Policy Assertions</span></span>](../../../../docs/framework/wcf/extending/how-to-export-custom-policy-assertions.md)
- [<span data-ttu-id="8ffcd-133">导入 WCF 扩展的自定义元数据</span><span class="sxs-lookup"><span data-stu-id="8ffcd-133">Importing Custom Metadata for a WCF Extension</span></span>](../../../../docs/framework/wcf/extending/importing-custom-metadata-for-a-wcf-extension.md)
