---
title: WCF Discovery 对象模型
ms.date: 03/30/2017
ms.assetid: 8365a152-eacd-4779-9130-bbc48fa5c5d9
ms.openlocfilehash: b337eda40fc70a6d0e7b3aeccfc125e6e6bacf8f
ms.sourcegitcommit: 213292dfbb0c37d83f62709959ff55c50af5560d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/25/2018
ms.locfileid: "47070872"
---
# <a name="wcf-discovery-object-model"></a><span data-ttu-id="30184-102">WCF Discovery 对象模型</span><span class="sxs-lookup"><span data-stu-id="30184-102">WCF Discovery Object Model</span></span>
<span data-ttu-id="30184-103">WCF Discovery 由一组类型组成，通过这些类型提供的统一编程模型，您可以编写在运行时可发现的服务以及查找并使用这些服务的客户端。</span><span class="sxs-lookup"><span data-stu-id="30184-103">WCF Discovery consists of a set of types that provide a unified programming model that allows you to write services that are discoverable at runtime and clients that find and use these services.</span></span>  
  
## <a name="making-a-service-discoverable-and-finding-services"></a><span data-ttu-id="30184-104">使服务成为可发现的服务和查找服务</span><span class="sxs-lookup"><span data-stu-id="30184-104">Making a Service Discoverable and Finding Services</span></span>  
 <span data-ttu-id="30184-105">若要使 WCF 服务成为可发现的服务，请将 <xref:System.ServiceModel.Discovery.ServiceDiscoveryBehavior> 添加到服务主机的 <xref:System.ServiceModel.Description.ServiceDescription>，并添加一个发现终结点。</span><span class="sxs-lookup"><span data-stu-id="30184-105">To make a WCF service discoverable, add a <xref:System.ServiceModel.Discovery.ServiceDiscoveryBehavior> to the <xref:System.ServiceModel.Description.ServiceDescription> of the service host and add a discovery endpoint.</span></span> <span data-ttu-id="30184-106">如果服务已配置为发送公告消息（通过添加 <xref:System.ServiceModel.Discovery.AnnouncementEndpoint>），则在打开和关闭服务主机时，将发送公告。</span><span class="sxs-lookup"><span data-stu-id="30184-106">If a service is configured to send announcement messages (by adding an <xref:System.ServiceModel.Discovery.AnnouncementEndpoint>) the announcement is sent when the service host is opened and closed.</span></span>  
  
 <span data-ttu-id="30184-107">需要侦听服务公告消息的客户端承载公告服务并添加一个或多个公告终结点。</span><span class="sxs-lookup"><span data-stu-id="30184-107">A client that wants to listen for service announcement messages hosts an announcement service and adds one or more announcement endpoints.</span></span> <span data-ttu-id="30184-108">公告服务接收公告消息并引发公告事件。</span><span class="sxs-lookup"><span data-stu-id="30184-108">The announcement service receives announcement messages and raises announcement events.</span></span>  
  
 <span data-ttu-id="30184-109">客户端使用 <xref:System.ServiceModel.Discovery.DiscoveryClient> 类来搜索可用服务。</span><span class="sxs-lookup"><span data-stu-id="30184-109">A client uses the <xref:System.ServiceModel.Discovery.DiscoveryClient> class to search for available services.</span></span> <span data-ttu-id="30184-110">客户端应用程序实例化 <xref:System.ServiceModel.Discovery.DiscoveryClient> 类，并传入一个指定将发现消息发送到的位置的发现终结点。</span><span class="sxs-lookup"><span data-stu-id="30184-110">The client application instantiates the <xref:System.ServiceModel.Discovery.DiscoveryClient> class, passing in a discovery endpoint that specifies where to send discovery messages.</span></span> <span data-ttu-id="30184-111">客户端调用 <xref:System.ServiceModel.Discovery.DiscoveryClient.Find%2A> 方法，该方法发送 `Probe` 请求。</span><span class="sxs-lookup"><span data-stu-id="30184-111">The client calls the <xref:System.ServiceModel.Discovery.DiscoveryClient.Find%2A> method, which sends a `Probe` request.</span></span> <span data-ttu-id="30184-112">侦听发现消息的服务接收此 `Probe` 请求。</span><span class="sxs-lookup"><span data-stu-id="30184-112">Services listening for discovery messages receive this `Probe` request.</span></span> <span data-ttu-id="30184-113">如果服务与 `Probe` 中指定的条件匹配，则会将 `ProbeMatch` 消息发送回客户端。</span><span class="sxs-lookup"><span data-stu-id="30184-113">If the service matches the criteria specified in the `Probe`, it sends a `ProbeMatch` message back to the client.</span></span>  
  
## <a name="object-model"></a><span data-ttu-id="30184-114">对象模型</span><span class="sxs-lookup"><span data-stu-id="30184-114">Object Model</span></span>  
 <span data-ttu-id="30184-115">WCF Discovery API 定义了以下类：</span><span class="sxs-lookup"><span data-stu-id="30184-115">The WCF Discovery API defines the following classes:</span></span>  
  
-   <xref:System.ServiceModel.Discovery.AnnouncementClient>  
  
-   <xref:System.ServiceModel.Discovery.AnnouncementEndpoint>  
  
-   <xref:System.ServiceModel.Discovery.AnnouncementService>  
  
-   <xref:System.ServiceModel.Discovery.DiscoveryClient>  
  
-   <xref:System.ServiceModel.Discovery.DiscoveryEndpoint>  
  
-   <xref:System.ServiceModel.Discovery.DiscoveryClientBindingElement>  
  
-   <xref:System.ServiceModel.Discovery.DiscoveryMessageSequenceGenerator>  
  
-   <xref:System.ServiceModel.Discovery.ServiceDiscoveryMode>  
  
-   <xref:System.ServiceModel.Discovery.DiscoveryProxy>  
  
-   <xref:System.ServiceModel.Discovery.DiscoveryService>  
  
-   <xref:System.ServiceModel.Discovery.DiscoveryVersion>  
  
-   <xref:System.ServiceModel.Discovery.DynamicEndpoint>  
  
-   <xref:System.ServiceModel.Discovery.EndpointDiscoveryBehavior>  
  
-   <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata>  
  
-   <xref:System.ServiceModel.Discovery.FindCriteria>  
  
-   <xref:System.ServiceModel.Discovery.FindRequestContext>  
  
-   <xref:System.ServiceModel.Discovery.FindResponse>  
  
-   <xref:System.ServiceModel.Discovery.ResolveCriteria>  
  
-   <xref:System.ServiceModel.Discovery.ResolveResponse>  
  
-   <xref:System.ServiceModel.Discovery.ServiceDiscoveryBehavior>  
 
-   <xref:System.ServiceModel.Discovery.UdpAnnouncementEndpoint>  
  
-   <xref:System.ServiceModel.Discovery.UdpDiscoveryEndpoint>  
  
## <a name="announcementclient"></a><span data-ttu-id="30184-116">AnnouncementClient</span><span class="sxs-lookup"><span data-stu-id="30184-116">AnnouncementClient</span></span>  
 <span data-ttu-id="30184-117"><xref:System.ServiceModel.Discovery.AnnouncementClient> 类提供用于发送公告消息的同步和异步方法。</span><span class="sxs-lookup"><span data-stu-id="30184-117">The <xref:System.ServiceModel.Discovery.AnnouncementClient> class provides synchronous and asynchronous methods for sending announcement messages.</span></span> <span data-ttu-id="30184-118">公告消息有两种类型：Hello 和 Bye。</span><span class="sxs-lookup"><span data-stu-id="30184-118">There are two types of announcement messages, Hello and Bye.</span></span> <span data-ttu-id="30184-119">发送 Hello 消息可指示服务变为可用，发送 Bye 消息可指示现有服务变为不可用。</span><span class="sxs-lookup"><span data-stu-id="30184-119">A Hello message is sent to indicate that a service has become available and a Bye message is sent to indicate that an existing service has become unavailable.</span></span> <span data-ttu-id="30184-120">开发人员创建一个 <xref:System.ServiceModel.Discovery.AnnouncementClient> 实例，并将 <xref:System.ServiceModel.Discovery.AnnouncementEndpoint> 的实例作为构造函数参数进行传递。</span><span class="sxs-lookup"><span data-stu-id="30184-120">The developer creates an <xref:System.ServiceModel.Discovery.AnnouncementClient> instance, passing an instance of <xref:System.ServiceModel.Discovery.AnnouncementEndpoint> as a constructor parameter.</span></span>  
  
## <a name="announcementendpoint"></a><span data-ttu-id="30184-121">AnnouncementEndpoint</span><span class="sxs-lookup"><span data-stu-id="30184-121">AnnouncementEndpoint</span></span>  
 <span data-ttu-id="30184-122"><xref:System.ServiceModel.Discovery.AnnouncementEndpoint> 表示具有固定公告协定的标准终结点。</span><span class="sxs-lookup"><span data-stu-id="30184-122"><xref:System.ServiceModel.Discovery.AnnouncementEndpoint> represents a standard endpoint with a fixed announcement contract.</span></span> <span data-ttu-id="30184-123">该类由服务或客户端用来发送和接收公告消息。</span><span class="sxs-lookup"><span data-stu-id="30184-123">It is used by a service or client to send and receive announcement messages.</span></span> <span data-ttu-id="30184-124">默认情况下，<xref:System.ServiceModel.Discovery.AnnouncementEndpoint> 类设置为使用 WS_Discovery 11 协议版本。</span><span class="sxs-lookup"><span data-stu-id="30184-124">By default, the <xref:System.ServiceModel.Discovery.AnnouncementEndpoint> class is set to use the WS_Discovery 11 protocol version.</span></span>  
  
## <a name="announcementservice"></a><span data-ttu-id="30184-125">AnnouncementService</span><span class="sxs-lookup"><span data-stu-id="30184-125">AnnouncementService</span></span>  
 <span data-ttu-id="30184-126"><xref:System.ServiceModel.Discovery.AnnouncementService> 是系统提供的公告服务实现，用于接收和处理公告消息。</span><span class="sxs-lookup"><span data-stu-id="30184-126"><xref:System.ServiceModel.Discovery.AnnouncementService> is a system-provided implementation of an announcement service that receives and processes announcement messages.</span></span> <span data-ttu-id="30184-127">接收到 Hello 或 Bye 消息时，<xref:System.ServiceModel.Discovery.AnnouncementService> 实例将调用相应的虚拟方法 <xref:System.ServiceModel.Discovery.AnnouncementService.OnBeginOnlineAnnouncement%2A> 或 <xref:System.ServiceModel.Discovery.AnnouncementService.OnBeginOfflineAnnouncement%2A>，从而引发公告事件。</span><span class="sxs-lookup"><span data-stu-id="30184-127">When a Hello or Bye message is received, the <xref:System.ServiceModel.Discovery.AnnouncementService> instance calls the appropriate virtual method <xref:System.ServiceModel.Discovery.AnnouncementService.OnBeginOnlineAnnouncement%2A> or <xref:System.ServiceModel.Discovery.AnnouncementService.OnBeginOfflineAnnouncement%2A>, which raises announcement events.</span></span>  
  
## <a name="discoveryclient"></a><span data-ttu-id="30184-128">DiscoveryClient</span><span class="sxs-lookup"><span data-stu-id="30184-128">DiscoveryClient</span></span>  
 <span data-ttu-id="30184-129"><xref:System.ServiceModel.Discovery.DiscoveryClient> 类由客户端应用程序用来查找和解析可用服务。</span><span class="sxs-lookup"><span data-stu-id="30184-129">The <xref:System.ServiceModel.Discovery.DiscoveryClient> class is used by a client application to find and resolve available services.</span></span> <span data-ttu-id="30184-130">它根据指定的 <xref:System.ServiceModel.Discovery.FindCriteria> 和 <xref:System.ServiceModel.Discovery.ResolveCriteria>，分别提供用于查找和解析服务的同步和异步方法。</span><span class="sxs-lookup"><span data-stu-id="30184-130">It provides synchronous and asynchronous methods for finding and resolving services based on the specified <xref:System.ServiceModel.Discovery.FindCriteria> and <xref:System.ServiceModel.Discovery.ResolveCriteria> respectively.</span></span> <span data-ttu-id="30184-131">开发人员创建一个 <xref:System.ServiceModel.Discovery.DiscoveryClient> 实例，并作为构造函数参数提供 <xref:System.ServiceModel.Discovery.DiscoveryEndpoint> 的实例。</span><span class="sxs-lookup"><span data-stu-id="30184-131">The developer creates a <xref:System.ServiceModel.Discovery.DiscoveryClient> instance and provides an instance of <xref:System.ServiceModel.Discovery.DiscoveryEndpoint> as a constructor parameter.</span></span>  
  
 <span data-ttu-id="30184-132">为了查找服务，开发人员需调用同步或异步 `Find` 方法，该方法提供了一个包含要使用的搜索条件的 <xref:System.ServiceModel.Discovery.FindCriteria> 实例。</span><span class="sxs-lookup"><span data-stu-id="30184-132">To find a service, the developer invokes the synchronous or asynchronous `Find` method, which provides a <xref:System.ServiceModel.Discovery.FindCriteria> instance that contains the search criteria to use.</span></span> <span data-ttu-id="30184-133"><xref:System.ServiceModel.Discovery.DiscoveryClient> 创建一个具有相应标头的 `Probe` 消息并发送查找请求。</span><span class="sxs-lookup"><span data-stu-id="30184-133">The <xref:System.ServiceModel.Discovery.DiscoveryClient> creates a `Probe` message with the appropriate headers, and sends the find request.</span></span> <span data-ttu-id="30184-134">由于任何时候都可能存在多个未处理的 `Find` 请求，因此客户端会将接收到的响应关联并验证这些响应。</span><span class="sxs-lookup"><span data-stu-id="30184-134">Because there can be more than one outstanding `Find` request at any time, the client correlates the received responses and validates the response.</span></span> <span data-ttu-id="30184-135">然后，客户端使用 `Find` 将结果传递给 <xref:System.ServiceModel.Discovery.FindResponse> 操作的调用方。</span><span class="sxs-lookup"><span data-stu-id="30184-135">It then delivers the results to the caller of the `Find` operation using <xref:System.ServiceModel.Discovery.FindResponse>.</span></span>  
  
 <span data-ttu-id="30184-136">为了解析已知服务，开发人员将调用同步或异步 `Resolve` 方法，该方法提供包含已知服务的 <xref:System.ServiceModel.Discovery.ResolveCriteria> 的 <xref:System.ServiceModel.EndpointAddress> 实例。</span><span class="sxs-lookup"><span data-stu-id="30184-136">To resolve a known service, the developer invokes the synchronous or asynchronous `Resolve` method that provides an instance of <xref:System.ServiceModel.Discovery.ResolveCriteria> that contains the <xref:System.ServiceModel.EndpointAddress> of the known service.</span></span> <span data-ttu-id="30184-137"><xref:System.ServiceModel.Discovery.DiscoveryClient> 创建具有相应标头的 `Resolve` 消息并发送解析请求。</span><span class="sxs-lookup"><span data-stu-id="30184-137">The <xref:System.ServiceModel.Discovery.DiscoveryClient> creates the `Resolve` message with the appropriate headers and sends the resolve request.</span></span> <span data-ttu-id="30184-138">使用 `Resolve` 将接收到的响应与未处理的解析请求关联，并将结果传递给 <xref:System.ServiceModel.Discovery.ResolveResponse> 操作的调用方。</span><span class="sxs-lookup"><span data-stu-id="30184-138">The received response is correlated against the outstanding resolve requests and the result is delivered to the caller of the `Resolve` operation using <xref:System.ServiceModel.Discovery.ResolveResponse>.</span></span>  
  
 <span data-ttu-id="30184-139">如果网络中存在发现代理，并且 <xref:System.ServiceModel.Discovery.DiscoveryClient> 以多播方式发送发现请求，则发现代理可以使用多播禁止 Hello 消息进行响应。</span><span class="sxs-lookup"><span data-stu-id="30184-139">If a discovery proxy is present on the network and the <xref:System.ServiceModel.Discovery.DiscoveryClient> sends the discovery request in a multicast fashion, the discovery proxy can respond with the multicast suppression Hello message.</span></span> <span data-ttu-id="30184-140"><xref:System.ServiceModel.Discovery.DiscoveryClient> 在接收到 Hello 消息时将引发 `ProxyAvailable` 事件，以便响应未处理的 `Find` 或 `Resolve` 请求。</span><span class="sxs-lookup"><span data-stu-id="30184-140">The <xref:System.ServiceModel.Discovery.DiscoveryClient> raises the `ProxyAvailable` event when it receives Hello messages in response to outstanding `Find` or `Resolve` requests.</span></span> <span data-ttu-id="30184-141">`ProxyAvailable` 事件包含有关发现代理的 <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata>。</span><span class="sxs-lookup"><span data-stu-id="30184-141">The `ProxyAvailable` event contains the <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata> about the discovery proxy.</span></span> <span data-ttu-id="30184-142">开发人员可以决定是否使用此信息从临时模式切换到托管模式。</span><span class="sxs-lookup"><span data-stu-id="30184-142">It is up to the developer to use this information to switch from Ad hoc to Managed mode.</span></span>  
  
## <a name="discoveryendpoint"></a><span data-ttu-id="30184-143">DiscoveryEndpoint</span><span class="sxs-lookup"><span data-stu-id="30184-143">DiscoveryEndpoint</span></span>  
 <span data-ttu-id="30184-144"><xref:System.ServiceModel.Discovery.DiscoveryEndpoint> 表示具有固定发现协定的标准终结点。</span><span class="sxs-lookup"><span data-stu-id="30184-144"><xref:System.ServiceModel.Discovery.DiscoveryEndpoint> represents a standard endpoint with a fixed discovery contract.</span></span> <span data-ttu-id="30184-145">该类由服务或客户端用来发送或接收发现消息。</span><span class="sxs-lookup"><span data-stu-id="30184-145">It is used by a service or client to send or receive discovery messages.</span></span> <span data-ttu-id="30184-146">默认情况下，<xref:System.ServiceModel.Discovery.DiscoveryEndpoint> 设置为使用 <xref:System.ServiceModel.Discovery.ServiceDiscoveryMode.Managed?displayProperty=nameWithType> 方法和 WSDiscovery11 WS-Discovery 版本。</span><span class="sxs-lookup"><span data-stu-id="30184-146">By default, <xref:System.ServiceModel.Discovery.DiscoveryEndpoint> is set to use <xref:System.ServiceModel.Discovery.ServiceDiscoveryMode.Managed?displayProperty=nameWithType> mode and the WSDiscovery11 WS-Discovery version.</span></span>  
  
## <a name="discoverymessagesequencegenerator"></a><span data-ttu-id="30184-147">DiscoveryMessageSequenceGenerator</span><span class="sxs-lookup"><span data-stu-id="30184-147">DiscoveryMessageSequenceGenerator</span></span>  
 <span data-ttu-id="30184-148"><xref:System.ServiceModel.Discovery.DiscoveryMessageSequenceGenerator> 用于在服务发出发现消息或公告消息时生成 <xref:System.ServiceModel.Discovery.DiscoveryMessageSequence>。</span><span class="sxs-lookup"><span data-stu-id="30184-148"><xref:System.ServiceModel.Discovery.DiscoveryMessageSequenceGenerator> is used to generate a <xref:System.ServiceModel.Discovery.DiscoveryMessageSequence> when the service is sending out Discovery or Announcement messages.</span></span>  
  
## <a name="discoveryservice"></a><span data-ttu-id="30184-149">DiscoveryService</span><span class="sxs-lookup"><span data-stu-id="30184-149">DiscoveryService</span></span>  
 <span data-ttu-id="30184-150"><xref:System.ServiceModel.Discovery.DiscoveryService> 抽象类提供用于接收并处理 `Probe` 和 `Resolve` 消息的框架。</span><span class="sxs-lookup"><span data-stu-id="30184-150">The <xref:System.ServiceModel.Discovery.DiscoveryService> abstract class provides a framework for receiving and processing `Probe` and `Resolve` messages.</span></span> <span data-ttu-id="30184-151">接收到 `Probe` 消息时，<xref:System.ServiceModel.Discovery.DiscoveryService> 将根据传入消息创建一个 <xref:System.ServiceModel.Discovery.FindRequestContext> 实例并调用 <xref:System.ServiceModel.Discovery.DiscoveryService.OnBeginFind%2A> 虚拟方法。</span><span class="sxs-lookup"><span data-stu-id="30184-151">When a `Probe` message is received, <xref:System.ServiceModel.Discovery.DiscoveryService> creates an instance of <xref:System.ServiceModel.Discovery.FindRequestContext> based on the incoming message and invokes the <xref:System.ServiceModel.Discovery.DiscoveryService.OnBeginFind%2A> virtual method.</span></span> <span data-ttu-id="30184-152">接收到 `Resolve` 消息时，<xref:System.ServiceModel.Discovery.DiscoveryService> 将调用 <xref:System.ServiceModel.Discovery.DiscoveryService.OnBeginResolve%2A> 虚拟方法。</span><span class="sxs-lookup"><span data-stu-id="30184-152">When a `Resolve` message is received, <xref:System.ServiceModel.Discovery.DiscoveryService> invokes the <xref:System.ServiceModel.Discovery.DiscoveryService.OnBeginResolve%2A> virtual method.</span></span> <span data-ttu-id="30184-153">可以从此类继承以提供自定义发现服务实现。</span><span class="sxs-lookup"><span data-stu-id="30184-153">You can inherit from this class to provide a custom Discovery Service implementation.</span></span>  
  
## <a name="discoveryproxy"></a><span data-ttu-id="30184-154">DiscoveryProxy</span><span class="sxs-lookup"><span data-stu-id="30184-154">DiscoveryProxy</span></span>  
 <span data-ttu-id="30184-155"><xref:System.ServiceModel.Discovery.DiscoveryProxy> 抽象类提供用于接收并处理发现消息和公告消息的框架。</span><span class="sxs-lookup"><span data-stu-id="30184-155">The <xref:System.ServiceModel.Discovery.DiscoveryProxy> abstract class provides a framework for receiving and processing discovery and announcement messages.</span></span> <span data-ttu-id="30184-156">实现自定义发现代理时可以从此类继承。</span><span class="sxs-lookup"><span data-stu-id="30184-156">You inherit from this class when you are implementing a custom discovery proxy.</span></span> <span data-ttu-id="30184-157">通过多播接收到 `Probe` 消息时，<xref:System.ServiceModel.Discovery.DiscoveryProxy> 类将调用 `BeginShouldRedirectFind` 虚拟方法，确定是否应发送多播禁止消息。</span><span class="sxs-lookup"><span data-stu-id="30184-157">When a `Probe` message is received over multicast, the <xref:System.ServiceModel.Discovery.DiscoveryProxy> class calls the `BeginShouldRedirectFind` virtual method to determine whether a multicast suppression message should to be sent.</span></span> <span data-ttu-id="30184-158">如果开发人员决定不发送多播禁止消息或者 `Probe` 消息是通过单播接收的，该类将根据传入消息创建 <xref:System.ServiceModel.Discovery.FindRequestContext> 类的实例并调用 `OnBeginFind` 虚拟方法。</span><span class="sxs-lookup"><span data-stu-id="30184-158">If the developer decides not to send a multicast suppression message or if the `Probe` message was received over unicast, it creates an instance of the <xref:System.ServiceModel.Discovery.FindRequestContext> class based on the incoming message and invokes the `OnBeginFind` virtual method.</span></span> <span data-ttu-id="30184-159">通过多播接收到 `Resolve` 消息时，<xref:System.ServiceModel.Discovery.DiscoveryProxy> 类将调用 `ShouldRedirectResolve` 虚拟方法，确定是否应发送多播禁止消息。</span><span class="sxs-lookup"><span data-stu-id="30184-159">When a `Resolve` message is received over multicast, The <xref:System.ServiceModel.Discovery.DiscoveryProxy> class calls the `ShouldRedirectResolve` virtual method to determine whether a multicast suppression message should to be sent.</span></span> <span data-ttu-id="30184-160">如果开发人员决定不发送多播禁止消息或者 `Resolve` 消息是通过单播接收的，该类将根据传入消息创建 <xref:System.ServiceModel.Discovery.ResolveCriteria> 类的实例并调用 `OnBeginResolve` 虚拟方法。</span><span class="sxs-lookup"><span data-stu-id="30184-160">If the developer decides not to send a multicast suppression message or if the `Resolve` message was received over unicast, it creates an instance of the <xref:System.ServiceModel.Discovery.ResolveCriteria> class based on the incoming message and invokes the `OnBeginResolve` virtual method.</span></span> <span data-ttu-id="30184-161">接收到 Hello 或 Bye 消息时，<xref:System.ServiceModel.Discovery.DiscoveryProxy> 将调用相应的虚拟方法（`OnBeginOnlineAnnouncement` 或 `OnBeingOfflineAnnouncement`），从而引发公告事件。</span><span class="sxs-lookup"><span data-stu-id="30184-161">When a Hello or Bye message is received, <xref:System.ServiceModel.Discovery.DiscoveryProxy> calls the appropriate virtual method (`OnBeginOnlineAnnouncement` or `OnBeingOfflineAnnouncement`), which raises announcement events.</span></span>  
  
## <a name="discoveryversion"></a><span data-ttu-id="30184-162">DiscoveryVersion</span><span class="sxs-lookup"><span data-stu-id="30184-162">DiscoveryVersion</span></span>  
 <span data-ttu-id="30184-163"><xref:System.ServiceModel.Discovery.DiscoveryVersion> 类表示要使用的发现协议版本。</span><span class="sxs-lookup"><span data-stu-id="30184-163">The <xref:System.ServiceModel.Discovery.DiscoveryVersion> class represents the discovery protocol version to use.</span></span>  
  
## <a name="endpointdiscoverybehavior"></a><span data-ttu-id="30184-164">EndpointDiscoveryBehavior</span><span class="sxs-lookup"><span data-stu-id="30184-164">EndpointDiscoveryBehavior</span></span>  
 <span data-ttu-id="30184-165"><xref:System.ServiceModel.Discovery.EndpointDiscoveryBehavior> 类用于控制终结点的可发现性，指定扩展、附加协定类型名称，</span><span class="sxs-lookup"><span data-stu-id="30184-165">The <xref:System.ServiceModel.Discovery.EndpointDiscoveryBehavior> class is used to control the discoverability of an endpoint, specify the extensions, additional contract type names.</span></span> <span data-ttu-id="30184-166">以及与该终结点关联的作用域。</span><span class="sxs-lookup"><span data-stu-id="30184-166">and the scopes associated with that endpoint.</span></span> <span data-ttu-id="30184-167">将此行为添加到应用程序终结点可以配置其 <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata>。</span><span class="sxs-lookup"><span data-stu-id="30184-167">This behavior is added to an application endpoint to configure its <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata>.</span></span> <span data-ttu-id="30184-168">将 <xref:System.ServiceModel.Discovery.ServiceDiscoveryBehavior> 添加到服务主机后，默认情况下，该服务主机承载的所有应用程序终结点都变为可发现的。</span><span class="sxs-lookup"><span data-stu-id="30184-168">When <xref:System.ServiceModel.Discovery.ServiceDiscoveryBehavior> is added to the service host, all the application endpoints hosted by the service host by default become discoverable.</span></span> <span data-ttu-id="30184-169">开发人员通过将 <xref:System.ServiceModel.Discovery.EndpointDiscoveryBehavior.Enabled%2A> 属性设置为 `false`，可以关闭发现特定终结点的能力。</span><span class="sxs-lookup"><span data-stu-id="30184-169">The developer can turn off discovery for a specific endpoint by setting the <xref:System.ServiceModel.Discovery.EndpointDiscoveryBehavior.Enabled%2A> property to `false`.</span></span>  
  
## <a name="endpointdiscoverymetadata"></a><span data-ttu-id="30184-170">EndpointDiscoveryMetadata</span><span class="sxs-lookup"><span data-stu-id="30184-170">EndpointDiscoveryMetadata</span></span>  
 <span data-ttu-id="30184-171"><xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata> 类提供服务发布的终结点的版本无关的表示形式。</span><span class="sxs-lookup"><span data-stu-id="30184-171">The <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata> class provides a version-independent representation of an endpoint published by the service.</span></span> <span data-ttu-id="30184-172">该类包含服务开发人员指定的终结点地址、侦听 URI、协定类型名称、作用域、元数据版本和扩展。</span><span class="sxs-lookup"><span data-stu-id="30184-172">It contains endpoint addresses, listen URIs, contract type names, scopes, metadata version and extensions specified by the service developer.</span></span> <span data-ttu-id="30184-173">客户端在 <xref:System.ServiceModel.Discovery.FindCriteria> 操作期间发送的 `Probe` 将与 <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata> 进行匹配。</span><span class="sxs-lookup"><span data-stu-id="30184-173">The <xref:System.ServiceModel.Discovery.FindCriteria> sent by the client during a `Probe` operation is matched against the <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata>.</span></span> <span data-ttu-id="30184-174">如果条件匹配，则会将 <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata> 返回到客户端。</span><span class="sxs-lookup"><span data-stu-id="30184-174">If the criteria matches, then the <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata> is returned to the client.</span></span> <span data-ttu-id="30184-175"><xref:System.ServiceModel.Discovery.ResolveCriteria> 中的终结点地址将与 <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata> 的终结点地址进行匹配。</span><span class="sxs-lookup"><span data-stu-id="30184-175">The endpoint address in <xref:System.ServiceModel.Discovery.ResolveCriteria> is matched against the endpoint address of <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata>.</span></span> <span data-ttu-id="30184-176">如果条件匹配，则会将 <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata> 返回到客户端。</span><span class="sxs-lookup"><span data-stu-id="30184-176">If the criteria matches, then the <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata> is returned to the client.</span></span>  
  
## <a name="findcriteria"></a><span data-ttu-id="30184-177">FindCriteria</span><span class="sxs-lookup"><span data-stu-id="30184-177">FindCriteria</span></span>  
 <span data-ttu-id="30184-178"><xref:System.ServiceModel.Discovery.FindCriteria> 类是一个版本无关的类，用于指定在查找服务时所使用的条件。</span><span class="sxs-lookup"><span data-stu-id="30184-178">The <xref:System.ServiceModel.Discovery.FindCriteria> class is a version-independent class used to specify the criteria used when finding a service.</span></span> <span data-ttu-id="30184-179">该类完全支持 WS-Discovery 定义的用于匹配服务的条件。</span><span class="sxs-lookup"><span data-stu-id="30184-179">It fully supports the WS-Discovery-defined criteria for matching services.</span></span> <span data-ttu-id="30184-180">它还提供一些扩展，开发人员可以使用这些扩展指定可在匹配过程中使用的自定义值。</span><span class="sxs-lookup"><span data-stu-id="30184-180">It also has extensions that developers can use to specify custom values that can be used during the matching process.</span></span> <span data-ttu-id="30184-181">开发人员可以提供 `Find` 操作的终止条件，方法是指定 <xref:System.ServiceModel.Discovery.FindCriteria.MaxResults%2A>，它指定开发人员查找的服务总数，或者指定 <xref:System.ServiceModel.Discovery.FindCriteria.Duration%2A>（该值指定客户端等待响应的时长）。</span><span class="sxs-lookup"><span data-stu-id="30184-181">The developer can provide the termination criteria for the `Find` operation by specifying the <xref:System.ServiceModel.Discovery.FindCriteria.MaxResults%2A>, which specifies the total number of services the developer is looking for or that specifies the <xref:System.ServiceModel.Discovery.FindCriteria.Duration%2A>, which is the value that specifies how long the client waits for responses.</span></span>  
  
## <a name="findrequestcontext"></a><span data-ttu-id="30184-182">FindRequestContext</span><span class="sxs-lookup"><span data-stu-id="30184-182">FindRequestContext</span></span>  
 <span data-ttu-id="30184-183"><xref:System.ServiceModel.Discovery.FindRequestContext> 类由发现服务根据其在客户端初始化 `Probe` 操作时接收的 `Find` 消息进行实例化。</span><span class="sxs-lookup"><span data-stu-id="30184-183">The <xref:System.ServiceModel.Discovery.FindRequestContext> class is instantiated by the discovery service based on the `Probe` message it receives when a client initiates a `Find` operation.</span></span> <span data-ttu-id="30184-184">该类包含客户端所指定的 <xref:System.ServiceModel.Discovery.FindCriteria> 的一个实例。</span><span class="sxs-lookup"><span data-stu-id="30184-184">It contains an instance of <xref:System.ServiceModel.Discovery.FindCriteria> that was specified by the client.</span></span>  
  
## <a name="findresponse"></a><span data-ttu-id="30184-185">FindResponse</span><span class="sxs-lookup"><span data-stu-id="30184-185">FindResponse</span></span>  
 <span data-ttu-id="30184-186"><xref:System.ServiceModel.Discovery.FindResponse> 类与 <xref:System.ServiceModel.Discovery.DiscoveryClient.Find%2A> 操作的响应一起返回到 `Find` 的调用方。</span><span class="sxs-lookup"><span data-stu-id="30184-186">The <xref:System.ServiceModel.Discovery.FindResponse> class is returned to the caller of <xref:System.ServiceModel.Discovery.DiscoveryClient.Find%2A> with the responses of the `Find` operation.</span></span> <span data-ttu-id="30184-187">该类还存在于 <xref:System.ServiceModel.Discovery.FindCompletedEventArgs> 中。</span><span class="sxs-lookup"><span data-stu-id="30184-187">It is also present in <xref:System.ServiceModel.Discovery.FindCompletedEventArgs>.</span></span> <span data-ttu-id="30184-188">该类包含 <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata> 的集合（发现的终结点的集合）以及 <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata> 和 <xref:System.ServiceModel.Discovery.DiscoveryMessageSequence> 的字典。</span><span class="sxs-lookup"><span data-stu-id="30184-188">It contains a collection of <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata>, which is the collection of discovered endpoints and a dictionary of <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata> and <xref:System.ServiceModel.Discovery.DiscoveryMessageSequence>.</span></span>  
  
## <a name="resolvecriteria"></a><span data-ttu-id="30184-189">ResolveCriteria</span><span class="sxs-lookup"><span data-stu-id="30184-189">ResolveCriteria</span></span>  
 <span data-ttu-id="30184-190"><xref:System.ServiceModel.Discovery.ResolveCriteria> 类是一个版本无关的类，用于指定解析已知服务时所使用的条件。</span><span class="sxs-lookup"><span data-stu-id="30184-190">The <xref:System.ServiceModel.Discovery.ResolveCriteria> class is a version-independent class used to specify the criteria used when resolving an already known service.</span></span> <span data-ttu-id="30184-191">该类包含已知服务的终结点地址。</span><span class="sxs-lookup"><span data-stu-id="30184-191">It contains the endpoint address of the known service.</span></span> <span data-ttu-id="30184-192">开发人员可以提供解析操作的终止条件，方法是指定 <xref:System.ServiceModel.Discovery.ResolveCriteria.Duration%2A>，它指定客户端等待响应的时长。</span><span class="sxs-lookup"><span data-stu-id="30184-192">The developer can provide the termination criteria for the resolve operation by specifying the <xref:System.ServiceModel.Discovery.ResolveCriteria.Duration%2A>, which specifies how long the client waits for responses.</span></span>  
  
## <a name="resolveresponse"></a><span data-ttu-id="30184-193">ResolveResponse</span><span class="sxs-lookup"><span data-stu-id="30184-193">ResolveResponse</span></span>  
 <span data-ttu-id="30184-194"><xref:System.ServiceModel.Discovery.ResolveResponse> 与 <xref:System.ServiceModel.Discovery.DiscoveryClient.Resolve%2A> 操作的响应一起返回到 `Resolve` 方法的调用方。</span><span class="sxs-lookup"><span data-stu-id="30184-194">The <xref:System.ServiceModel.Discovery.ResolveResponse> is returned to the caller of the <xref:System.ServiceModel.Discovery.DiscoveryClient.Resolve%2A> method with the response of the `Resolve` operation.</span></span> <span data-ttu-id="30184-195">该类还存在于 <xref:System.ServiceModel.Discovery.ResolveCompletedEventArgs> 中。</span><span class="sxs-lookup"><span data-stu-id="30184-195">It is also present in <xref:System.ServiceModel.Discovery.ResolveCompletedEventArgs>.</span></span> <span data-ttu-id="30184-196">该类包含 <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata>（已发现的终结点）的一个实例以及 <xref:System.ServiceModel.Discovery.DiscoveryMessageSequence> 的一个实例。</span><span class="sxs-lookup"><span data-stu-id="30184-196">It contains an instance of <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata>, which is the discovered endpoints and an instance of <xref:System.ServiceModel.Discovery.DiscoveryMessageSequence>.</span></span>  
  
## <a name="servicediscoverybehavior"></a><span data-ttu-id="30184-197">ServiceDiscoveryBehavior</span><span class="sxs-lookup"><span data-stu-id="30184-197">ServiceDiscoveryBehavior</span></span>  
 <span data-ttu-id="30184-198">通过 <xref:System.ServiceModel.Discovery.ServiceDiscoveryBehavior> 类，开发人员可以将发现功能添加到服务。</span><span class="sxs-lookup"><span data-stu-id="30184-198">The <xref:System.ServiceModel.Discovery.ServiceDiscoveryBehavior> class allows the developer to add the discovery feature to a service.</span></span> <span data-ttu-id="30184-199">您可以将此行为添加到 <xref:System.ServiceModel.ServiceHost>。</span><span class="sxs-lookup"><span data-stu-id="30184-199">You add this behavior to the <xref:System.ServiceModel.ServiceHost>.</span></span> <span data-ttu-id="30184-200"><xref:System.ServiceModel.Discovery.ServiceDiscoveryBehavior> 类循环访问添加到服务主机的应用程序终结点，并根据可发现终结点创建 <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata> 的集合。</span><span class="sxs-lookup"><span data-stu-id="30184-200">The <xref:System.ServiceModel.Discovery.ServiceDiscoveryBehavior> class iterates over the application endpoints added to the service host and creates a collection of <xref:System.ServiceModel.Discovery.EndpointDiscoveryMetadata> from the discoverable endpoints.</span></span> <span data-ttu-id="30184-201">默认情况下，所有终结点都是可发现的。</span><span class="sxs-lookup"><span data-stu-id="30184-201">All endpoints are discoverable by default.</span></span> <span data-ttu-id="30184-202">可以通过将 <xref:System.ServiceModel.Discovery.EndpointDiscoveryBehavior> 添加到特定终结点来控制该特定终结点的可发现性。</span><span class="sxs-lookup"><span data-stu-id="30184-202">The discoverability of a particular endpoint can be controlled by adding the <xref:System.ServiceModel.Discovery.EndpointDiscoveryBehavior> to that particular endpoint.</span></span> <span data-ttu-id="30184-203">如果已将公告终结点添加到 <xref:System.ServiceModel.Discovery.ServiceDiscoveryBehavior>，则在打开或关闭服务主机时，将通过每个公告终结点发送所有可发现终结点的公告。</span><span class="sxs-lookup"><span data-stu-id="30184-203">If announcement endpoints are added to <xref:System.ServiceModel.Discovery.ServiceDiscoveryBehavior> then the announcement of all discoverable endpoints is sent over each of the announcement endpoints when the service host is opened or closed.</span></span>  
  
## <a name="udpannouncementendpoint"></a><span data-ttu-id="30184-204">UdpAnnouncementEndpoint</span><span class="sxs-lookup"><span data-stu-id="30184-204">UdpAnnouncementEndpoint</span></span>  
 <span data-ttu-id="30184-205"><xref:System.ServiceModel.Discovery.UdpAnnouncementEndpoint> 类是一个标准公告终结点，它预先配置为可通过 UDP 多播绑定进行公告。</span><span class="sxs-lookup"><span data-stu-id="30184-205">The <xref:System.ServiceModel.Discovery.UdpAnnouncementEndpoint> class is a standard announcement endpoint that is pre-configured for announcement over a UDP multicast binding.</span></span> <span data-ttu-id="30184-206">默认情况下，<xref:System.ServiceModel.Discovery.UdpAnnouncementEndpoint> 设置为使用 WSApril2005 WS_Discovery 版本。</span><span class="sxs-lookup"><span data-stu-id="30184-206">By default, <xref:System.ServiceModel.Discovery.UdpAnnouncementEndpoint> is set to use the WSApril2005 WS_Discovery version.</span></span>  
  
## <a name="udpdiscoveryendpoint"></a><span data-ttu-id="30184-207">UdpDiscoveryEndpoint</span><span class="sxs-lookup"><span data-stu-id="30184-207">UdpDiscoveryEndpoint</span></span>  
 <span data-ttu-id="30184-208"><xref:System.ServiceModel.Discovery.UdpDiscoveryEndpoint> 类一个标准发现终结点，它预先配置为可通过 UDP 多播绑定来发现。</span><span class="sxs-lookup"><span data-stu-id="30184-208">The <xref:System.ServiceModel.Discovery.UdpDiscoveryEndpoint> class is a standard discovery endpoint that is pre-configured for discovery over a UDP multicast binding.</span></span> <span data-ttu-id="30184-209">默认情况下，<xref:System.ServiceModel.Discovery.DiscoveryEndpoint> 设置为使用 WSDiscovery11 WS-Discovery 版本和 <xref:System.ServiceModel.Discovery.ServiceDiscoveryMode.Adhoc?displayProperty=nameWithType> 模式。</span><span class="sxs-lookup"><span data-stu-id="30184-209">By default, <xref:System.ServiceModel.Discovery.DiscoveryEndpoint> is set to use the WSDiscovery11 WS-Discovery version and <xref:System.ServiceModel.Discovery.ServiceDiscoveryMode.Adhoc?displayProperty=nameWithType> mode.</span></span>
