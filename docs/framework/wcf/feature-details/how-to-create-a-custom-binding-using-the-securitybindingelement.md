---
title: 如何：使用 SecurityBindingElement 创建自定义绑定
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- security [WCF], creating custom bindings
ms.assetid: 203a9f9e-3a73-427c-87aa-721c56265b29
ms.openlocfilehash: 7966c1fe4cd94408455c6bb146fdd3ea55757702
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "61787850"
---
# <a name="how-to-create-a-custom-binding-using-the-securitybindingelement"></a><span data-ttu-id="5de2d-102">如何：使用 SecurityBindingElement 创建自定义绑定</span><span class="sxs-lookup"><span data-stu-id="5de2d-102">How to: Create a Custom Binding Using the SecurityBindingElement</span></span>
<span data-ttu-id="5de2d-103">Windows Communication Foundation (WCF) 包括多个系统提供的绑定可以配置，但配置 WCF 支持的所有安全选项时未提供最大的灵活性。</span><span class="sxs-lookup"><span data-stu-id="5de2d-103">Windows Communication Foundation (WCF) includes several system-provided bindings that can be configured but do not provide full flexibility when configuring all the security options that WCF supports.</span></span> <span data-ttu-id="5de2d-104">本主题演示如何直接从各个绑定元素创建自定义绑定，并着重说明创建这样的绑定时可以指定的一些安全设置。</span><span class="sxs-lookup"><span data-stu-id="5de2d-104">This topic demonstrates how to create a custom binding directly from individual binding elements and highlights some of the security settings that can be specified when creating such a binding.</span></span> <span data-ttu-id="5de2d-105">有关创建自定义绑定的详细信息，请参阅[扩展绑定](../../../../docs/framework/wcf/extending/extending-bindings.md)。</span><span class="sxs-lookup"><span data-stu-id="5de2d-105">For more information about creating custom bindings, see [Extending Bindings](../../../../docs/framework/wcf/extending/extending-bindings.md).</span></span>  
  
> [!WARNING]
>  <span data-ttu-id="5de2d-106"><xref:System.ServiceModel.Channels.SecurityBindingElement> 不支持 <xref:System.ServiceModel.Channels.IDuplexSessionChannel> 通道形状，它是 TCP 传输在 <xref:System.ServiceModel.TransferMode> 设置为 <xref:System.ServiceModel.TransferMode.Buffered> 时使用的默认通道形状。</span><span class="sxs-lookup"><span data-stu-id="5de2d-106"><xref:System.ServiceModel.Channels.SecurityBindingElement> does not support the <xref:System.ServiceModel.Channels.IDuplexSessionChannel> channel shape, which is the default channel shape use by the TCP transport when <xref:System.ServiceModel.TransferMode> is set to <xref:System.ServiceModel.TransferMode.Buffered>.</span></span> <span data-ttu-id="5de2d-107">您必须将 <xref:System.ServiceModel.TransferMode> 设置为 <xref:System.ServiceModel.TransferMode.Streamed>，才能在此方案中使用 <xref:System.ServiceModel.Channels.SecurityBindingElement>。</span><span class="sxs-lookup"><span data-stu-id="5de2d-107">You must set <xref:System.ServiceModel.TransferMode> to <xref:System.ServiceModel.TransferMode.Streamed> in order to use <xref:System.ServiceModel.Channels.SecurityBindingElement> in this scenario.</span></span>  
  
## <a name="creating-a-custom-binding"></a><span data-ttu-id="5de2d-108">创建自定义绑定</span><span class="sxs-lookup"><span data-stu-id="5de2d-108">Creating a Custom Binding</span></span>  
 <span data-ttu-id="5de2d-109">WCF 中的所有绑定都构成*绑定元素*。</span><span class="sxs-lookup"><span data-stu-id="5de2d-109">In WCF all bindings are made up of *binding elements*.</span></span> <span data-ttu-id="5de2d-110">每个绑定元素都是从 <xref:System.ServiceModel.Channels.BindingElement> 类派生的。</span><span class="sxs-lookup"><span data-stu-id="5de2d-110">Each binding element derives from the <xref:System.ServiceModel.Channels.BindingElement> class.</span></span> <span data-ttu-id="5de2d-111">对于系统提供的标准绑定，已为您创建和配置绑定元素，但您仍可以自定义某些属性设置。</span><span class="sxs-lookup"><span data-stu-id="5de2d-111">For the standard system-provided bindings, the binding elements are created and configured for you, although you can customize some of the property settings.</span></span>  
  
 <span data-ttu-id="5de2d-112">相比之下，若要创建自定义绑定，应创建并配置绑定元素，然后从绑定元素创建 <xref:System.ServiceModel.Channels.CustomBinding>。</span><span class="sxs-lookup"><span data-stu-id="5de2d-112">In contrast, to create a custom binding, binding elements are created and configured and a <xref:System.ServiceModel.Channels.CustomBinding> is created from the binding elements.</span></span>  
  
 <span data-ttu-id="5de2d-113">为此，将各个绑定元素添加到由 <xref:System.ServiceModel.Channels.BindingElementCollection> 类的实例表示的集合，然后将 `Elements` 的 `CustomBinding` 属性设置为等于该对象。</span><span class="sxs-lookup"><span data-stu-id="5de2d-113">To do this, you add the individual binding elements to a collection represented by an instance of the <xref:System.ServiceModel.Channels.BindingElementCollection> class, and then set the `Elements` property of the `CustomBinding` equal to that object.</span></span> <span data-ttu-id="5de2d-114">必须按以下顺序添加绑定元素：事务流、 可靠会话、 安全、 复合双工、 单向、 Stream 安全、 消息编码和传输。</span><span class="sxs-lookup"><span data-stu-id="5de2d-114">You must add the binding elements in the following order: Transaction Flow, Reliable Session, Security, Composite Duplex, One-way, Stream Security, Message Encoding, and Transport.</span></span> <span data-ttu-id="5de2d-115">请注意，并不是每个绑定中都需要所列的所有绑定元素。</span><span class="sxs-lookup"><span data-stu-id="5de2d-115">Note that not all the binding elements listed are required in every binding.</span></span>  
  
## <a name="securitybindingelement"></a><span data-ttu-id="5de2d-116">SecurityBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-116">SecurityBindingElement</span></span>  
 <span data-ttu-id="5de2d-117">有三个绑定元素与消息级安全性有关，它们都派生自 <xref:System.ServiceModel.Channels.SecurityBindingElement> 类。</span><span class="sxs-lookup"><span data-stu-id="5de2d-117">Three binding elements relate to message level security, all of which derive from the <xref:System.ServiceModel.Channels.SecurityBindingElement> class.</span></span> <span data-ttu-id="5de2d-118">这三个绑定元素是 <xref:System.ServiceModel.Channels.TransportSecurityBindingElement>、<xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement> 和 <xref:System.ServiceModel.Channels.AsymmetricSecurityBindingElement>。</span><span class="sxs-lookup"><span data-stu-id="5de2d-118">The three are <xref:System.ServiceModel.Channels.TransportSecurityBindingElement>, <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement>, and <xref:System.ServiceModel.Channels.AsymmetricSecurityBindingElement>.</span></span> <span data-ttu-id="5de2d-119"><xref:System.ServiceModel.Channels.TransportSecurityBindingElement> 用于提供混合模式安全。</span><span class="sxs-lookup"><span data-stu-id="5de2d-119">The <xref:System.ServiceModel.Channels.TransportSecurityBindingElement> is used to provide Mixed mode security.</span></span> <span data-ttu-id="5de2d-120">当消息层提供安全时，使用其他两个元素。</span><span class="sxs-lookup"><span data-stu-id="5de2d-120">The other two elements are used when the message layer provides security.</span></span>  
  
 <span data-ttu-id="5de2d-121">在提供传输级安全时，将使用其他类：</span><span class="sxs-lookup"><span data-stu-id="5de2d-121">Additional classes are used when transport level security is provided:</span></span>  
  
- <xref:System.ServiceModel.Channels.HttpsTransportBindingElement>  
  
- <xref:System.ServiceModel.Channels.SslStreamSecurityBindingElement>  
  
- <xref:System.ServiceModel.Channels.WindowsStreamSecurityBindingElement>  
  
## <a name="required-binding-elements"></a><span data-ttu-id="5de2d-122">必需的绑定元素</span><span class="sxs-lookup"><span data-stu-id="5de2d-122">Required Binding Elements</span></span>  
 <span data-ttu-id="5de2d-123">有大量的可能绑定元素可以组合为绑定。</span><span class="sxs-lookup"><span data-stu-id="5de2d-123">There are a large number of possible binding elements that can be combined into a binding.</span></span> <span data-ttu-id="5de2d-124">并非所有这些组合都是有效的。</span><span class="sxs-lookup"><span data-stu-id="5de2d-124">Not all of these combinations are valid.</span></span> <span data-ttu-id="5de2d-125">本节介绍安全绑定中必须存在的元素。</span><span class="sxs-lookup"><span data-stu-id="5de2d-125">This section describes the required elements that must be present in a security binding.</span></span>  
  
 <span data-ttu-id="5de2d-126">有效的安全绑定取决于多种因素，其中包括：</span><span class="sxs-lookup"><span data-stu-id="5de2d-126">Valid security bindings depend on many factors, including the following:</span></span>  
  
- <span data-ttu-id="5de2d-127">安全模式。</span><span class="sxs-lookup"><span data-stu-id="5de2d-127">Security mode.</span></span>  
  
- <span data-ttu-id="5de2d-128">传输协议。</span><span class="sxs-lookup"><span data-stu-id="5de2d-128">Transport protocol.</span></span>  
  
- <span data-ttu-id="5de2d-129">协定中指定的消息交换模式 (MEP)。</span><span class="sxs-lookup"><span data-stu-id="5de2d-129">The message exchange pattern (MEP) specified in the contract.</span></span>  
  
 <span data-ttu-id="5de2d-130">下表显示上述因素各种组合的有效绑定元素组合配置。</span><span class="sxs-lookup"><span data-stu-id="5de2d-130">The following table shows the valid binding element stack configurations for each combination of the preceding factors.</span></span> <span data-ttu-id="5de2d-131">请注意，这些是最低需求。</span><span class="sxs-lookup"><span data-stu-id="5de2d-131">Note that these are minimal requirements.</span></span> <span data-ttu-id="5de2d-132">你可以向绑定添加更多绑定元素，如消息编码绑定元素、事务绑定元素和其他绑定元素。</span><span class="sxs-lookup"><span data-stu-id="5de2d-132">You can add additional binding elements to the binding, such as message encoding binding elements, transaction binding elements, and other binding elements.</span></span>  
  
|<span data-ttu-id="5de2d-133">安全模式</span><span class="sxs-lookup"><span data-stu-id="5de2d-133">Security Mode</span></span>|<span data-ttu-id="5de2d-134">传输</span><span class="sxs-lookup"><span data-stu-id="5de2d-134">Transport</span></span>|<span data-ttu-id="5de2d-135">协定消息交换模式</span><span class="sxs-lookup"><span data-stu-id="5de2d-135">Contract Message Exchange Pattern</span></span>|<span data-ttu-id="5de2d-136">协定消息交换模式</span><span class="sxs-lookup"><span data-stu-id="5de2d-136">Contract Message Exchange Pattern</span></span>|<span data-ttu-id="5de2d-137">协定消息交换模式</span><span class="sxs-lookup"><span data-stu-id="5de2d-137">Contract Message Exchange Pattern</span></span>|  
|-------------------|---------------|---------------------------------------|---------------------------------------|---------------------------------------|  
|||`Datagram`|`Request Reply`|`Duplex`|  
|<span data-ttu-id="5de2d-138">传输</span><span class="sxs-lookup"><span data-stu-id="5de2d-138">Transport</span></span>|<span data-ttu-id="5de2d-139">Https</span><span class="sxs-lookup"><span data-stu-id="5de2d-139">Https</span></span>||||  
|||<span data-ttu-id="5de2d-140">OneWayBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-140">OneWayBindingElement</span></span>|||  
|||<span data-ttu-id="5de2d-141">HttpsTransportBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-141">HttpsTransportBindingElement</span></span>|<span data-ttu-id="5de2d-142">HttpsTransportBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-142">HttpsTransportBindingElement</span></span>||  
||<span data-ttu-id="5de2d-143">TCP</span><span class="sxs-lookup"><span data-stu-id="5de2d-143">TCP</span></span>||||  
|||<span data-ttu-id="5de2d-144">OneWayBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-144">OneWayBindingElement</span></span>|||  
|||<span data-ttu-id="5de2d-145">SSL 或 Windows StreamSecurityBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-145">SSL or Windows StreamSecurityBindingElement</span></span>|<span data-ttu-id="5de2d-146">SSL 或 Windows StreamSecurityBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-146">SSL or Windows StreamSecurityBindingElement</span></span>|<span data-ttu-id="5de2d-147">SSL 或 Windows StreamSecurityBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-147">SSL or Windows StreamSecurityBindingElement</span></span>|  
|||<span data-ttu-id="5de2d-148">TcpTransportBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-148">TcpTransportBindingElement</span></span>|<span data-ttu-id="5de2d-149">TcpTransportBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-149">TcpTransportBindingElement</span></span>|<span data-ttu-id="5de2d-150">TcpTransportBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-150">TcpTransportBindingElement</span></span>|  
|<span data-ttu-id="5de2d-151">消息</span><span class="sxs-lookup"><span data-stu-id="5de2d-151">Message</span></span>|<span data-ttu-id="5de2d-152">Http</span><span class="sxs-lookup"><span data-stu-id="5de2d-152">Http</span></span>|<span data-ttu-id="5de2d-153">SymmetricSecurityBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-153">SymmetricSecurityBindingElement</span></span>|<span data-ttu-id="5de2d-154">SymmetricSecurityBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-154">SymmetricSecurityBindingElement</span></span>|<span data-ttu-id="5de2d-155">SymmetricSecurityBindingElement（身份验证模式 = SecureConversation）</span><span class="sxs-lookup"><span data-stu-id="5de2d-155">SymmetricSecurityBindingElement (authentication mode = SecureConversation)</span></span>|  
|||||<span data-ttu-id="5de2d-156">CompositeDuplexBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-156">CompositeDuplexBindingElement</span></span>|  
|||<span data-ttu-id="5de2d-157">OneWayBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-157">OneWayBindingElement</span></span>||<span data-ttu-id="5de2d-158">OneWayBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-158">OneWayBindingElement</span></span>|  
|||<span data-ttu-id="5de2d-159">HttpTransportBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-159">HttpTransportBindingElement</span></span>|<span data-ttu-id="5de2d-160">HttpTransportBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-160">HttpTransportBindingElement</span></span>|<span data-ttu-id="5de2d-161">HttpTransportBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-161">HttpTransportBindingElement</span></span>|  
||<span data-ttu-id="5de2d-162">Tcp</span><span class="sxs-lookup"><span data-stu-id="5de2d-162">Tcp</span></span>|<span data-ttu-id="5de2d-163">SecurityBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-163">SecurityBindingElement</span></span>|<span data-ttu-id="5de2d-164">SecurityBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-164">SecurityBindingElement</span></span>|<span data-ttu-id="5de2d-165">SymmetricSecurityBindingElement（身份验证模式 = SecureConversation）</span><span class="sxs-lookup"><span data-stu-id="5de2d-165">SymmetricSecurityBindingElement (authentication mode = SecureConversation)</span></span>|  
|||<span data-ttu-id="5de2d-166">TcpTransportBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-166">TcpTransportBindingElement</span></span>|<span data-ttu-id="5de2d-167">TcpTransportBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-167">TcpTransportBindingElement</span></span>|<span data-ttu-id="5de2d-168">TcpTransportBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-168">TcpTransportBindingElement</span></span>|  
|<span data-ttu-id="5de2d-169">混合（带有消息凭据的传输）</span><span class="sxs-lookup"><span data-stu-id="5de2d-169">Mixed (transport with message credentials)</span></span>|<span data-ttu-id="5de2d-170">Https</span><span class="sxs-lookup"><span data-stu-id="5de2d-170">Https</span></span>|<span data-ttu-id="5de2d-171">TransportSecurityBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-171">TransportSecurityBindingElement</span></span>|<span data-ttu-id="5de2d-172">TransportSecurityBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-172">TransportSecurityBindingElement</span></span>||  
|||<span data-ttu-id="5de2d-173">OneWayBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-173">OneWayBindingElement</span></span>|||  
|||<span data-ttu-id="5de2d-174">HttpsTransportBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-174">HttpsTransportBindingElement</span></span>|<span data-ttu-id="5de2d-175">HttpsTransportBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-175">HttpsTransportBindingElement</span></span>||  
||<span data-ttu-id="5de2d-176">TCP</span><span class="sxs-lookup"><span data-stu-id="5de2d-176">TCP</span></span>|<span data-ttu-id="5de2d-177">TransportSecurityBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-177">TransportSecurityBindingElement</span></span>|<span data-ttu-id="5de2d-178">SymmetricSecurityBindingElement（身份验证模式 = SecureConversation）</span><span class="sxs-lookup"><span data-stu-id="5de2d-178">SymmetricSecurityBindingElement (authentication mode = SecureConversation)</span></span>|<span data-ttu-id="5de2d-179">SymmetricSecurityBindingElement（身份验证模式 = SecureConversation）</span><span class="sxs-lookup"><span data-stu-id="5de2d-179">SymmetricSecurityBindingElement (authentication mode = SecureConversation)</span></span>|  
|||<span data-ttu-id="5de2d-180">OneWayBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-180">OneWayBindingElement</span></span>|||  
|||<span data-ttu-id="5de2d-181">SSL 或 Windows StreamSecurityBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-181">SSL or Windows StreamSecurityBindingElement</span></span>|<span data-ttu-id="5de2d-182">SSL 或 Windows StreamSecurityBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-182">SSL or Windows StreamSecurityBindingElement</span></span>|<span data-ttu-id="5de2d-183">SSL 或 Windows StreamSecurityBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-183">SSL or Windows StreamSecurityBindingElement</span></span>|  
|||<span data-ttu-id="5de2d-184">TcpTransportBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-184">TcpTransportBindingElement</span></span>|<span data-ttu-id="5de2d-185">TcpTransportBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-185">TcpTransportBindingElement</span></span>|<span data-ttu-id="5de2d-186">TcpTransportBindingElement</span><span class="sxs-lookup"><span data-stu-id="5de2d-186">TcpTransportBindingElement</span></span>|  
  
 <span data-ttu-id="5de2d-187">请注意，SecurityBindingElements 有许多可配置的设置。</span><span class="sxs-lookup"><span data-stu-id="5de2d-187">Note that there are many configurable settings on the SecurityBindingElements.</span></span> <span data-ttu-id="5de2d-188">有关详细信息，请参阅[SecurityBindingElement 身份验证模式](../../../../docs/framework/wcf/feature-details/securitybindingelement-authentication-modes.md)。</span><span class="sxs-lookup"><span data-stu-id="5de2d-188">For more information, see [SecurityBindingElement Authentication Modes](../../../../docs/framework/wcf/feature-details/securitybindingelement-authentication-modes.md).</span></span>  
  
 <span data-ttu-id="5de2d-189">有关详细信息，请参阅[安全对话和安全会话](../../../../docs/framework/wcf/feature-details/secure-conversations-and-secure-sessions.md)。</span><span class="sxs-lookup"><span data-stu-id="5de2d-189">For more information, see [Secure Conversations and Secure Sessions](../../../../docs/framework/wcf/feature-details/secure-conversations-and-secure-sessions.md).</span></span>  
  
## <a name="procedures"></a><span data-ttu-id="5de2d-190">过程</span><span class="sxs-lookup"><span data-stu-id="5de2d-190">Procedures</span></span>  
  
#### <a name="to-create-a-custom-binding-that-uses-a-symmetricsecuritybindingelement"></a><span data-ttu-id="5de2d-191">创建使用 SymmetricSecurityBindingElement 的自定义绑定。</span><span class="sxs-lookup"><span data-stu-id="5de2d-191">To create a custom binding that uses a SymmetricSecurityBindingElement</span></span>  
  
1. <span data-ttu-id="5de2d-192">以 <xref:System.ServiceModel.Channels.BindingElementCollection> 名称创建 `outputBec` 类的实例。</span><span class="sxs-lookup"><span data-stu-id="5de2d-192">Create an instance of the <xref:System.ServiceModel.Channels.BindingElementCollection> class with the name `outputBec`.</span></span>  
  
2. <span data-ttu-id="5de2d-193">调用静态方法 `M:System.ServiceModel.Channels.SecurityBindingElement.CreateSspiNegotiationBindingElement(true)`，它将返回 <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement> 类的实例。</span><span class="sxs-lookup"><span data-stu-id="5de2d-193">Call the static method `M:System.ServiceModel.Channels.SecurityBindingElement.CreateSspiNegotiationBindingElement(true)`, which returns an instance of the <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement> class.</span></span>  
  
3. <span data-ttu-id="5de2d-194">通过调用 <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement> 类的 `outputBec` 的 `Add` 方法，将 <xref:System.Collections.ObjectModel.Collection%601><xref:System.ServiceModel.Channels.BindingElement>添加到集合 () 中。</span><span class="sxs-lookup"><span data-stu-id="5de2d-194">Add the <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement> to the collection (`outputBec`) by calling the `Add` method of the <xref:System.Collections.ObjectModel.Collection%601> of <xref:System.ServiceModel.Channels.BindingElement> class.</span></span>  
  
4. <span data-ttu-id="5de2d-195">创建 <xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement> 类的实例并将其添加到集合 (`outputBec`) 中。</span><span class="sxs-lookup"><span data-stu-id="5de2d-195">Create an instance of the <xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement> class and add it to the collection (`outputBec`).</span></span> <span data-ttu-id="5de2d-196">这将指定该绑定所使用的编码。</span><span class="sxs-lookup"><span data-stu-id="5de2d-196">This specifies the encoding used by the binding.</span></span>  
  
5. <span data-ttu-id="5de2d-197">创建一个 <xref:System.ServiceModel.Channels.HttpTransportBindingElement> 并将其添加到集合 (`outputBec`) 中。</span><span class="sxs-lookup"><span data-stu-id="5de2d-197">Create a <xref:System.ServiceModel.Channels.HttpTransportBindingElement> and add it to the collection (`outputBec`).</span></span> <span data-ttu-id="5de2d-198">这将指定该绑定使用 HTTP 传输。</span><span class="sxs-lookup"><span data-stu-id="5de2d-198">This specifies that the binding uses the HTTP transport.</span></span>  
  
6. <span data-ttu-id="5de2d-199">通过创建 <xref:System.ServiceModel.Channels.CustomBinding> 类的实例并将集合 `outputBec` 传递给构造函数来创建一个新的自定义绑定。</span><span class="sxs-lookup"><span data-stu-id="5de2d-199">Create a new custom binding by creating an instance of the <xref:System.ServiceModel.Channels.CustomBinding> class and passing the collection `outputBec` to the constructor.</span></span>  
  
7. <span data-ttu-id="5de2d-200">生成的自定义绑定具有与标准 <xref:System.ServiceModel.WSHttpBinding> 相同的许多特性。</span><span class="sxs-lookup"><span data-stu-id="5de2d-200">The resulting custom binding shares many of the same characteristics as the standard <xref:System.ServiceModel.WSHttpBinding>.</span></span> <span data-ttu-id="5de2d-201">它指定消息级别的安全性和 Windows 凭据，但禁用安全会话，要求在带外指定服务凭据且不对签名进行加密。</span><span class="sxs-lookup"><span data-stu-id="5de2d-201">It specifies message-level security and Windows credentials but disables secure sessions, requires that the service credential be specified out-of-band, and does not encrypt signatures.</span></span> <span data-ttu-id="5de2d-202">最后一条只能按步骤 4 所示通过设置 <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement.MessageProtectionOrder%2A> 属性来控制。</span><span class="sxs-lookup"><span data-stu-id="5de2d-202">The last can be controlled only by setting the <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement.MessageProtectionOrder%2A> property as shown in step 4.</span></span> <span data-ttu-id="5de2d-203">其他两条可以使用标准绑定上的设置进行控制。</span><span class="sxs-lookup"><span data-stu-id="5de2d-203">The other two can be controlled using settings on the standard binding.</span></span>  
  
## <a name="example"></a><span data-ttu-id="5de2d-204">示例</span><span class="sxs-lookup"><span data-stu-id="5de2d-204">Example</span></span>  
  
### <a name="description"></a><span data-ttu-id="5de2d-205">描述</span><span class="sxs-lookup"><span data-stu-id="5de2d-205">Description</span></span>  
 <span data-ttu-id="5de2d-206">下面的示例为创建使用 <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement>的自定义绑定提供了一个完整的函数。</span><span class="sxs-lookup"><span data-stu-id="5de2d-206">The following example provides a complete function to create a custom binding that uses a <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement>.</span></span>  
  
### <a name="code"></a><span data-ttu-id="5de2d-207">代码</span><span class="sxs-lookup"><span data-stu-id="5de2d-207">Code</span></span>  
 [!code-csharp[c_CustomBinding#20](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_custombinding/cs/c_custombinding.cs#20)]
 [!code-vb[c_CustomBinding#20](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_custombinding/vb/source.vb#20)]  
  
## <a name="see-also"></a><span data-ttu-id="5de2d-208">请参阅</span><span class="sxs-lookup"><span data-stu-id="5de2d-208">See also</span></span>

- <xref:System.ServiceModel.Channels.SecurityBindingElement>
- <xref:System.ServiceModel.Channels.TransportSecurityBindingElement>
- <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement>
- <xref:System.ServiceModel.Channels.CustomBinding>
- [<span data-ttu-id="5de2d-209">扩展绑定</span><span class="sxs-lookup"><span data-stu-id="5de2d-209">Extending Bindings</span></span>](../../../../docs/framework/wcf/extending/extending-bindings.md)
- [<span data-ttu-id="5de2d-210">系统提供的绑定</span><span class="sxs-lookup"><span data-stu-id="5de2d-210">System-Provided Bindings</span></span>](../../../../docs/framework/wcf/system-provided-bindings.md)
