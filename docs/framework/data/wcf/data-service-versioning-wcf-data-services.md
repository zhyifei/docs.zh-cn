---
title: 数据服务版本管理（WCF 数据服务）
ms.date: 03/30/2017
helpviewer_keywords:
- versioning, WCF Data Services
- versioning [WCF Data Services]
- WCF Data Services, versioning
ms.assetid: e3e899cc-7f25-4f67-958f-063f01f79766
ms.openlocfilehash: 9a92346267012d3651d04648b357bbf530097e34
ms.sourcegitcommit: ad99773e5e45068ce03b99518008397e1299e0d1
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/23/2018
ms.locfileid: "46705703"
---
# <a name="data-service-versioning-wcf-data-services"></a><span data-ttu-id="27a5c-102">数据服务版本管理（WCF 数据服务）</span><span class="sxs-lookup"><span data-stu-id="27a5c-102">Data Service Versioning (WCF Data Services)</span></span>
<span data-ttu-id="27a5c-103">[!INCLUDE[ssODataFull](../../../../includes/ssodatafull-md.md)] ，可创建数据服务，以便客户端可以作为基于数据模型的资源使用 Uri 访问数据。</span><span class="sxs-lookup"><span data-stu-id="27a5c-103">The [!INCLUDE[ssODataFull](../../../../includes/ssodatafull-md.md)] enables you to create data services so that clients can access data as resources using URIs that are based on a data model.</span></span> <span data-ttu-id="27a5c-104">OData 还支持服务操作的定义。</span><span class="sxs-lookup"><span data-stu-id="27a5c-104">OData also supports the definition of service operations.</span></span> <span data-ttu-id="27a5c-105">这些数据服务在初始部署之后，可能出于多种原因（例如，更改业务需求、信息技术需求，或者为了解决其他问题）而需要更改，并且在其生存期期间可能需要更改多次。</span><span class="sxs-lookup"><span data-stu-id="27a5c-105">After initial deployment, and potentially several times during their lifetime, these data services may need to be changed for a variety of reasons, such as changing business needs, information technology requirements, or to address other issues.</span></span> <span data-ttu-id="27a5c-106">更改现有数据服务时，您必须考虑是否要定义您的数据服务的新版本以及如何将对现有客户端应用程序的影响降至最低。</span><span class="sxs-lookup"><span data-stu-id="27a5c-106">When you make changes to an existing data service, you must consider whether to define a new version of your data service and how best to minimize the impact on existing client applications.</span></span> <span data-ttu-id="27a5c-107">本主题提供了有关何时以及如何创建一个新版本的数据服务的指导。</span><span class="sxs-lookup"><span data-stu-id="27a5c-107">This topic provides guidance on when and how to create a new version of a data service.</span></span> <span data-ttu-id="27a5c-108">它还介绍了 WCF 数据服务如何处理客户端和数据服务支持 OData 协议的不同版本之间的交换。</span><span class="sxs-lookup"><span data-stu-id="27a5c-108">It also describes how WCF Data Services handles an exchange between clients and data services that support different versions of the OData protocol.</span></span>

## <a name="versioning-a-wcf-data-service"></a><span data-ttu-id="27a5c-109">WCF 数据服务版本管理</span><span class="sxs-lookup"><span data-stu-id="27a5c-109">Versioning a WCF Data Service</span></span>
 <span data-ttu-id="27a5c-110">一旦部署数据服务和使用数据，对数据服务的更改有可能导致与现有客户端应用程序的兼容性问题。</span><span class="sxs-lookup"><span data-stu-id="27a5c-110">Once a data service is deployed and the data is being consumed, changes to the data service have the potential to cause compatibility issues with existing client applications.</span></span> <span data-ttu-id="27a5c-111">但是，因为服务的整体业务需求而经常需要进行更改，您必须考虑何时以及如何创建一个新的数据服务版本，以最大程度减小对客户端上应用程序的影响。</span><span class="sxs-lookup"><span data-stu-id="27a5c-111">However, because changes are often required by the overall business needs of the service, you must consider when and how to create a new version of your data service with the least impact on client applications.</span></span>

### <a name="data-model-changes-that-recommend-a-new-data-service-version"></a><span data-ttu-id="27a5c-112">建议发布新的数据服务版本的数据模型更改</span><span class="sxs-lookup"><span data-stu-id="27a5c-112">Data Model Changes that Recommend a New Data Service Version</span></span>
 <span data-ttu-id="27a5c-113">在考虑是否要发布数据服务的新版本时，了解不同种类的更改如何影响客户端应用程序很重要。</span><span class="sxs-lookup"><span data-stu-id="27a5c-113">When considering whether to publish a new version of a data service, it is important to understand how the different kinds of changes may affect client applications.</span></span> <span data-ttu-id="27a5c-114">可能要求您创建一个新版本的数据服务的数据服务更改可分为以下两个类别：</span><span class="sxs-lookup"><span data-stu-id="27a5c-114">Changes to a data service that might require you to create a new version of a data service can be divided into the following two categories:</span></span>

-   <span data-ttu-id="27a5c-115">对服务协定的更改 — 它包括对服务操作的更新、对实体集（源）的可访问性的更改或对服务行为的其他更改。</span><span class="sxs-lookup"><span data-stu-id="27a5c-115">Changes to the service contract—which include updates to service operations, changes to the accessibility of entity sets (feeds), version changes, and other changes to service behaviors.</span></span>

-   <span data-ttu-id="27a5c-116">对数据协定的更改 — 它包括对数据模型、源格式或源自定义的更改。</span><span class="sxs-lookup"><span data-stu-id="27a5c-116">Changes to the data contract—which include changes to the data model, feed formats, or feed customizations.</span></span>

 <span data-ttu-id="27a5c-117">下表详细说明出现哪类更改时您应考虑发布新版本的数据服务：</span><span class="sxs-lookup"><span data-stu-id="27a5c-117">The following table details for which kinds of changes you should consider publishing a new version of the data service:</span></span>

|<span data-ttu-id="27a5c-118">更改类型</span><span class="sxs-lookup"><span data-stu-id="27a5c-118">Type of Change</span></span>|<span data-ttu-id="27a5c-119">需要新版本</span><span class="sxs-lookup"><span data-stu-id="27a5c-119">Requires a new version</span></span>|<span data-ttu-id="27a5c-120">不需要新版本</span><span class="sxs-lookup"><span data-stu-id="27a5c-120">New version not needed</span></span>|
|--------------------|----------------------------|----------------------------|
|<span data-ttu-id="27a5c-121">服务操作</span><span class="sxs-lookup"><span data-stu-id="27a5c-121">Service operations</span></span>|<span data-ttu-id="27a5c-122">-添加新的参数</span><span class="sxs-lookup"><span data-stu-id="27a5c-122">-   Add new parameter</span></span><br /><span data-ttu-id="27a5c-123">更改返回类型</span><span class="sxs-lookup"><span data-stu-id="27a5c-123">-   Change return type</span></span><br /><span data-ttu-id="27a5c-124">-删除服务操作</span><span class="sxs-lookup"><span data-stu-id="27a5c-124">-   Remove service operation</span></span>|<span data-ttu-id="27a5c-125">-删除现有参数</span><span class="sxs-lookup"><span data-stu-id="27a5c-125">-   Delete existing parameter</span></span><br /><span data-ttu-id="27a5c-126">-添加新的服务操作</span><span class="sxs-lookup"><span data-stu-id="27a5c-126">-   Add new service operation</span></span>|
|<span data-ttu-id="27a5c-127">服务行为</span><span class="sxs-lookup"><span data-stu-id="27a5c-127">Service behaviors</span></span>|<span data-ttu-id="27a5c-128">-禁用计数请求</span><span class="sxs-lookup"><span data-stu-id="27a5c-128">-   Disable count requests</span></span><br /><span data-ttu-id="27a5c-129">-禁用投影支持</span><span class="sxs-lookup"><span data-stu-id="27a5c-129">-   Disable projection support</span></span><br /><span data-ttu-id="27a5c-130">-增加所需的数据服务版本</span><span class="sxs-lookup"><span data-stu-id="27a5c-130">-   Increase the required data service version</span></span>|<span data-ttu-id="27a5c-131">-启用计数请求</span><span class="sxs-lookup"><span data-stu-id="27a5c-131">-   Enable count requests</span></span><br /><span data-ttu-id="27a5c-132">-启用投影支持</span><span class="sxs-lookup"><span data-stu-id="27a5c-132">-   Enable projection support</span></span><br /><span data-ttu-id="27a5c-133">-减少所需的数据服务版本</span><span class="sxs-lookup"><span data-stu-id="27a5c-133">-   Decrease the required data service version</span></span>|
|<span data-ttu-id="27a5c-134">实体集权限</span><span class="sxs-lookup"><span data-stu-id="27a5c-134">Entity set permissions</span></span>|<span data-ttu-id="27a5c-135">-限制实体集权限</span><span class="sxs-lookup"><span data-stu-id="27a5c-135">-   Restrict entity set permissions</span></span><br /><span data-ttu-id="27a5c-136">-更改响应代码 (新第一个数字值) <sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="27a5c-136">-   Change response code (new first digit value) <sup>1</sup></span></span>|<span data-ttu-id="27a5c-137">-放宽实体集权限</span><span class="sxs-lookup"><span data-stu-id="27a5c-137">-   Relax entity set permissions</span></span><br /><span data-ttu-id="27a5c-138">-更改响应代码 (相同第一个数字值)</span><span class="sxs-lookup"><span data-stu-id="27a5c-138">-   Change response code (same first digit value)</span></span>|
|<span data-ttu-id="27a5c-139">实体属性</span><span class="sxs-lookup"><span data-stu-id="27a5c-139">Entity properties</span></span>|<span data-ttu-id="27a5c-140">-删除现有属性或关系</span><span class="sxs-lookup"><span data-stu-id="27a5c-140">-   Remove existing property or relationship</span></span><br /><span data-ttu-id="27a5c-141">添加不可为 null 的属性</span><span class="sxs-lookup"><span data-stu-id="27a5c-141">-   Add non-nullable property</span></span><br /><span data-ttu-id="27a5c-142">-更改现有属性</span><span class="sxs-lookup"><span data-stu-id="27a5c-142">-   Change existing property</span></span>|<span data-ttu-id="27a5c-143">添加可为 null 属性<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="27a5c-143">-   Add nullable property<sup>2</sup></span></span>|
|<span data-ttu-id="27a5c-144">实体集</span><span class="sxs-lookup"><span data-stu-id="27a5c-144">Entity sets</span></span>|<span data-ttu-id="27a5c-145">-删除实体集</span><span class="sxs-lookup"><span data-stu-id="27a5c-145">-   Remove entity set</span></span>|<span data-ttu-id="27a5c-146">添加派生的类型</span><span class="sxs-lookup"><span data-stu-id="27a5c-146">-   Add derived type</span></span><br /><span data-ttu-id="27a5c-147">-将基类型</span><span class="sxs-lookup"><span data-stu-id="27a5c-147">-   Change base type</span></span><br /><span data-ttu-id="27a5c-148">添加实体集</span><span class="sxs-lookup"><span data-stu-id="27a5c-148">-   Add entity set</span></span>|
|<span data-ttu-id="27a5c-149">源自定义</span><span class="sxs-lookup"><span data-stu-id="27a5c-149">Feed customization</span></span>|<span data-ttu-id="27a5c-150">更改实体属性映射</span><span class="sxs-lookup"><span data-stu-id="27a5c-150">-   Change entity-property mapping</span></span>||

 <span data-ttu-id="27a5c-151"><sup>1</sup>这可能取决于客户端应用程序依赖于接收的特定错误代码的严格程度。</span><span class="sxs-lookup"><span data-stu-id="27a5c-151"><sup>1</sup> This may depend on how strictly a client application relies on receiving a specific error code.</span></span>

 <span data-ttu-id="27a5c-152"><sup>2</sup>可以设置<xref:System.Data.Services.Client.DataServiceContext.IgnoreMissingProperties%2A>属性设置为`true`让客户端忽略数据服务发送的客户端未定义任何新属性。</span><span class="sxs-lookup"><span data-stu-id="27a5c-152"><sup>2</sup> You can set the <xref:System.Data.Services.Client.DataServiceContext.IgnoreMissingProperties%2A> property to `true` to have the client ignore any new properties sent by the data service that are not defined on the client.</span></span> <span data-ttu-id="27a5c-153">但是，当插入时，客户端在 POST 请求中不包括的属性都设置为其默认值。</span><span class="sxs-lookup"><span data-stu-id="27a5c-153">However, when inserts are made, the properties not included by the client in the POST request are set to their default values.</span></span> <span data-ttu-id="27a5c-154">对于更新，对客户端未知的属性中任何现有数据可能用默认值改写。</span><span class="sxs-lookup"><span data-stu-id="27a5c-154">For updates, any existing data in a property unknown to the client might be overwritten with default values.</span></span> <span data-ttu-id="27a5c-155">在此情况下，应将更新作为 MERGE 要求发送，这是默认值。</span><span class="sxs-lookup"><span data-stu-id="27a5c-155">In this case, you should send the update as a MERGE request, which is the default.</span></span> <span data-ttu-id="27a5c-156">有关详细信息，请参阅[管理数据服务上下文](../../../../docs/framework/data/wcf/managing-the-data-service-context-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="27a5c-156">For more information, see [Managing the Data Service Context](../../../../docs/framework/data/wcf/managing-the-data-service-context-wcf-data-services.md).</span></span>

### <a name="how-to-version-a-data-service"></a><span data-ttu-id="27a5c-157">如何对数据服务进行版本管理</span><span class="sxs-lookup"><span data-stu-id="27a5c-157">How to Version a Data Service</span></span>
 <span data-ttu-id="27a5c-158">在需要时，通过创建新服务实例（使用更新的服务协定或数据模型）定义新的数据服务版本。</span><span class="sxs-lookup"><span data-stu-id="27a5c-158">When required, a new data service version is defined by creating a new instance of the service with an updated service contract or data model.</span></span> <span data-ttu-id="27a5c-159">通过使用新的 URI 终结点（使其与以前的版本不同）公开该新服务。</span><span class="sxs-lookup"><span data-stu-id="27a5c-159">This new service is then exposed by using a new URI endpoint, which differentiates it from the previous version.</span></span> <span data-ttu-id="27a5c-160">例如：</span><span class="sxs-lookup"><span data-stu-id="27a5c-160">For example:</span></span>

-   <span data-ttu-id="27a5c-161">旧版本：`http://services.odata.org/Northwind/v1/Northwind.svc/`</span><span class="sxs-lookup"><span data-stu-id="27a5c-161">Old version: `http://services.odata.org/Northwind/v1/Northwind.svc/`</span></span>

-   <span data-ttu-id="27a5c-162">新版本：`http://services.odata.org/Northwind/v2/Northwind.svc/`</span><span class="sxs-lookup"><span data-stu-id="27a5c-162">New version: `http://services.odata.org/Northwind/v2/Northwind.svc/`</span></span>

 <span data-ttu-id="27a5c-163">升级数据服务时，客户端将需要也更新（基于新的数据服务的元数据）并使用新的根 URI。</span><span class="sxs-lookup"><span data-stu-id="27a5c-163">When upgrading a data service, clients will need to also be updated based on the new data service metadata and to use the new root URI.</span></span> <span data-ttu-id="27a5c-164">如果可能，您应维护以前版本的数据服务以支持尚未升级、无法使用新版本的客户端。</span><span class="sxs-lookup"><span data-stu-id="27a5c-164">When possible, you should maintain the previous version of the data service to support clients that have not yet been upgraded to use the new version.</span></span> <span data-ttu-id="27a5c-165">在不再需要时，可以删除旧版本的数据服务。</span><span class="sxs-lookup"><span data-stu-id="27a5c-165">Older versions of a data service can be removed when they are no longer needed.</span></span> <span data-ttu-id="27a5c-166">您应该考虑在外部配置文件中维护数据服务终结点 URI。</span><span class="sxs-lookup"><span data-stu-id="27a5c-166">You should consider maintaining the data service endpoint URI in an external configuration file.</span></span>

## <a name="odata-protocol-versions"></a><span data-ttu-id="27a5c-167">OData 协议版本</span><span class="sxs-lookup"><span data-stu-id="27a5c-167">OData Protocol Versions</span></span>
 <span data-ttu-id="27a5c-168">OData 的新版本的发布，客户端应用程序可能不使用相同版本的数据服务支持 OData 协议。</span><span class="sxs-lookup"><span data-stu-id="27a5c-168">As new versions of OData are released, client applications may not be using the same version of the OData protocol that is supported by the data service.</span></span> <span data-ttu-id="27a5c-169">较旧的客户端应用程序可能会访问数据服务支持 OData 的较新版本。</span><span class="sxs-lookup"><span data-stu-id="27a5c-169">An older client application may access a data service that supports a newer version of OData.</span></span> <span data-ttu-id="27a5c-170">客户端应用程序也可能使用 WCF 数据服务客户端库，该库支持 OData 的较新版本，比正在访问的数据服务的较新版本。</span><span class="sxs-lookup"><span data-stu-id="27a5c-170">A client application may also be using a newer version of the WCF Data Services client library, which supports a newer version of OData than does the data service that is being accessed.</span></span>

 <span data-ttu-id="27a5c-171">WCF 数据服务将利用 OData 来处理此类版本控制方案提供的支持。</span><span class="sxs-lookup"><span data-stu-id="27a5c-171">WCF Data Services leverages the support provided by OData to handle such versioning scenarios.</span></span> <span data-ttu-id="27a5c-172">此外，还有支持生成和使用数据模型元数据创建客户端数据服务类时客户端使用的版本不同的 OData 数据服务使用。</span><span class="sxs-lookup"><span data-stu-id="27a5c-172">There is also support for generating and using data model metadata to create client data service classes when the client uses a different version of OData than the data service uses.</span></span> <span data-ttu-id="27a5c-173">有关详细信息，请参阅[OData： 协议版本控制](https://go.microsoft.com/fwlink/?LinkId=186071)。</span><span class="sxs-lookup"><span data-stu-id="27a5c-173">For more information, see [OData: Protocol Versioning](https://go.microsoft.com/fwlink/?LinkId=186071).</span></span>

### <a name="version-negotiation"></a><span data-ttu-id="27a5c-174">版本协商</span><span class="sxs-lookup"><span data-stu-id="27a5c-174">Version Negotiation</span></span>
 <span data-ttu-id="27a5c-175">数据服务可以配置为定义的服务，而不考虑客户端请求的版本将使用 OData 协议的最高版本。</span><span class="sxs-lookup"><span data-stu-id="27a5c-175">The data service can be configured to define the highest version of the OData protocol that will be used by the service, regardless of the version requested by the client.</span></span> <span data-ttu-id="27a5c-176">您可以执行此操作通过指定<xref:System.Data.Services.Common.DataServiceProtocolVersion>值<xref:System.Data.Services.DataServiceBehavior.MaxProtocolVersion%2A>属性的<xref:System.Data.Services.DataServiceBehavior>由数据服务。</span><span class="sxs-lookup"><span data-stu-id="27a5c-176">You can do this by specifying a <xref:System.Data.Services.Common.DataServiceProtocolVersion> value for the <xref:System.Data.Services.DataServiceBehavior.MaxProtocolVersion%2A> property of the <xref:System.Data.Services.DataServiceBehavior> used by the data service.</span></span> <span data-ttu-id="27a5c-177">有关详细信息，请参阅[数据服务配置](../../../../docs/framework/data/wcf/configuring-the-data-service-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="27a5c-177">For more information, see [Configuring the Data Service](../../../../docs/framework/data/wcf/configuring-the-data-service-wcf-data-services.md).</span></span>

 <span data-ttu-id="27a5c-178">当应用程序使用 WCF 数据服务客户端库来访问数据服务时，库自动设置这些标头为正确的值，具体取决于 OData 和应用程序中使用的功能的版本。</span><span class="sxs-lookup"><span data-stu-id="27a5c-178">When an application uses the WCF Data Services client libraries to access a data service, the libraries automatically set these headers to the correct values, depending on the version of OData and the features that are used in your application.</span></span> <span data-ttu-id="27a5c-179">默认情况下，WCF 数据服务使用支持请求的操作的最低协议版本。</span><span class="sxs-lookup"><span data-stu-id="27a5c-179">By default, WCF Data Services uses the lowest protocol version that supports the requested operation.</span></span>

 <span data-ttu-id="27a5c-180">下表详细介绍的版本[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]和[!INCLUDE[silverlight](../../../../includes/silverlight-md.md)]，包括对特定版本的 OData 协议的 WCF 数据服务支持。</span><span class="sxs-lookup"><span data-stu-id="27a5c-180">The following table details the versions of [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] and [!INCLUDE[silverlight](../../../../includes/silverlight-md.md)] that include WCF Data Services support for specific versions of the OData protocol.</span></span>

|<span data-ttu-id="27a5c-181">OData 协议版本</span><span class="sxs-lookup"><span data-stu-id="27a5c-181">OData Protocol Version</span></span>|<span data-ttu-id="27a5c-182">支持引入方式</span><span class="sxs-lookup"><span data-stu-id="27a5c-182">Support introduced in…</span></span>|
|-----------------------------------------------------------------------------------|----------------------------|
|<span data-ttu-id="27a5c-183">1 版</span><span class="sxs-lookup"><span data-stu-id="27a5c-183">Version 1</span></span>|<span data-ttu-id="27a5c-184">-   [!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)] Service Pack 1 (SP1)</span><span class="sxs-lookup"><span data-stu-id="27a5c-184">-   [!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)] Service Pack 1 (SP1)</span></span><br /><span data-ttu-id="27a5c-185">-   [!INCLUDE[silverlight](../../../../includes/silverlight-md.md)] 版本 3</span><span class="sxs-lookup"><span data-stu-id="27a5c-185">-   [!INCLUDE[silverlight](../../../../includes/silverlight-md.md)] version 3</span></span>|
|<span data-ttu-id="27a5c-186">2 版</span><span class="sxs-lookup"><span data-stu-id="27a5c-186">Version 2</span></span>|-   [!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)]<br /><span data-ttu-id="27a5c-187">-对更新[!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)]SP1。</span><span class="sxs-lookup"><span data-stu-id="27a5c-187">-   An update to [!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)] SP1.</span></span> <span data-ttu-id="27a5c-188">您可以下载和安装从更新[Microsoft Download Center](https://go.microsoft.com/fwlink/?LinkId=158125)。</span><span class="sxs-lookup"><span data-stu-id="27a5c-188">You can download and install the update from the [Microsoft Download Center](https://go.microsoft.com/fwlink/?LinkId=158125).</span></span><br /><span data-ttu-id="27a5c-189">-   [!INCLUDE[silverlight](../../../../includes/silverlight-md.md)] 版本 4</span><span class="sxs-lookup"><span data-stu-id="27a5c-189">-   [!INCLUDE[silverlight](../../../../includes/silverlight-md.md)] version 4</span></span>|
|<span data-ttu-id="27a5c-190">3 版</span><span class="sxs-lookup"><span data-stu-id="27a5c-190">Version 3</span></span>|<span data-ttu-id="27a5c-191">-你可以下载并安装支持从 OData 版本 3 的预发行版本[Microsoft Download Center](https://go.microsoft.com/fwlink/?LinkId=203885)。</span><span class="sxs-lookup"><span data-stu-id="27a5c-191">-   You can download and install a pre-release version that supports OData version 3 from the [Microsoft Download Center](https://go.microsoft.com/fwlink/?LinkId=203885).</span></span>|

### <a name="metadata-versions"></a><span data-ttu-id="27a5c-192">元数据版本</span><span class="sxs-lookup"><span data-stu-id="27a5c-192">Metadata Versions</span></span>
 <span data-ttu-id="27a5c-193">默认情况下，WCF 数据服务使用 1.1 版的 CSDL 表示数据模型。</span><span class="sxs-lookup"><span data-stu-id="27a5c-193">By default, WCF Data Services uses version 1.1 of CSDL to represent a data model.</span></span> <span data-ttu-id="27a5c-194">对于基于反射提供程序或自定义数据服务提供程序的数据模型始终如此。</span><span class="sxs-lookup"><span data-stu-id="27a5c-194">This is always the case for data models that are based on either a reflection provider or a custom data service provider.</span></span> <span data-ttu-id="27a5c-195">但是，如果数据模型是使用[!INCLUDE[adonet_ef](../../../../includes/adonet-ef-md.md)]定义的，则返回的 CSDL 版本就是该[!INCLUDE[adonet_ef](../../../../includes/adonet-ef-md.md)]所用的版本。</span><span class="sxs-lookup"><span data-stu-id="27a5c-195">However, when the data model is defined by using the [!INCLUDE[adonet_ef](../../../../includes/adonet-ef-md.md)], the version of CSDL returned is the same as the version that is used by the [!INCLUDE[adonet_ef](../../../../includes/adonet-ef-md.md)].</span></span> <span data-ttu-id="27a5c-196">CSDL 的版本由的命名空间[架构元素](https://msdn.microsoft.com/library/396074d8-f99c-4f50-a073-68bce848224f)。</span><span class="sxs-lookup"><span data-stu-id="27a5c-196">The version of the CSDL is determined by the namespace of the [Schema element](https://msdn.microsoft.com/library/396074d8-f99c-4f50-a073-68bce848224f).</span></span> <span data-ttu-id="27a5c-197">有关详细信息，请参阅规范[ \[MC CSDL\]： 概念架构定义文件格式](https://go.microsoft.com/fwlink/?LinkId=159072)。</span><span class="sxs-lookup"><span data-stu-id="27a5c-197">For more information, see the specification [\[MC-CSDL\]: Conceptual Schema Definition File Format](https://go.microsoft.com/fwlink/?LinkId=159072).</span></span>

 <span data-ttu-id="27a5c-198">返回的元数据的 `DataServices` 元素还包含一个 `DataServiceVersion` 特性，该特性的值与响应消息中 `DataServiceVersion` 标头的值相同。</span><span class="sxs-lookup"><span data-stu-id="27a5c-198">The `DataServices` element of the returned metadata also contains a `DataServiceVersion` attribute, which is the same value as the `DataServiceVersion` header in the response message.</span></span> <span data-ttu-id="27a5c-199">客户端应用程序，如**添加服务引用**对话框在 Visual Studio 中，使用此信息来生成正确使用承载数据服务的 WCF 数据服务的版本的客户端数据服务类。</span><span class="sxs-lookup"><span data-stu-id="27a5c-199">Client applications, such as the **Add Service Reference** dialog box in Visual Studio, use this information to generate client data service classes that work correctly with the version of WCF Data Services that host the data service.</span></span> <span data-ttu-id="27a5c-200">有关详细信息，请参阅[OData： 协议版本控制](https://go.microsoft.com/fwlink/?LinkId=186071)。</span><span class="sxs-lookup"><span data-stu-id="27a5c-200">For more information, see [OData: Protocol Versioning](https://go.microsoft.com/fwlink/?LinkId=186071).</span></span>

## <a name="see-also"></a><span data-ttu-id="27a5c-201">请参阅</span><span class="sxs-lookup"><span data-stu-id="27a5c-201">See Also</span></span>

- [<span data-ttu-id="27a5c-202">数据服务提供程序</span><span class="sxs-lookup"><span data-stu-id="27a5c-202">Data Services Providers</span></span>](../../../../docs/framework/data/wcf/data-services-providers-wcf-data-services.md)
- [<span data-ttu-id="27a5c-203">定义 WCF Data Services</span><span class="sxs-lookup"><span data-stu-id="27a5c-203">Defining WCF Data Services</span></span>](../../../../docs/framework/data/wcf/defining-wcf-data-services.md)
