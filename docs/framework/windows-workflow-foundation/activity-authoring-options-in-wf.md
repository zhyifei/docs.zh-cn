---
title: WF 中的活动创作选项
ms.date: 03/30/2017
ms.assetid: b9061f5f-12c3-47f0-adbe-1330e2714c94
ms.openlocfilehash: 219d759cd1390a83abfb90af509b21047085f6e9
ms.sourcegitcommit: fb78d8abbdb87144a3872cf154930157090dd933
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/26/2018
ms.locfileid: "47216807"
---
# <a name="activity-authoring-options-in-wf"></a><span data-ttu-id="c9c35-102">WF 中的活动创作选项</span><span class="sxs-lookup"><span data-stu-id="c9c35-102">Activity Authoring Options in WF</span></span>
[!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)]<span data-ttu-id="c9c35-103">提供了若干用于创建自定义活动的选项。</span><span class="sxs-lookup"><span data-stu-id="c9c35-103"> provides several options for creating custom activities.</span></span> <span data-ttu-id="c9c35-104">用于创作给定活动的正确方法取决于所需的运行时功能。</span><span class="sxs-lookup"><span data-stu-id="c9c35-104">The correct method to use for authoring a given activity depends on what run-time features are required.</span></span>  
  
## <a name="deciding-which-base-activity-class-to-use-for-authoring-custom-activities"></a><span data-ttu-id="c9c35-105">确定哪个基本活动类用于创作自定义活动</span><span class="sxs-lookup"><span data-stu-id="c9c35-105">Deciding Which Base Activity Class to Use for Authoring Custom Activities</span></span>  
 <span data-ttu-id="c9c35-106">下表列出了自定义活动基类中可用的功能。</span><span class="sxs-lookup"><span data-stu-id="c9c35-106">The following table lists the features available in the custom activity base classes.</span></span>  
  
|<span data-ttu-id="c9c35-107">基本活动类</span><span class="sxs-lookup"><span data-stu-id="c9c35-107">Base activity class</span></span>|<span data-ttu-id="c9c35-108">可用的功能</span><span class="sxs-lookup"><span data-stu-id="c9c35-108">Features available</span></span>|  
|-------------------------|------------------------|  
|<xref:System.Activities.Activity>|<span data-ttu-id="c9c35-109">将一组系统提供的活动和一组自定义活动组成一个复合活动。</span><span class="sxs-lookup"><span data-stu-id="c9c35-109">Composes groups of system-provided and custom activities into a composite activity.</span></span>|  
|<xref:System.Activities.CodeActivity>|<span data-ttu-id="c9c35-110">通过提供可以重写的 <xref:System.Activities.CodeActivity%601.Execute%2A> 方法实现命令性功能。</span><span class="sxs-lookup"><span data-stu-id="c9c35-110">Implements imperative functionality by providing an <xref:System.Activities.CodeActivity%601.Execute%2A> method that can be overridden.</span></span> <span data-ttu-id="c9c35-111">还提供对跟踪、变量以及自变量的访问。</span><span class="sxs-lookup"><span data-stu-id="c9c35-111">Also provides access to tracking, variables, and arguments..</span></span>|  
|<xref:System.Activities.NativeActivity>|<span data-ttu-id="c9c35-112">提供 <xref:System.Activities.CodeActivity> 的所有功能，另外还可中止活动执行、取消子活动执行、使用书签以及计划活动、活动操作和功能。</span><span class="sxs-lookup"><span data-stu-id="c9c35-112">Provides all of the features of <xref:System.Activities.CodeActivity>, plus aborting activity execution, canceling child activity execution, using bookmarks, and scheduling activities, activity actions, and functions.</span></span>|  
|<xref:System.Activities.DynamicActivity>|<span data-ttu-id="c9c35-113">提供一个类似于 DOM 的方法，使用该方法可以构造通过 <xref:System.ComponentModel.ICustomTypeDescriptor> 与 WF 设计器和运行时系统交互的活动，从而允许在不定义新类型的情况下创建新活动。</span><span class="sxs-lookup"><span data-stu-id="c9c35-113">Provides a DOM-like approach to constructing activities that interfaces with the WF designer and the run-time machinery through <xref:System.ComponentModel.ICustomTypeDescriptor>, allowing new activities to be created without defining new types.</span></span>|  
  
## <a name="authoring-activities-using-activity"></a><span data-ttu-id="c9c35-114">使用 Activity 创作活动</span><span class="sxs-lookup"><span data-stu-id="c9c35-114">Authoring Activities using Activity</span></span>  
 <span data-ttu-id="c9c35-115">从 <xref:System.Activities.Activity> 派生的活动通过组合其他现有活动来构成功能。</span><span class="sxs-lookup"><span data-stu-id="c9c35-115">Activities that derive from <xref:System.Activities.Activity> compose functionality by assembling other existing activities.</span></span> <span data-ttu-id="c9c35-116">这些活动可以是现有的自定义活动，也可以是来自 [!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)]活动库的活动。</span><span class="sxs-lookup"><span data-stu-id="c9c35-116">These activities can be existing custom activities and activities from the [!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)] activity library.</span></span> <span data-ttu-id="c9c35-117">组合这些活动是创建自定义功能的最基本方法。</span><span class="sxs-lookup"><span data-stu-id="c9c35-117">Assembling these activities is the most basic way to create custom functionality.</span></span> <span data-ttu-id="c9c35-118">使用可视化设计环境创作工作流时这种方法最常用。</span><span class="sxs-lookup"><span data-stu-id="c9c35-118">This approach is most typically taken when using a visual design environment for authoring workflows.</span></span>  
  
## <a name="authoring-activities-using-codeactivity-or-asynccodeactivity"></a><span data-ttu-id="c9c35-119">使用 CodeActivity 或 AsyncCodeActivity 创作活动</span><span class="sxs-lookup"><span data-stu-id="c9c35-119">Authoring Activities using CodeActivity or AsyncCodeActivity</span></span>  
 <span data-ttu-id="c9c35-120">从 <xref:System.Activities.CodeActivity> 或 <xref:System.Activities.AsyncCodeActivity> 派生的活动可以通过用自定义的命令性代码重写 <xref:System.Activities.CodeActivity%601.Execute%2A> 方法来实现命令性功能。</span><span class="sxs-lookup"><span data-stu-id="c9c35-120">Activities that derive from <xref:System.Activities.CodeActivity> or <xref:System.Activities.AsyncCodeActivity> can implement imperative functionality by overriding the <xref:System.Activities.CodeActivity%601.Execute%2A> method with custom imperative code.</span></span> <span data-ttu-id="c9c35-121">活动由运行时执行时将执行该自定义代码。</span><span class="sxs-lookup"><span data-stu-id="c9c35-121">The custom code is executed when the activity is executed by the runtime.</span></span> <span data-ttu-id="c9c35-122">尽管使用这种方法创建的活动可以访问自定义功能，但是它们无法访问运行时的所有功能，如对执行环境的完全访问、安排子活动、书签的功能或对 Cancel 或 Abort 方法的支持。</span><span class="sxs-lookup"><span data-stu-id="c9c35-122">While activities created in this way have access to custom functionality, they do not have access to all of the features of the runtime, such as full access to the execution environment, the ability to schedule child activities, bookmark creation, or support for a Cancel or Abort method.</span></span> <span data-ttu-id="c9c35-123">执行 <xref:System.Activities.CodeActivity> 时，它可以访问简化版本的执行环境（通过 <xref:System.Activities.CodeActivityContext> 或 <xref:System.Activities.AsyncCodeActivityContext> 类）。</span><span class="sxs-lookup"><span data-stu-id="c9c35-123">When a <xref:System.Activities.CodeActivity> executes, it has access to a reduced version of the execution environment (through the <xref:System.Activities.CodeActivityContext> or <xref:System.Activities.AsyncCodeActivityContext> class).</span></span> <span data-ttu-id="c9c35-124">使用 <xref:System.Activities.CodeActivity> 创建的活动可以访问参数和变量解析、扩展以及跟踪。</span><span class="sxs-lookup"><span data-stu-id="c9c35-124">Activities created using <xref:System.Activities.CodeActivity> have access to argument and variable resolution, extensions, and tracking.</span></span> <span data-ttu-id="c9c35-125">可以使用 <xref:System.Activities.AsyncCodeActivity> 进行异步活动计划。</span><span class="sxs-lookup"><span data-stu-id="c9c35-125">Asynchronous activity scheduling can be done using <xref:System.Activities.AsyncCodeActivity>.</span></span>  
  
## <a name="authoring-activities-using-nativeactivity"></a><span data-ttu-id="c9c35-126">使用 NativeActivity 创作活动</span><span class="sxs-lookup"><span data-stu-id="c9c35-126">Authoring Activities using NativeActivity</span></span>  
 <span data-ttu-id="c9c35-127">从 <xref:System.Activities.NativeActivity> 派生的活动，与从 <xref:System.Activities.CodeActivity> 派生的活动一样，可通过重写 <xref:System.Activities.NativeActivity.Execute%2A> 来创建命令性功能，除此之外还可以通过传递给 <xref:System.Activities.NativeActivityContext> 方法的 <xref:System.Activities.NativeActivity.Execute%2A> 访问工作流运行时的所有功能。</span><span class="sxs-lookup"><span data-stu-id="c9c35-127">Activities that derive from <xref:System.Activities.NativeActivity>, like those that derive from <xref:System.Activities.CodeActivity>, create imperative functionality by overriding <xref:System.Activities.NativeActivity.Execute%2A>, but also have access to all of the functionality of the workflow runtime through the <xref:System.Activities.NativeActivityContext> that gets passed into the <xref:System.Activities.NativeActivity.Execute%2A> method.</span></span> <span data-ttu-id="c9c35-128">此上下文支持多种功能，包括安排和取消子活动、执行 <xref:System.Activities.ActivityAction> 和 <xref:System.Activities.ActivityFunc%601> 对象、将事务流入工作流、调用异步进程、取消和中止执行、访问执行属性和扩展以及书签（恢复暂停工作流的处理程序）。</span><span class="sxs-lookup"><span data-stu-id="c9c35-128">This context has support for scheduling and canceling child activities, executing <xref:System.Activities.ActivityAction> and <xref:System.Activities.ActivityFunc%601> objects, flowing transactions into a workflow, invoking asynchronous processes, canceling and aborting execution, access to execution properties and extensions, and bookmarks (handles for resuming paused workflows).</span></span>  
  
## <a name="authoring-activities-using-dynamicactivity"></a><span data-ttu-id="c9c35-129">使用 DynamicActivity 创作活动</span><span class="sxs-lookup"><span data-stu-id="c9c35-129">Authoring Activities using DynamicActivity</span></span>  
 <span data-ttu-id="c9c35-130">与其他三种活动类型不同，不会通过从 <xref:System.Activities.DynamicActivity>（该类是密封的）派生新类型来创建新功能，而是通过使用活动文档对象模型 (DOM) 将功能组合到 <xref:System.Activities.DynamicActivity.Properties%2A> 和 <xref:System.Activities.DynamicActivity.Implementation%2A> 属性中。</span><span class="sxs-lookup"><span data-stu-id="c9c35-130">Unlike the other three types of activity, new functionality is not created by deriving new types from <xref:System.Activities.DynamicActivity> (the class is sealed), but instead, by assembling functionality into the <xref:System.Activities.DynamicActivity.Properties%2A> and <xref:System.Activities.DynamicActivity.Implementation%2A> properties using an activity document object model (DOM).</span></span>  
  
## <a name="authoring-activities-that-return-a-result"></a><span data-ttu-id="c9c35-131">创作返回结果的活动</span><span class="sxs-lookup"><span data-stu-id="c9c35-131">Authoring Activities that Return a Result</span></span>  
 <span data-ttu-id="c9c35-132">很多活动必须在其执行之后返回结果。</span><span class="sxs-lookup"><span data-stu-id="c9c35-132">Many activities must return a result after their execution.</span></span> <span data-ttu-id="c9c35-133">尽管可以在活动上始终定义一个自定义 <xref:System.Activities.OutArgument%601> 来实现此目的，但是建议改用 <xref:System.Activities.Activity%601> 或者从 <xref:System.Activities.CodeActivity%601> 或 <xref:System.Activities.NativeActivity%601> 派生。</span><span class="sxs-lookup"><span data-stu-id="c9c35-133">Although it is possible to always define a custom <xref:System.Activities.OutArgument%601> on an activity for this purpose, it is suggested to instead use <xref:System.Activities.Activity%601>, or derive from <xref:System.Activities.CodeActivity%601> or <xref:System.Activities.NativeActivity%601>.</span></span> <span data-ttu-id="c9c35-134">这些基类中的每个类都具有一个名为 Result 的 <xref:System.Activities.OutArgument%601>，您的活动可以使用它作为其返回值。</span><span class="sxs-lookup"><span data-stu-id="c9c35-134">Each of these base classes has an <xref:System.Activities.OutArgument%601> named Result that your activity can use for its return value.</span></span> <span data-ttu-id="c9c35-135">只有在一个结果需要从某一活动返回时，才应使用返回某一结果的活动；如果需要返回多个结果，则应改用单独的 <xref:System.Activities.OutArgument%601> 成员。</span><span class="sxs-lookup"><span data-stu-id="c9c35-135">Activities that return a result should only be used if only one result needs to be returned from an activity; if multiple results need to be returned, separate <xref:System.Activities.OutArgument%601> members should be used instead.</span></span>
