---
title: "通过创建 ControlTemplate 自定义现有控件的外观"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-wpf
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords:
- control contract [WPF]
- controls [WPF], visual structure changes
- ControlTemplate [WPF], customizing for existing controls
- skinning controls [WPF]
- controls [WPF], appearance specified by state
- templates [WPF], custom for existing controls
ms.assetid: 678dd116-43a2-4b8c-82b5-6b826f126e31
caps.latest.revision: "12"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 0019b739c794cbffa62b49749371c2a19f752267
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/22/2017
---
# <a name="customizing-the-appearance-of-an-existing-control-by-creating-a-controltemplate"></a><span data-ttu-id="0f295-102">通过创建 ControlTemplate 自定义现有控件的外观</span><span class="sxs-lookup"><span data-stu-id="0f295-102">Customizing the Appearance of an Existing Control by Creating a ControlTemplate</span></span>
<a name="introduction"></a><span data-ttu-id="0f295-103">A<xref:System.Windows.Controls.ControlTemplate>指定可视结构和控件的可视行为。</span><span class="sxs-lookup"><span data-stu-id="0f295-103">A <xref:System.Windows.Controls.ControlTemplate> specifies the visual structure and visual behavior of a control.</span></span> <span data-ttu-id="0f295-104">你可以提供一个新的 it，从而自定义控件的外观<xref:System.Windows.Controls.ControlTemplate>。</span><span class="sxs-lookup"><span data-stu-id="0f295-104">You can customize the appearance of a control by giving it a new <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="0f295-105">当你创建<xref:System.Windows.Controls.ControlTemplate>，而无需更改其功能替换现有的控件的外观。</span><span class="sxs-lookup"><span data-stu-id="0f295-105">When you create a <xref:System.Windows.Controls.ControlTemplate>, you replace the appearance of an existing control without changing its functionality.</span></span> <span data-ttu-id="0f295-106">例如，你可以使这些按钮在你的应用程序而不是默认的正方形形状，舍入，但仍将引发按钮<xref:System.Windows.Controls.Primitives.ButtonBase.Click>事件。</span><span class="sxs-lookup"><span data-stu-id="0f295-106">For example, you can make the buttons in your application round instead of the default square shape, but the button will still raise the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event.</span></span>  
  
 <span data-ttu-id="0f295-107">本主题说明的各个部分<xref:System.Windows.Controls.ControlTemplate>，演示如何创建一个简单<xref:System.Windows.Controls.ControlTemplate>为<xref:System.Windows.Controls.Button>，并说明如何了解控件的控件协定，以便您可以自定义其外观。</span><span class="sxs-lookup"><span data-stu-id="0f295-107">This topic explains the various parts of a <xref:System.Windows.Controls.ControlTemplate>, demonstrates creating a simple <xref:System.Windows.Controls.ControlTemplate> for a <xref:System.Windows.Controls.Button>, and explains how to understand the control contract of a control so that you can customize its appearance.</span></span> <span data-ttu-id="0f295-108">因为你创建<xref:System.Windows.Controls.ControlTemplate>中[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]，你可以更改控件的外观，而无需编写任何代码。</span><span class="sxs-lookup"><span data-stu-id="0f295-108">Because you create a <xref:System.Windows.Controls.ControlTemplate> in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], you can change a control's appearance without writing any code.</span></span> <span data-ttu-id="0f295-109">还可以使用设计器（如 Microsoft Expression Blend）创建自定义控件模板。</span><span class="sxs-lookup"><span data-stu-id="0f295-109">You can also use a designer, such as Microsoft Expression Blend, to create custom control templates.</span></span> <span data-ttu-id="0f295-110">本主题说明中的示例[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]，自定义的外观<xref:System.Windows.Controls.Button>并列出在主题末尾的完整示例。</span><span class="sxs-lookup"><span data-stu-id="0f295-110">This topic shows examples in the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] that customize the appearance of a <xref:System.Windows.Controls.Button> and lists the complete example at the end of the topic.</span></span> <span data-ttu-id="0f295-111">有关使用 Expression Blend 的详细信息，请参阅[设置支持模板的控件的样式](http://go.microsoft.com/fwlink/?LinkId=161153)。</span><span class="sxs-lookup"><span data-stu-id="0f295-111">For more information about using Expression Blend, see [Styling a control that supports templates](http://go.microsoft.com/fwlink/?LinkId=161153).</span></span>  
  
 <span data-ttu-id="0f295-112">如下图所示<xref:System.Windows.Controls.Button>使用<xref:System.Windows.Controls.ControlTemplate>本主题中创建。</span><span class="sxs-lookup"><span data-stu-id="0f295-112">The following illustrations show a <xref:System.Windows.Controls.Button> that uses the <xref:System.Windows.Controls.ControlTemplate> that is created in this topic.</span></span>  
  
 <span data-ttu-id="0f295-113">![一个具有自定义控件模板按钮。] (../../../../docs/framework/wpf/controls/media/ndp-buttonnormal.png "NDP_ButtonNormal")</span><span class="sxs-lookup"><span data-stu-id="0f295-113">![A button with a custom control template.](../../../../docs/framework/wpf/controls/media/ndp-buttonnormal.png "NDP_ButtonNormal")</span></span>  
<span data-ttu-id="0f295-114">使用自定义控件模板的按钮</span><span class="sxs-lookup"><span data-stu-id="0f295-114">A button that uses a custom control template</span></span>  
  
 <span data-ttu-id="0f295-115">![一个具有红色边框按钮。] (../../../../docs/framework/wpf/controls/media/ndp-buttonmouseover.png "NDP_ButtonMouseOver")</span><span class="sxs-lookup"><span data-stu-id="0f295-115">![A button with a red border.](../../../../docs/framework/wpf/controls/media/ndp-buttonmouseover.png "NDP_ButtonMouseOver")</span></span>  
<span data-ttu-id="0f295-116">使用自定义控件模板并将鼠标指针悬停在上方的按钮</span><span class="sxs-lookup"><span data-stu-id="0f295-116">A button that uses a custom control template and has the mouse pointer over it</span></span>  
  
  
<a name="prerequisites"></a>   
## <a name="prerequisites"></a><span data-ttu-id="0f295-117">系统必备</span><span class="sxs-lookup"><span data-stu-id="0f295-117">Prerequisites</span></span>  
 <span data-ttu-id="0f295-118">本主题假设用户了解如何创建和使用[控件](../../../../docs/framework/wpf/controls/index.md)中讨论的控件和样式。</span><span class="sxs-lookup"><span data-stu-id="0f295-118">This topic assumes that you understand how to create and use controls and styles as discussed in [Controls](../../../../docs/framework/wpf/controls/index.md).</span></span> <span data-ttu-id="0f295-119">本主题中讨论的概念适用于从继承元素<xref:System.Windows.Controls.Control>类，除了<xref:System.Windows.Controls.UserControl>。</span><span class="sxs-lookup"><span data-stu-id="0f295-119">The concepts discussed in this topic apply to elements that inherit from the <xref:System.Windows.Controls.Control> class, except for the <xref:System.Windows.Controls.UserControl>.</span></span> <span data-ttu-id="0f295-120">不能将应用<xref:System.Windows.Controls.ControlTemplate>到<xref:System.Windows.Controls.UserControl>。</span><span class="sxs-lookup"><span data-stu-id="0f295-120">You cannot apply a <xref:System.Windows.Controls.ControlTemplate> to a <xref:System.Windows.Controls.UserControl>.</span></span>  
  
<a name="when_you_should_create_a_controltemplate"></a>   
## <a name="when-you-should-create-a-controltemplate"></a><span data-ttu-id="0f295-121">何时应创建 ControlTemplate</span><span class="sxs-lookup"><span data-stu-id="0f295-121">When You Should Create a ControlTemplate</span></span>  
 <span data-ttu-id="0f295-122">控件具有多个属性，如<xref:System.Windows.Controls.Border.Background%2A>， <xref:System.Windows.Controls.Control.Foreground%2A>，和<xref:System.Windows.Controls.Control.FontFamily%2A>，你可以将设置指定控件的外观的不同方面，但你可以通过设置这些属性的更改受到限制。</span><span class="sxs-lookup"><span data-stu-id="0f295-122">Controls have many properties, such as <xref:System.Windows.Controls.Border.Background%2A>, <xref:System.Windows.Controls.Control.Foreground%2A>, and <xref:System.Windows.Controls.Control.FontFamily%2A>, that you can set to specify different aspects of the control's appearance, but the changes that you can make by setting these properties are limited.</span></span> <span data-ttu-id="0f295-123">例如，你可以设置<xref:System.Windows.Controls.Control.Foreground%2A>属性为蓝色和<xref:System.Windows.Controls.Control.FontStyle%2A>为倾斜<xref:System.Windows.Controls.CheckBox>。</span><span class="sxs-lookup"><span data-stu-id="0f295-123">For example, you can set the <xref:System.Windows.Controls.Control.Foreground%2A> property to blue and <xref:System.Windows.Controls.Control.FontStyle%2A> to italic on a <xref:System.Windows.Controls.CheckBox>.</span></span>  
  
 <span data-ttu-id="0f295-124">如果不能创建一个新<xref:System.Windows.Controls.ControlTemplate>的控件，所有控件中每个[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-基于应用程序是否有相同的常规外观，这将限制能够使用自定义的外观和感觉创建应用程序。</span><span class="sxs-lookup"><span data-stu-id="0f295-124">Without the ability to create a new <xref:System.Windows.Controls.ControlTemplate> for controls, all controls in every [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-based application would have the same general appearance, which would limit the ability to create an application with a custom look and feel.</span></span> <span data-ttu-id="0f295-125">默认情况下，每个<xref:System.Windows.Controls.CheckBox>具有相似的特性。</span><span class="sxs-lookup"><span data-stu-id="0f295-125">By default, every <xref:System.Windows.Controls.CheckBox> has similar characteristics.</span></span> <span data-ttu-id="0f295-126">例如，内容<xref:System.Windows.Controls.CheckBox>选择指示器，右侧始终是并且始终要使用复选标记，则指示<xref:System.Windows.Controls.CheckBox>选择。</span><span class="sxs-lookup"><span data-stu-id="0f295-126">For example, the content of the <xref:System.Windows.Controls.CheckBox> is always to the right of the selection indicator, and the check mark is always used to indicate that the <xref:System.Windows.Controls.CheckBox> is selected.</span></span>  
  
 <span data-ttu-id="0f295-127">你创建<xref:System.Windows.Controls.ControlTemplate>如果想要自定义控件的外观之外哪些在控件上设置其他属性将执行。</span><span class="sxs-lookup"><span data-stu-id="0f295-127">You create a <xref:System.Windows.Controls.ControlTemplate> when you want to customize the control's appearance beyond what setting the other properties on the control will do.</span></span> <span data-ttu-id="0f295-128">在示例中的<xref:System.Windows.Controls.CheckBox>，假设你想要选择指示器上方的复选框的内容以及你希望 X，则指示<xref:System.Windows.Controls.CheckBox>选择。</span><span class="sxs-lookup"><span data-stu-id="0f295-128">In the example of the <xref:System.Windows.Controls.CheckBox>, suppose that you want the content of the check box to be above the selection indicator and you want an X to indicate that the <xref:System.Windows.Controls.CheckBox> is selected.</span></span> <span data-ttu-id="0f295-129">指定在这些更改<xref:System.Windows.Controls.ControlTemplate>的<xref:System.Windows.Controls.CheckBox>。</span><span class="sxs-lookup"><span data-stu-id="0f295-129">You specify these changes in the <xref:System.Windows.Controls.ControlTemplate> of the <xref:System.Windows.Controls.CheckBox>.</span></span>  
  
 <span data-ttu-id="0f295-130">下图显示<xref:System.Windows.Controls.CheckBox>使用默认<xref:System.Windows.Controls.ControlTemplate>。</span><span class="sxs-lookup"><span data-stu-id="0f295-130">The following illustration shows a <xref:System.Windows.Controls.CheckBox> that uses a default <xref:System.Windows.Controls.ControlTemplate>.</span></span>  
  
 <span data-ttu-id="0f295-131">![一个具有默认控件模板的复选框。] (../../../../docs/framework/wpf/controls/media/ndp-checkboxdefault.png "NDP_CheckBoxDefault")</span><span class="sxs-lookup"><span data-stu-id="0f295-131">![A checkbox with the default control template.](../../../../docs/framework/wpf/controls/media/ndp-checkboxdefault.png "NDP_CheckBoxDefault")</span></span>  
<span data-ttu-id="0f295-132">一个具有默认控件模板的复选框</span><span class="sxs-lookup"><span data-stu-id="0f295-132">A CheckBox that uses the default control template</span></span>  
  
 <span data-ttu-id="0f295-133">下图显示<xref:System.Windows.Controls.CheckBox>使用自定义<xref:System.Windows.Controls.ControlTemplate>放置的内容<xref:System.Windows.Controls.CheckBox>上方选择指示器，显示 X 时<xref:System.Windows.Controls.CheckBox>选择。</span><span class="sxs-lookup"><span data-stu-id="0f295-133">The following illustration shows a <xref:System.Windows.Controls.CheckBox> that uses a custom <xref:System.Windows.Controls.ControlTemplate> to place the content of the <xref:System.Windows.Controls.CheckBox> above the selection indicator and displays an X when the <xref:System.Windows.Controls.CheckBox> is selected.</span></span>  
  
 <span data-ttu-id="0f295-134">![一个具有自定义控件模板的复选框。] (../../../../docs/framework/wpf/controls/media/ndp-checkboxcustom.png "NDP_CheckBoxCustom")</span><span class="sxs-lookup"><span data-stu-id="0f295-134">![A checkbox with a custom control template.](../../../../docs/framework/wpf/controls/media/ndp-checkboxcustom.png "NDP_CheckBoxCustom")</span></span>  
<span data-ttu-id="0f295-135">一个具有自定义控件模板的复选框</span><span class="sxs-lookup"><span data-stu-id="0f295-135">A CheckBox that uses a custom control template</span></span>  
  
 <span data-ttu-id="0f295-136"><xref:System.Windows.Controls.ControlTemplate>为<xref:System.Windows.Controls.CheckBox>在此示例是相对较为复杂，因此本主题使用创建的简单示例<xref:System.Windows.Controls.ControlTemplate>为<xref:System.Windows.Controls.Button>。</span><span class="sxs-lookup"><span data-stu-id="0f295-136">The <xref:System.Windows.Controls.ControlTemplate> for the <xref:System.Windows.Controls.CheckBox> in this sample is relatively complex, so this topic uses a simpler example of creating a <xref:System.Windows.Controls.ControlTemplate> for a <xref:System.Windows.Controls.Button>.</span></span>  
  
<a name="changing_the_visual_structure_of_a_control"></a>   
## <a name="changing-the-visual-structure-of-a-control"></a><span data-ttu-id="0f295-137">更改控件的可视结构</span><span class="sxs-lookup"><span data-stu-id="0f295-137">Changing the Visual Structure of a Control</span></span>  
 <span data-ttu-id="0f295-138">在[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]，控件通常是一个复合<xref:System.Windows.FrameworkElement>对象。</span><span class="sxs-lookup"><span data-stu-id="0f295-138">In [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], a control is often a composite <xref:System.Windows.FrameworkElement> objects.</span></span> <span data-ttu-id="0f295-139">当你创建<xref:System.Windows.Controls.ControlTemplate>，你将结合<xref:System.Windows.FrameworkElement>对象以生成单个控件。</span><span class="sxs-lookup"><span data-stu-id="0f295-139">When you create a <xref:System.Windows.Controls.ControlTemplate>, you combine <xref:System.Windows.FrameworkElement> objects to build a single control.</span></span> <span data-ttu-id="0f295-140">A<xref:System.Windows.Controls.ControlTemplate>必须只有一个<xref:System.Windows.FrameworkElement>作为其根元素。</span><span class="sxs-lookup"><span data-stu-id="0f295-140">A <xref:System.Windows.Controls.ControlTemplate> must have only one <xref:System.Windows.FrameworkElement> as its root element.</span></span> <span data-ttu-id="0f295-141">根元素通常包含其他<xref:System.Windows.FrameworkElement>对象。</span><span class="sxs-lookup"><span data-stu-id="0f295-141">The root element usually contains other <xref:System.Windows.FrameworkElement> objects.</span></span> <span data-ttu-id="0f295-142">对象组合构成控件的可视结构。</span><span class="sxs-lookup"><span data-stu-id="0f295-142">The combination of objects makes up the control's visual structure.</span></span>  
  
 <span data-ttu-id="0f295-143">下面的示例创建一个自定义<xref:System.Windows.Controls.ControlTemplate>为<xref:System.Windows.Controls.Button>。</span><span class="sxs-lookup"><span data-stu-id="0f295-143">The following example creates a custom <xref:System.Windows.Controls.ControlTemplate> for the <xref:System.Windows.Controls.Button>.</span></span> <span data-ttu-id="0f295-144"><xref:System.Windows.Controls.ControlTemplate>创建的可视结构<xref:System.Windows.Controls.Button>。</span><span class="sxs-lookup"><span data-stu-id="0f295-144">The <xref:System.Windows.Controls.ControlTemplate> creates the visual structure of the <xref:System.Windows.Controls.Button>.</span></span> <span data-ttu-id="0f295-145">在按钮上方移动鼠标指针或单击它时，此示例不会更改按钮的外观。</span><span class="sxs-lookup"><span data-stu-id="0f295-145">This example does not change the button's appearance when you move the mouse pointer over it or click it.</span></span> <span data-ttu-id="0f295-146">本主题后面部分将讨论当按钮处于其他状态时更改它的外观。</span><span class="sxs-lookup"><span data-stu-id="0f295-146">Changing the button's appearance when it is in a different state is discussed later in this topic.</span></span>  
  
 <span data-ttu-id="0f295-147">在本示例中，可视结构包括以下部分：</span><span class="sxs-lookup"><span data-stu-id="0f295-147">In this example, the visual structure consists of the following parts:</span></span>  
  
-   <span data-ttu-id="0f295-148">A<xref:System.Windows.Controls.Border>名为`RootElement`用作模板的根<xref:System.Windows.FrameworkElement>。</span><span class="sxs-lookup"><span data-stu-id="0f295-148">A <xref:System.Windows.Controls.Border> named `RootElement` that serves as the template's root <xref:System.Windows.FrameworkElement>.</span></span>  
  
-   <span data-ttu-id="0f295-149">A<xref:System.Windows.Controls.Grid>子级的`RootElement`。</span><span class="sxs-lookup"><span data-stu-id="0f295-149">A <xref:System.Windows.Controls.Grid> that is a child of `RootElement`.</span></span>  
  
-   <span data-ttu-id="0f295-150">A<xref:System.Windows.Controls.ContentPresenter>显示按钮的内容。</span><span class="sxs-lookup"><span data-stu-id="0f295-150">A <xref:System.Windows.Controls.ContentPresenter> that displays the button's content.</span></span> <span data-ttu-id="0f295-151"><xref:System.Windows.Controls.ContentPresenter>使任何类型的对象要显示。</span><span class="sxs-lookup"><span data-stu-id="0f295-151">The <xref:System.Windows.Controls.ContentPresenter> enables any type of object to be displayed.</span></span>  
  
 [!code-xaml[VSMButtonTemplate#BasicTemplate](../../../../samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/buttonstages.xaml#basictemplate)]  
  
### <a name="preserving-the-functionality-of-a-controls-properties-by-using-templatebinding"></a><span data-ttu-id="0f295-152">使用 TemplateBinding 保留控件属性的功能</span><span class="sxs-lookup"><span data-stu-id="0f295-152">Preserving the Functionality of a Control's Properties by Using TemplateBinding</span></span>  
 <span data-ttu-id="0f295-153">当你创建一个新<xref:System.Windows.Controls.ControlTemplate>，你仍可能想要使用的公共属性来更改控件的外观。</span><span class="sxs-lookup"><span data-stu-id="0f295-153">When you create a new <xref:System.Windows.Controls.ControlTemplate>, you still might want to use the public properties to change the control's appearance.</span></span> <span data-ttu-id="0f295-154">[TemplateBinding](../../../../docs/framework/wpf/advanced/templatebinding-markup-extension.md)将中的元素的属性绑定标记扩展<xref:System.Windows.Controls.ControlTemplate>到由控件定义的公共属性。</span><span class="sxs-lookup"><span data-stu-id="0f295-154">The [TemplateBinding](../../../../docs/framework/wpf/advanced/templatebinding-markup-extension.md) markup extension binds a property of an element that is in the <xref:System.Windows.Controls.ControlTemplate> to a public property that is defined by the control.</span></span> <span data-ttu-id="0f295-155">使用 [TemplateBinding](../../../../docs/framework/wpf/advanced/templatebinding-markup-extension.md) 时，可让控件属性用作模板参数。</span><span class="sxs-lookup"><span data-stu-id="0f295-155">When you use [TemplateBinding](../../../../docs/framework/wpf/advanced/templatebinding-markup-extension.md), you enable properties on the control to act as parameters to the template.</span></span> <span data-ttu-id="0f295-156">换言之，设置控件属性后，该值将传递到包含 [TemplateBinding](../../../../docs/framework/wpf/advanced/templatebinding-markup-extension.md) 的元素。</span><span class="sxs-lookup"><span data-stu-id="0f295-156">That is, when a property on a control is set, that value is passed on to the element that has the [TemplateBinding](../../../../docs/framework/wpf/advanced/templatebinding-markup-extension.md) on it.</span></span>  
  
 <span data-ttu-id="0f295-157">下面的示例重复前面的示例使用的部分[TemplateBinding](../../../../docs/framework/wpf/advanced/templatebinding-markup-extension.md)绑定中的元素的属性的标记扩展<xref:System.Windows.Controls.ControlTemplate>到了按钮定义的公共属性。</span><span class="sxs-lookup"><span data-stu-id="0f295-157">The following example repeats the part of the preceding example that uses the [TemplateBinding](../../../../docs/framework/wpf/advanced/templatebinding-markup-extension.md) markup extension to bind properties of elements that are in the <xref:System.Windows.Controls.ControlTemplate> to public properties that are defined by the button.</span></span>  
  
 [!code-xaml[VSMButtonTemplate#TemplateBinding](../../../../samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/buttonstages.xaml#templatebinding)]  
  
 <span data-ttu-id="0f295-158">在此示例中，<xref:System.Windows.Controls.Grid>具有其<xref:System.Windows.Controls.Panel.Background%2A?displayProperty=nameWithType>属性模板绑定到<xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="0f295-158">In this example, the <xref:System.Windows.Controls.Grid> has its <xref:System.Windows.Controls.Panel.Background%2A?displayProperty=nameWithType> property template bound to <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="0f295-159">因为<xref:System.Windows.Controls.Panel.Background%2A?displayProperty=nameWithType>是绑定的模板，您可以创建使用相同的多个按钮<xref:System.Windows.Controls.ControlTemplate>并设置<xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType>为每个按钮上的不同值。</span><span class="sxs-lookup"><span data-stu-id="0f295-159">Because <xref:System.Windows.Controls.Panel.Background%2A?displayProperty=nameWithType> is template bound, you can create multiple buttons that use the same <xref:System.Windows.Controls.ControlTemplate> and set the <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType> to different values on each button.</span></span> <span data-ttu-id="0f295-160">如果<xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType>没有模板绑定中的某个元素的属性<xref:System.Windows.Controls.ControlTemplate>，则设置<xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType>的按钮对不会影响该按钮的外观。</span><span class="sxs-lookup"><span data-stu-id="0f295-160">If <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType> was not template bound to a property of an element in the <xref:System.Windows.Controls.ControlTemplate>, setting the <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType> of a button would have no impact on the button's appearance.</span></span>  
  
 <span data-ttu-id="0f295-161">请注意，两个属性的名称不必一样。</span><span class="sxs-lookup"><span data-stu-id="0f295-161">Note that the names of the two properties do not need to be identical.</span></span> <span data-ttu-id="0f295-162">在前面的示例中，<xref:System.Windows.Controls.Control.HorizontalContentAlignment%2A?displayProperty=nameWithType>属性<xref:System.Windows.Controls.Button>模板绑定到<xref:System.Windows.FrameworkElement.HorizontalAlignment%2A?displayProperty=nameWithType>属性<xref:System.Windows.Controls.ContentPresenter>。</span><span class="sxs-lookup"><span data-stu-id="0f295-162">In the preceding example, the <xref:System.Windows.Controls.Control.HorizontalContentAlignment%2A?displayProperty=nameWithType> property of the <xref:System.Windows.Controls.Button> is template bound to the <xref:System.Windows.FrameworkElement.HorizontalAlignment%2A?displayProperty=nameWithType> property of the <xref:System.Windows.Controls.ContentPresenter>.</span></span> <span data-ttu-id="0f295-163">这样可以水平放置按钮的内容。</span><span class="sxs-lookup"><span data-stu-id="0f295-163">This enables the content of the button to be positioned horizontally.</span></span> <span data-ttu-id="0f295-164"><xref:System.Windows.Controls.ContentPresenter>没有名为的属性`HorizontalContentAlignment`，但<xref:System.Windows.Controls.Control.HorizontalContentAlignment%2A?displayProperty=nameWithType>可以绑定到<xref:System.Windows.FrameworkElement.HorizontalAlignment%2A?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="0f295-164"><xref:System.Windows.Controls.ContentPresenter> does not have a property named `HorizontalContentAlignment`, but <xref:System.Windows.Controls.Control.HorizontalContentAlignment%2A?displayProperty=nameWithType> can be bound to <xref:System.Windows.FrameworkElement.HorizontalAlignment%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="0f295-165">在通过模板绑定属性时，请确保目标属性和源属性属于同一类型。</span><span class="sxs-lookup"><span data-stu-id="0f295-165">When you template bind a property, be sure that the target and source properties are the same type.</span></span>  
  
 <span data-ttu-id="0f295-166"><xref:System.Windows.Controls.Control>类定义控件模板必须用于起在控件上时设置的多个属性。</span><span class="sxs-lookup"><span data-stu-id="0f295-166">The <xref:System.Windows.Controls.Control> class defines several properties that must be used by the control template to have an effect on the control when they are set.</span></span> <span data-ttu-id="0f295-167">如何<xref:System.Windows.Controls.ControlTemplate>属性取决于属性的使用。</span><span class="sxs-lookup"><span data-stu-id="0f295-167">How the <xref:System.Windows.Controls.ControlTemplate> uses the property depends on the property.</span></span> <span data-ttu-id="0f295-168"><xref:System.Windows.Controls.ControlTemplate>必须通过以下方式之一使用属性：</span><span class="sxs-lookup"><span data-stu-id="0f295-168">The <xref:System.Windows.Controls.ControlTemplate> must use the property in one of the following ways:</span></span>  
  
-   <span data-ttu-id="0f295-169">中的某个元素<xref:System.Windows.Controls.ControlTemplate>模板将绑定到属性。</span><span class="sxs-lookup"><span data-stu-id="0f295-169">An element in the <xref:System.Windows.Controls.ControlTemplate> template binds to the property.</span></span>  
  
-   <span data-ttu-id="0f295-170">中的某个元素<xref:System.Windows.Controls.ControlTemplate>从父级继承属性<xref:System.Windows.FrameworkElement>。</span><span class="sxs-lookup"><span data-stu-id="0f295-170">An element in the <xref:System.Windows.Controls.ControlTemplate> inherits the property from a parent <xref:System.Windows.FrameworkElement>.</span></span>  
  
 <span data-ttu-id="0f295-171">下表列出由从控件继承的可视属性<xref:System.Windows.Controls.Control>类。</span><span class="sxs-lookup"><span data-stu-id="0f295-171">The following table lists the visual properties inherited by a control from the <xref:System.Windows.Controls.Control> class.</span></span> <span data-ttu-id="0f295-172">它还指示控件的默认控件模板是使用继承的属性值，还是必须通过模板绑定。</span><span class="sxs-lookup"><span data-stu-id="0f295-172">It also indicates whether the default control template of a control uses the inherited property value or if it must be template bound.</span></span>  
  
|<span data-ttu-id="0f295-173">属性</span><span class="sxs-lookup"><span data-stu-id="0f295-173">Property</span></span>|<span data-ttu-id="0f295-174">使用方法</span><span class="sxs-lookup"><span data-stu-id="0f295-174">Usage method</span></span>|  
|--------------|------------------|  
|<xref:System.Windows.Controls.Control.Background%2A>|<span data-ttu-id="0f295-175">模板绑定</span><span class="sxs-lookup"><span data-stu-id="0f295-175">Template binding</span></span>|  
|<xref:System.Windows.Controls.Control.BorderThickness%2A>|<span data-ttu-id="0f295-176">模板绑定</span><span class="sxs-lookup"><span data-stu-id="0f295-176">Template binding</span></span>|  
|<xref:System.Windows.Controls.Control.BorderBrush%2A>|<span data-ttu-id="0f295-177">模板绑定</span><span class="sxs-lookup"><span data-stu-id="0f295-177">Template binding</span></span>|  
|<xref:System.Windows.Controls.Control.FontFamily%2A>|<span data-ttu-id="0f295-178">属性继承或模板绑定</span><span class="sxs-lookup"><span data-stu-id="0f295-178">Property inheritance or template binding</span></span>|  
|<xref:System.Windows.Controls.Control.FontSize%2A>|<span data-ttu-id="0f295-179">属性继承或模板绑定</span><span class="sxs-lookup"><span data-stu-id="0f295-179">Property inheritance or template binding</span></span>|  
|<xref:System.Windows.Controls.Control.FontStretch%2A>|<span data-ttu-id="0f295-180">属性继承或模板绑定</span><span class="sxs-lookup"><span data-stu-id="0f295-180">Property inheritance or template binding</span></span>|  
|<xref:System.Windows.Controls.Control.FontWeight%2A>|<span data-ttu-id="0f295-181">属性继承或模板绑定</span><span class="sxs-lookup"><span data-stu-id="0f295-181">Property inheritance or template binding</span></span>|  
|<xref:System.Windows.Controls.Control.Foreground%2A>|<span data-ttu-id="0f295-182">属性继承或模板绑定</span><span class="sxs-lookup"><span data-stu-id="0f295-182">Property inheritance or template binding</span></span>|  
|<xref:System.Windows.Controls.Control.HorizontalContentAlignment%2A>|<span data-ttu-id="0f295-183">模板绑定</span><span class="sxs-lookup"><span data-stu-id="0f295-183">Template binding</span></span>|  
|<xref:System.Windows.Controls.Control.Padding%2A>|<span data-ttu-id="0f295-184">模板绑定</span><span class="sxs-lookup"><span data-stu-id="0f295-184">Template binding</span></span>|  
|<xref:System.Windows.Controls.Control.VerticalContentAlignment%2A>|<span data-ttu-id="0f295-185">模板绑定</span><span class="sxs-lookup"><span data-stu-id="0f295-185">Template binding</span></span>|  
  
 <span data-ttu-id="0f295-186">表列出了仅从继承的可视属性<xref:System.Windows.Controls.Control>类。</span><span class="sxs-lookup"><span data-stu-id="0f295-186">The table lists only the visual properties inherited from the <xref:System.Windows.Controls.Control> class.</span></span> <span data-ttu-id="0f295-187">除了表中列出的属性，该控件还可能继承<xref:System.Windows.FrameworkElement.DataContext%2A>， <xref:System.Windows.FrameworkElement.Language%2A>，和<xref:System.Windows.Controls.TextBlock.TextDecorations%2A>从父框架元素的属性。</span><span class="sxs-lookup"><span data-stu-id="0f295-187">Apart from the properties listed in the table, a control may also inherit the <xref:System.Windows.FrameworkElement.DataContext%2A>, <xref:System.Windows.FrameworkElement.Language%2A>, and <xref:System.Windows.Controls.TextBlock.TextDecorations%2A> properties from the parent framework element.</span></span>  
  
 <span data-ttu-id="0f295-188">此外，如果<xref:System.Windows.Controls.ContentPresenter>处于<xref:System.Windows.Controls.ControlTemplate>的<xref:System.Windows.Controls.ContentControl>、<xref:System.Windows.Controls.ContentPresenter>将自动绑定到<xref:System.Windows.Controls.ContentControl.ContentTemplate%2A>和<xref:System.Windows.Controls.ContentControl.Content%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="0f295-188">Also, if the <xref:System.Windows.Controls.ContentPresenter> is in the <xref:System.Windows.Controls.ControlTemplate> of a <xref:System.Windows.Controls.ContentControl>, the <xref:System.Windows.Controls.ContentPresenter> will automatically bind to the <xref:System.Windows.Controls.ContentControl.ContentTemplate%2A> and <xref:System.Windows.Controls.ContentControl.Content%2A> properties.</span></span> <span data-ttu-id="0f295-189">同样， <xref:System.Windows.Controls.ItemsPresenter> ，位于<xref:System.Windows.Controls.ControlTemplate>的<xref:System.Windows.Controls.ItemsControl>将自动绑定到<xref:System.Windows.Controls.ItemsControl.Items%2A>和<xref:System.Windows.Controls.ItemsPresenter>属性。</span><span class="sxs-lookup"><span data-stu-id="0f295-189">Likewise, an <xref:System.Windows.Controls.ItemsPresenter> that is in the <xref:System.Windows.Controls.ControlTemplate> of an <xref:System.Windows.Controls.ItemsControl> will automatically bind to the <xref:System.Windows.Controls.ItemsControl.Items%2A> and <xref:System.Windows.Controls.ItemsPresenter> properties.</span></span>  
  
 <span data-ttu-id="0f295-190">下面的示例创建使用的两个按钮<xref:System.Windows.Controls.ControlTemplate>在前面的示例中定义。</span><span class="sxs-lookup"><span data-stu-id="0f295-190">The following example creates two buttons that use the <xref:System.Windows.Controls.ControlTemplate> defined in the preceding example.</span></span> <span data-ttu-id="0f295-191">该示例设置<xref:System.Windows.Controls.Control.Background%2A>， <xref:System.Windows.Controls.Control.Foreground%2A>，和<xref:System.Windows.Controls.Control.FontSize%2A>每个按钮上的属性。</span><span class="sxs-lookup"><span data-stu-id="0f295-191">The example sets the <xref:System.Windows.Controls.Control.Background%2A>, <xref:System.Windows.Controls.Control.Foreground%2A>, and <xref:System.Windows.Controls.Control.FontSize%2A> properties on each button.</span></span> <span data-ttu-id="0f295-192">设置<xref:System.Windows.Controls.Control.Background%2A>属性才有效，因为它是在绑定的模板<xref:System.Windows.Controls.ControlTemplate>。</span><span class="sxs-lookup"><span data-stu-id="0f295-192">Setting the <xref:System.Windows.Controls.Control.Background%2A> property has an effect because it is template bound in the <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="0f295-193">即使<xref:System.Windows.Controls.Control.Foreground%2A>和<xref:System.Windows.Controls.Control.FontSize%2A>属性不是绑定的模板，设置它们起作用，因为其值将继承。</span><span class="sxs-lookup"><span data-stu-id="0f295-193">Even though the <xref:System.Windows.Controls.Control.Foreground%2A> and <xref:System.Windows.Controls.Control.FontSize%2A> properties are not template bound, setting them has an effect because their values are inherited.</span></span>  
  
 [!code-xaml[VSMButtonTemplate#ButtonDeclaration](../../../../samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/buttonstages.xaml#buttondeclaration)]  
  
 <span data-ttu-id="0f295-194">前面的示例生成类似于下图的输出。</span><span class="sxs-lookup"><span data-stu-id="0f295-194">The preceding example produces output that is similar to the following illustration.</span></span>  
  
 <span data-ttu-id="0f295-195">![两个按钮，其中一个蓝色和一个紫色。] (../../../../docs/framework/wpf/controls/media/ndp-buttontwo.png "NDP_ButtonTwo")</span><span class="sxs-lookup"><span data-stu-id="0f295-195">![Two buttons, one blue and one purple.](../../../../docs/framework/wpf/controls/media/ndp-buttontwo.png "NDP_ButtonTwo")</span></span>  
<span data-ttu-id="0f295-196">背景色不同的两个按钮</span><span class="sxs-lookup"><span data-stu-id="0f295-196">Two buttons with different background colors</span></span>  
  
<a name="changing_the_appearance_of_a_control_depending_on_its_state"></a>   
## <a name="changing-the-appearance-of-a-control-depending-on-its-state"></a><span data-ttu-id="0f295-197">根据控件状态更改它的外观</span><span class="sxs-lookup"><span data-stu-id="0f295-197">Changing the Appearance of a Control Depending on Its State</span></span>  
 <span data-ttu-id="0f295-198">显示默认外观的按钮与前面示例中按钮的差异在于，默认按钮在处于不同状态时会略有变化。</span><span class="sxs-lookup"><span data-stu-id="0f295-198">The difference between a button with its default appearance and the button in the preceding example is that the default button subtly changes when it is in different states.</span></span> <span data-ttu-id="0f295-199">例如，在按下按钮或鼠标指针悬停在它的上方时，默认按钮的外观将发生变化。</span><span class="sxs-lookup"><span data-stu-id="0f295-199">For example, the default button's appearance changes when the button is pressed, or when the mouse pointer is over the button.</span></span> <span data-ttu-id="0f295-200">尽管<xref:System.Windows.Controls.ControlTemplate>不更改的功能的控件，它会更改控件的可视行为。</span><span class="sxs-lookup"><span data-stu-id="0f295-200">Although the <xref:System.Windows.Controls.ControlTemplate> does not change the functionality of a control, it does change the control's visual behavior.</span></span> <span data-ttu-id="0f295-201">可视行为描述控件处于某种状态下的外观。</span><span class="sxs-lookup"><span data-stu-id="0f295-201">A visual behavior describes the control appearance when it is in a certain state.</span></span> <span data-ttu-id="0f295-202">若要了解控件功能和可视行为之间的差异，请考虑按钮示例。</span><span class="sxs-lookup"><span data-stu-id="0f295-202">To understand the difference between the functionality and visual behavior of a control, consider the button example.</span></span> <span data-ttu-id="0f295-203">按钮的功能是引发<xref:System.Windows.Controls.Primitives.ButtonBase.Click>事件时单击它，但按钮的 visual 行为是在指向或按下时更改其外观。</span><span class="sxs-lookup"><span data-stu-id="0f295-203">The button's functionality is to raise the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event when it is clicked, but the button's visual behavior is to change its appearance when it is pointed to or pressed.</span></span>  
  
 <span data-ttu-id="0f295-204">你使用<xref:System.Windows.VisualState>对象来指定控件的外观，当它处于某个特定状态时。</span><span class="sxs-lookup"><span data-stu-id="0f295-204">You use <xref:System.Windows.VisualState> objects to specify the appearance of a control when it is in a certain state.</span></span> <span data-ttu-id="0f295-205">A<xref:System.Windows.VisualState>包含<xref:System.Windows.Media.Animation.Storyboard>更改中的元素的外观<xref:System.Windows.Controls.ControlTemplate>。</span><span class="sxs-lookup"><span data-stu-id="0f295-205">A <xref:System.Windows.VisualState> contains a <xref:System.Windows.Media.Animation.Storyboard> that changes the appearance of the elements that are in the <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="0f295-206">无需编写任何代码，以使这种情况，因为控件的逻辑状态更改通过使用<xref:System.Windows.VisualStateManager>。</span><span class="sxs-lookup"><span data-stu-id="0f295-206">You do not have to write any code to make this occur because the control's logic changes state by using the <xref:System.Windows.VisualStateManager>.</span></span> <span data-ttu-id="0f295-207">当控制权交给由指定的状态<xref:System.Windows.VisualState.Name%2A?displayProperty=nameWithType>属性，<xref:System.Windows.Media.Animation.Storyboard>开始。</span><span class="sxs-lookup"><span data-stu-id="0f295-207">When the control enters the state that is specified by the <xref:System.Windows.VisualState.Name%2A?displayProperty=nameWithType> property, the <xref:System.Windows.Media.Animation.Storyboard> begins.</span></span> <span data-ttu-id="0f295-208">当控件退出状态，<xref:System.Windows.Media.Animation.Storyboard>停止。</span><span class="sxs-lookup"><span data-stu-id="0f295-208">When the control exits the state, the <xref:System.Windows.Media.Animation.Storyboard> stops.</span></span>  
  
 <span data-ttu-id="0f295-209">下面的示例演示<xref:System.Windows.VisualState>更改的外观<xref:System.Windows.Controls.Button>当鼠标指针位于它。</span><span class="sxs-lookup"><span data-stu-id="0f295-209">The following example shows the <xref:System.Windows.VisualState> that changes the appearance of a <xref:System.Windows.Controls.Button> when the mouse pointer is over it.</span></span> <span data-ttu-id="0f295-210"><xref:System.Windows.Media.Animation.Storyboard>通过颜色的更改来更改按钮的边框颜色`BorderBrush`。</span><span class="sxs-lookup"><span data-stu-id="0f295-210">The <xref:System.Windows.Media.Animation.Storyboard> changes the button's border color by changing the color of the `BorderBrush`.</span></span> <span data-ttu-id="0f295-211">如果您参考<xref:System.Windows.Controls.ControlTemplate>示例在本主题开始时，你会记得`BorderBrush`是的名称<xref:System.Windows.Media.SolidColorBrush>，分配给<xref:System.Windows.Controls.Border.Background%2A>的<xref:System.Windows.Controls.Border>。</span><span class="sxs-lookup"><span data-stu-id="0f295-211">If you refer to the <xref:System.Windows.Controls.ControlTemplate> example at the beginning of this topic, you will recall that `BorderBrush` is the name of the <xref:System.Windows.Media.SolidColorBrush> that is assigned to the <xref:System.Windows.Controls.Border.Background%2A> of the <xref:System.Windows.Controls.Border>.</span></span>  
  
 [!code-xaml[VSMButtonTemplate#4](../../../../samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/skinnedbutton.xaml#4)]  
  
 <span data-ttu-id="0f295-212">该控件负责将各种状态定义为控件协定的一部分，这将在本主题后面的[通过了解控件协定自定义其他控件](#customizing_other_controls_by_understanding_the_control_contract)中进行详细讨论。</span><span class="sxs-lookup"><span data-stu-id="0f295-212">The control is responsible for defining the states as part of its control contract, which is discussed in detail in [Customizing Other Controls by Understanding the Control Contract](#customizing_other_controls_by_understanding_the_control_contract) later in this topic.</span></span> <span data-ttu-id="0f295-213">下表列出了为指定的状态<xref:System.Windows.Controls.Button>。</span><span class="sxs-lookup"><span data-stu-id="0f295-213">The following table lists the states that are specified for the <xref:System.Windows.Controls.Button>.</span></span>  
  
|<span data-ttu-id="0f295-214">VisualState 名称</span><span class="sxs-lookup"><span data-stu-id="0f295-214">VisualState Name</span></span>|<span data-ttu-id="0f295-215">VisualStateGroup 名称</span><span class="sxs-lookup"><span data-stu-id="0f295-215">VisualStateGroup Name</span></span>|<span data-ttu-id="0f295-216">描述</span><span class="sxs-lookup"><span data-stu-id="0f295-216">Description</span></span>|  
|----------------------|---------------------------|-----------------|  
|<span data-ttu-id="0f295-217">普通</span><span class="sxs-lookup"><span data-stu-id="0f295-217">Normal</span></span>|<span data-ttu-id="0f295-218">CommonStates</span><span class="sxs-lookup"><span data-stu-id="0f295-218">CommonStates</span></span>|<span data-ttu-id="0f295-219">默认状态。</span><span class="sxs-lookup"><span data-stu-id="0f295-219">The default state.</span></span>|  
|<span data-ttu-id="0f295-220">MouseOver</span><span class="sxs-lookup"><span data-stu-id="0f295-220">MouseOver</span></span>|<span data-ttu-id="0f295-221">CommonStates</span><span class="sxs-lookup"><span data-stu-id="0f295-221">CommonStates</span></span>|<span data-ttu-id="0f295-222">鼠标指针悬停在控件上方。</span><span class="sxs-lookup"><span data-stu-id="0f295-222">The mouse pointer is positioned over the control.</span></span>|  
|<span data-ttu-id="0f295-223">已按下</span><span class="sxs-lookup"><span data-stu-id="0f295-223">Pressed</span></span>|<span data-ttu-id="0f295-224">CommonStates</span><span class="sxs-lookup"><span data-stu-id="0f295-224">CommonStates</span></span>|<span data-ttu-id="0f295-225">已按下控件。</span><span class="sxs-lookup"><span data-stu-id="0f295-225">The control is pressed.</span></span>|  
|<span data-ttu-id="0f295-226">已禁用</span><span class="sxs-lookup"><span data-stu-id="0f295-226">Disabled</span></span>|<span data-ttu-id="0f295-227">CommonStates</span><span class="sxs-lookup"><span data-stu-id="0f295-227">CommonStates</span></span>|<span data-ttu-id="0f295-228">已禁用控件。</span><span class="sxs-lookup"><span data-stu-id="0f295-228">The control is disabled.</span></span>|  
|<span data-ttu-id="0f295-229">已设定焦点</span><span class="sxs-lookup"><span data-stu-id="0f295-229">Focused</span></span>|<span data-ttu-id="0f295-230">FocusStates</span><span class="sxs-lookup"><span data-stu-id="0f295-230">FocusStates</span></span>|<span data-ttu-id="0f295-231">控件有焦点。</span><span class="sxs-lookup"><span data-stu-id="0f295-231">The control has focus.</span></span>|  
|<span data-ttu-id="0f295-232">失去焦点</span><span class="sxs-lookup"><span data-stu-id="0f295-232">Unfocused</span></span>|<span data-ttu-id="0f295-233">FocusStates</span><span class="sxs-lookup"><span data-stu-id="0f295-233">FocusStates</span></span>|<span data-ttu-id="0f295-234">控件没有焦点。</span><span class="sxs-lookup"><span data-stu-id="0f295-234">The control does not have focus.</span></span>|  
  
 <span data-ttu-id="0f295-235"><xref:System.Windows.Controls.Button>定义两个状态组：`CommonStates`组包含`Normal`， `MouseOver`， `Pressed`，和`Disabled`状态。</span><span class="sxs-lookup"><span data-stu-id="0f295-235">The <xref:System.Windows.Controls.Button> defines two state groups: the `CommonStates` group contains the `Normal`, `MouseOver`, `Pressed`, and `Disabled` states.</span></span> <span data-ttu-id="0f295-236">`FocusStates` 组包含 `Focused` 和 `Unfocused` 状态。</span><span class="sxs-lookup"><span data-stu-id="0f295-236">The `FocusStates` group contains the `Focused` and `Unfocused` states.</span></span> <span data-ttu-id="0f295-237">同一状态组中的状态之间相互排斥。</span><span class="sxs-lookup"><span data-stu-id="0f295-237">States in the same state group are mutually exclusive.</span></span> <span data-ttu-id="0f295-238">控件在每个组中始终处于一种状态下。</span><span class="sxs-lookup"><span data-stu-id="0f295-238">The control is always in exactly one state per group.</span></span> <span data-ttu-id="0f295-239">例如，<xref:System.Windows.Controls.Button>可有焦点，鼠标指针不是通过它，因此即使<xref:System.Windows.Controls.Button>中`Focused`状态可以是在`MouseOver`， `Pressed`，或`Normal`状态。</span><span class="sxs-lookup"><span data-stu-id="0f295-239">For example, a <xref:System.Windows.Controls.Button> can have focus even when the mouse pointer is not over it, so a <xref:System.Windows.Controls.Button> in the `Focused` state can be in the `MouseOver`, `Pressed`, or `Normal` state.</span></span>  
  
 <span data-ttu-id="0f295-240">你添加<xref:System.Windows.VisualState>对象添加到<xref:System.Windows.VisualStateGroup>对象。</span><span class="sxs-lookup"><span data-stu-id="0f295-240">You add <xref:System.Windows.VisualState> objects to <xref:System.Windows.VisualStateGroup> objects.</span></span> <span data-ttu-id="0f295-241">你添加<xref:System.Windows.VisualStateGroup>对象添加到<xref:System.Windows.VisualStateManager.VisualStateGroups%2A?displayProperty=nameWithType>附加属性。</span><span class="sxs-lookup"><span data-stu-id="0f295-241">You add <xref:System.Windows.VisualStateGroup> objects to the <xref:System.Windows.VisualStateManager.VisualStateGroups%2A?displayProperty=nameWithType> attached property.</span></span> <span data-ttu-id="0f295-242">下面的示例定义<xref:System.Windows.VisualState>对象`Normal`， `MouseOver`，和`Pressed`状态，全部位于`CommonStates`组。</span><span class="sxs-lookup"><span data-stu-id="0f295-242">The following example defines the <xref:System.Windows.VisualState> objects for the `Normal`, `MouseOver`, and `Pressed` states, which are all in the `CommonStates` group.</span></span> <span data-ttu-id="0f295-243"><xref:System.Windows.VisualState.Name%2A>每个<xref:System.Windows.VisualState>与上表中的名称匹配。</span><span class="sxs-lookup"><span data-stu-id="0f295-243">The <xref:System.Windows.VisualState.Name%2A> of each <xref:System.Windows.VisualState> matches the name in the preceding table.</span></span> <span data-ttu-id="0f295-244">省略 `Disabled` 状态和 `FocusStates` 组中的各种状态是为了使示例保持简短，但本主题末尾的完整示例将它们包括在内。</span><span class="sxs-lookup"><span data-stu-id="0f295-244">The `Disabled` state and the states in the `FocusStates` group are omitted to keep the example short, but they are included in the entire example at the end of this topic.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="0f295-245">请务必设置<xref:System.Windows.VisualStateManager.VisualStateGroups%2A?displayProperty=nameWithType>附加属性的根上<xref:System.Windows.FrameworkElement>的<xref:System.Windows.Controls.ControlTemplate>。</span><span class="sxs-lookup"><span data-stu-id="0f295-245">Be sure to set the <xref:System.Windows.VisualStateManager.VisualStateGroups%2A?displayProperty=nameWithType> attached property on the root <xref:System.Windows.FrameworkElement> of the <xref:System.Windows.Controls.ControlTemplate>.</span></span>  
  
 [!code-xaml[VSMButtonTemplate#VisualStates](../../../../samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/buttonstages.xaml#visualstates)]  
  
 <span data-ttu-id="0f295-246">前面的示例生成类似于下图的输出。</span><span class="sxs-lookup"><span data-stu-id="0f295-246">The preceding example produces output that is similar to the following illustrations.</span></span>  
  
 <span data-ttu-id="0f295-247">![一个具有自定义控件模板按钮。] (../../../../docs/framework/wpf/controls/media/ndp-buttonnormal.png "NDP_ButtonNormal")</span><span class="sxs-lookup"><span data-stu-id="0f295-247">![A button with a custom control template.](../../../../docs/framework/wpf/controls/media/ndp-buttonnormal.png "NDP_ButtonNormal")</span></span>  
<span data-ttu-id="0f295-248">使用正常状态下的自定义控件模板的按钮</span><span class="sxs-lookup"><span data-stu-id="0f295-248">A button that uses a custom control template in the normal state</span></span>  
  
 <span data-ttu-id="0f295-249">![一个具有红色边框按钮。] (../../../../docs/framework/wpf/controls/media/ndp-buttonmouseover.png "NDP_ButtonMouseOver")</span><span class="sxs-lookup"><span data-stu-id="0f295-249">![A button with a red border.](../../../../docs/framework/wpf/controls/media/ndp-buttonmouseover.png "NDP_ButtonMouseOver")</span></span>  
<span data-ttu-id="0f295-250">使用鼠标悬停状态下的自定义控件模板的按钮</span><span class="sxs-lookup"><span data-stu-id="0f295-250">A button that uses a custom control template in the mouse over state</span></span>  
  
 <span data-ttu-id="0f295-251">![边框是透明上按下的按钮。] (../../../../docs/framework/wpf/controls/media/ndp-buttonpressed.png "NDP_ButtonPressed")</span><span class="sxs-lookup"><span data-stu-id="0f295-251">![The border is transparent on a pressed button.](../../../../docs/framework/wpf/controls/media/ndp-buttonpressed.png "NDP_ButtonPressed")</span></span>  
<span data-ttu-id="0f295-252">使用按下状态下的自定义控件模板的按钮</span><span class="sxs-lookup"><span data-stu-id="0f295-252">A button that uses a custom control template in the pressed state</span></span>  
  
 <span data-ttu-id="0f295-253">若要查找附带在 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 中的控件的可视状态，请参阅 [Control 样式和模板](../../../../docs/framework/wpf/controls/control-styles-and-templates.md)。</span><span class="sxs-lookup"><span data-stu-id="0f295-253">To find the visual states for controls that are included with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Control Styles and Templates](../../../../docs/framework/wpf/controls/control-styles-and-templates.md).</span></span>  
  
<a name="specifying_the_behavior_of_a_control_when_it_transitions_between_states"></a>   
## <a name="specifying-the-behavior-of-a-control-when-it-transitions-between-states"></a><span data-ttu-id="0f295-254">指定控件在状态之间转换时的行为</span><span class="sxs-lookup"><span data-stu-id="0f295-254">Specifying the Behavior of a Control When It Transitions Between States</span></span>  
 <span data-ttu-id="0f295-255">在前面的示例中，按钮的外观在用户单击它时也会发生更改，但除非按钮按下整整一秒，否则用户将看不到效果。</span><span class="sxs-lookup"><span data-stu-id="0f295-255">In the preceding example, the appearance of the button also changes when the user clicks it, but unless the button is pressed for a full second, the user does not see the effect.</span></span> <span data-ttu-id="0f295-256">默认情况下，动画需要一秒才会发生。</span><span class="sxs-lookup"><span data-stu-id="0f295-256">By default, the animation takes one second to occur.</span></span> <span data-ttu-id="0f295-257">因为用户可能会单击，并在非常少的时间中释放一个按钮，可视反馈将不会生效，如果你离开<xref:System.Windows.Controls.ControlTemplate>在其默认状态。</span><span class="sxs-lookup"><span data-stu-id="0f295-257">Because users are likely to click and release a button in much less time, the visual feedback will not be effective if you leave the <xref:System.Windows.Controls.ControlTemplate> in its default state.</span></span>  
  
 <span data-ttu-id="0f295-258">你可以指定动画才能平稳转换从一个状态到另一个控件，通过添加所需的时间量<xref:System.Windows.VisualTransition>对象添加到<xref:System.Windows.Controls.ControlTemplate>。</span><span class="sxs-lookup"><span data-stu-id="0f295-258">You can specify the amount of time that it takes an animation to occur to smoothly transition a control from one state to another by adding <xref:System.Windows.VisualTransition> objects to the <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="0f295-259">当你创建<xref:System.Windows.VisualTransition>，你指定一个或多个以下：</span><span class="sxs-lookup"><span data-stu-id="0f295-259">When you create a <xref:System.Windows.VisualTransition>, you specify one or more of the following:</span></span>  
  
-   <span data-ttu-id="0f295-260">在状态之间进行转换所需的时间。</span><span class="sxs-lookup"><span data-stu-id="0f295-260">The time it takes for a transition between states to occur.</span></span>  
  
-   <span data-ttu-id="0f295-261">在转换的同时，控件外观发生的其他更改。</span><span class="sxs-lookup"><span data-stu-id="0f295-261">Additional changes in the control's appearance that occur at the time of the transition.</span></span>  
  
-   <span data-ttu-id="0f295-262">哪些状态<xref:System.Windows.VisualTransition>应用于。</span><span class="sxs-lookup"><span data-stu-id="0f295-262">Which states the <xref:System.Windows.VisualTransition> is applied to.</span></span>  
  
### <a name="specifying-the-duration-of-a-transition"></a><span data-ttu-id="0f295-263">指定转换的持续时间</span><span class="sxs-lookup"><span data-stu-id="0f295-263">Specifying the Duration of a Transition</span></span>  
 <span data-ttu-id="0f295-264">你可以指定转换的时间通过设置<xref:System.Windows.VisualTransition.GeneratedDuration%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="0f295-264">You can specify how long a transition takes by setting the <xref:System.Windows.VisualTransition.GeneratedDuration%2A> property.</span></span> <span data-ttu-id="0f295-265">前面的示例中具有<xref:System.Windows.VisualState>，它指定当按下了按钮，但动画花很长时间会明显，如果按钮快速按下并释放时按钮的边框将变为透明。</span><span class="sxs-lookup"><span data-stu-id="0f295-265">The preceding example has a <xref:System.Windows.VisualState> that specifies that the button's border becomes transparent when the button is pressed, but the animation takes too long to be noticeable if the button is quickly pressed and released.</span></span> <span data-ttu-id="0f295-266">你可以使用<xref:System.Windows.VisualTransition>指定的时间量它将控件转换为按下状态。</span><span class="sxs-lookup"><span data-stu-id="0f295-266">You can use a <xref:System.Windows.VisualTransition> to specify the amount of time it takes the control to transition into the pressed state.</span></span> <span data-ttu-id="0f295-267">以下示例指定控件需要百分之一秒进入按下状态。</span><span class="sxs-lookup"><span data-stu-id="0f295-267">The following example specifies that the control takes one hundredth of a second to go into the pressed state.</span></span>  
  
 [!code-xaml[VSMButtonTemplate#PressedTransition](../../../../samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/skinnedbutton.xaml#pressedtransition)]  
  
### <a name="specifying-changes-to-the-controls-appearance-during-a-transition"></a><span data-ttu-id="0f295-268">指定转换时控件外观发生的更改</span><span class="sxs-lookup"><span data-stu-id="0f295-268">Specifying Changes to the Control's Appearance During a Transition</span></span>  
 <span data-ttu-id="0f295-269"><xref:System.Windows.VisualTransition>包含<xref:System.Windows.Media.Animation.Storyboard>开头控件状态之间进行转换时。</span><span class="sxs-lookup"><span data-stu-id="0f295-269">The <xref:System.Windows.VisualTransition> contains a <xref:System.Windows.Media.Animation.Storyboard> that begins when the control transitions between states.</span></span> <span data-ttu-id="0f295-270">例如，可以指定控件从 `MouseOver` 状态转换到 `Normal` 状态时发生的某个动画。</span><span class="sxs-lookup"><span data-stu-id="0f295-270">For example, you can specify that a certain animation occurs when the control transitions from the `MouseOver` state to the `Normal` State.</span></span> <span data-ttu-id="0f295-271">下面的示例创建<xref:System.Windows.VisualTransition>，它指定，当用户移动鼠标指针离开按钮，该按钮的边框更改为蓝色，则变为黄色，则为黑色以 1.5 秒为单位。</span><span class="sxs-lookup"><span data-stu-id="0f295-271">The following example creates a <xref:System.Windows.VisualTransition> that specifies that when the user moves the mouse pointer away from the button, the button's border changes to blue, then to yellow, then to black in 1.5 seconds.</span></span>  
  
 [!code-xaml[VSMButtonTemplate#8](../../../../samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/skinnedbutton.xaml#8)]  
  
### <a name="specifying-when-a-visualtransition-is-applied"></a><span data-ttu-id="0f295-272">指定何时应用 VisualTransition</span><span class="sxs-lookup"><span data-stu-id="0f295-272">Specifying When a VisualTransition Is Applied</span></span>  
 <span data-ttu-id="0f295-273">A<xref:System.Windows.VisualTransition>可能会受到限制，将应用于仅某些状态，或它可以应用任何时候，只要状态之间的控制转换。</span><span class="sxs-lookup"><span data-stu-id="0f295-273">A <xref:System.Windows.VisualTransition> can be restricted to apply to only certain states, or it can be applied any time the control transitions between states.</span></span> <span data-ttu-id="0f295-274">在前面的示例中，<xref:System.Windows.VisualTransition>当控件从应用`MouseOver`状态`Normal`状态; 在此之前，该示例中<xref:System.Windows.VisualTransition>控件将进入时，将应用`Pressed`状态。</span><span class="sxs-lookup"><span data-stu-id="0f295-274">In the preceding example, the <xref:System.Windows.VisualTransition> is applied when the control goes from the `MouseOver` state to the `Normal` state; in the example before that, the <xref:System.Windows.VisualTransition> is applied when the control goes into the `Pressed` state.</span></span> <span data-ttu-id="0f295-275">限制时<xref:System.Windows.VisualTransition>通过设置应用<xref:System.Windows.VisualTransition.To%2A>和<xref:System.Windows.VisualTransition.From%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="0f295-275">You restrict when a <xref:System.Windows.VisualTransition> is applied by setting the <xref:System.Windows.VisualTransition.To%2A> and <xref:System.Windows.VisualTransition.From%2A> properties.</span></span> <span data-ttu-id="0f295-276">下表描述了从最严限制到最宽松限制的限制级别。</span><span class="sxs-lookup"><span data-stu-id="0f295-276">The following table describes the levels of restriction from most restrictive to least restrictive.</span></span>  
  
|<span data-ttu-id="0f295-277">限制类型</span><span class="sxs-lookup"><span data-stu-id="0f295-277">Type of restriction</span></span>|<span data-ttu-id="0f295-278">起始值</span><span class="sxs-lookup"><span data-stu-id="0f295-278">Value of From</span></span>|<span data-ttu-id="0f295-279">目标值</span><span class="sxs-lookup"><span data-stu-id="0f295-279">Value of To</span></span>|  
|-------------------------|-------------------|-----------------|  
|<span data-ttu-id="0f295-280">从一个指定状态到另一个指定状态</span><span class="sxs-lookup"><span data-stu-id="0f295-280">From a specified state to another specified state</span></span>|<span data-ttu-id="0f295-281">名称<xref:System.Windows.VisualState></span><span class="sxs-lookup"><span data-stu-id="0f295-281">The name of a <xref:System.Windows.VisualState></span></span>|<span data-ttu-id="0f295-282">名称<xref:System.Windows.VisualState></span><span class="sxs-lookup"><span data-stu-id="0f295-282">The name of a <xref:System.Windows.VisualState></span></span>|  
|<span data-ttu-id="0f295-283">从任意状态到指定状态</span><span class="sxs-lookup"><span data-stu-id="0f295-283">From any state to a specified state</span></span>|<span data-ttu-id="0f295-284">未设置</span><span class="sxs-lookup"><span data-stu-id="0f295-284">Not set</span></span>|<span data-ttu-id="0f295-285">名称<xref:System.Windows.VisualState></span><span class="sxs-lookup"><span data-stu-id="0f295-285">The name of a <xref:System.Windows.VisualState></span></span>|  
|<span data-ttu-id="0f295-286">从指定状态到任意状态</span><span class="sxs-lookup"><span data-stu-id="0f295-286">From a specified state to any state</span></span>|<span data-ttu-id="0f295-287">名称<xref:System.Windows.VisualState></span><span class="sxs-lookup"><span data-stu-id="0f295-287">The name of a <xref:System.Windows.VisualState></span></span>|<span data-ttu-id="0f295-288">未设置</span><span class="sxs-lookup"><span data-stu-id="0f295-288">Not set</span></span>|  
|<span data-ttu-id="0f295-289">从任意状态到其他任意状态</span><span class="sxs-lookup"><span data-stu-id="0f295-289">From any state to any other state</span></span>|<span data-ttu-id="0f295-290">未设置</span><span class="sxs-lookup"><span data-stu-id="0f295-290">Not set</span></span>|<span data-ttu-id="0f295-291">未设置</span><span class="sxs-lookup"><span data-stu-id="0f295-291">Not set</span></span>|  
  
 <span data-ttu-id="0f295-292">你可以有多个<xref:System.Windows.VisualTransition>中的对象<xref:System.Windows.VisualStateGroup>该公式引用相同的状态，但它们会使用上表指定的顺序。</span><span class="sxs-lookup"><span data-stu-id="0f295-292">You can have multiple <xref:System.Windows.VisualTransition> objects in a <xref:System.Windows.VisualStateGroup> that refer to the same state, but they will be used in the order that the previous table specifies.</span></span> <span data-ttu-id="0f295-293">在下面的示例中，有两个<xref:System.Windows.VisualTransition>对象。</span><span class="sxs-lookup"><span data-stu-id="0f295-293">In the following example, there are two <xref:System.Windows.VisualTransition> objects.</span></span> <span data-ttu-id="0f295-294">当控件转换从`Pressed`状态`MouseOver`状态，<xref:System.Windows.VisualTransition>同时具有<xref:System.Windows.VisualTransition.From%2A>和<xref:System.Windows.VisualTransition.To%2A>设置，则使用。</span><span class="sxs-lookup"><span data-stu-id="0f295-294">When the control transitions from the `Pressed` state to the `MouseOver` state, the <xref:System.Windows.VisualTransition> that has both <xref:System.Windows.VisualTransition.From%2A> and <xref:System.Windows.VisualTransition.To%2A> set is used.</span></span> <span data-ttu-id="0f295-295">当控件从非 `Pressed` 的状态转换为 `MouseOver` 状态时，将使用另一种状态。</span><span class="sxs-lookup"><span data-stu-id="0f295-295">When the control transitions from a state that is not `Pressed` to the `MouseOver` state, the other state is used.</span></span>  
  
 [!code-xaml[VSMButtonTemplate#7](../../../../samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/skinnedbutton.xaml#7)]  
  
 <span data-ttu-id="0f295-296"><xref:System.Windows.VisualStateGroup>具有<xref:System.Windows.VisualStateGroup.Transitions%2A>属性，它包含<xref:System.Windows.VisualTransition>对象应用于<xref:System.Windows.VisualState>中的对象<xref:System.Windows.VisualStateGroup>。</span><span class="sxs-lookup"><span data-stu-id="0f295-296">The <xref:System.Windows.VisualStateGroup> has a <xref:System.Windows.VisualStateGroup.Transitions%2A> property that contains the <xref:System.Windows.VisualTransition> objects that apply to the <xref:System.Windows.VisualState> objects in the <xref:System.Windows.VisualStateGroup>.</span></span> <span data-ttu-id="0f295-297">作为<xref:System.Windows.Controls.ControlTemplate>作者，你可以自由地包括任何<xref:System.Windows.VisualTransition>所需。</span><span class="sxs-lookup"><span data-stu-id="0f295-297">As the <xref:System.Windows.Controls.ControlTemplate> author, you are free to include any <xref:System.Windows.VisualTransition> you want.</span></span> <span data-ttu-id="0f295-298">但是，如果<xref:System.Windows.VisualTransition.To%2A>和<xref:System.Windows.VisualTransition.From%2A>属性设置为不在的状态名称<xref:System.Windows.VisualStateGroup>、<xref:System.Windows.VisualTransition>将被忽略。</span><span class="sxs-lookup"><span data-stu-id="0f295-298">However, if the <xref:System.Windows.VisualTransition.To%2A> and <xref:System.Windows.VisualTransition.From%2A> properties are set to state names that are not in the <xref:System.Windows.VisualStateGroup>, the <xref:System.Windows.VisualTransition> is ignored.</span></span>  
  
 <span data-ttu-id="0f295-299">下面的示例演示<xref:System.Windows.VisualStateGroup>为`CommonStates`。</span><span class="sxs-lookup"><span data-stu-id="0f295-299">The following example shows the <xref:System.Windows.VisualStateGroup> for the `CommonStates`.</span></span> <span data-ttu-id="0f295-300">该示例定义了<xref:System.Windows.VisualTransition>为每个按钮的以下转换。</span><span class="sxs-lookup"><span data-stu-id="0f295-300">The example defines a <xref:System.Windows.VisualTransition> for each of the button's following transitions.</span></span>  
  
-   <span data-ttu-id="0f295-301">转换为 `Pressed` 状态。</span><span class="sxs-lookup"><span data-stu-id="0f295-301">To the `Pressed` state.</span></span>  
  
-   <span data-ttu-id="0f295-302">转换为 `MouseOver` 状态。</span><span class="sxs-lookup"><span data-stu-id="0f295-302">To the `MouseOver` state.</span></span>  
  
-   <span data-ttu-id="0f295-303">从 `Pressed` 状态转换为 `MouseOver` 状态。</span><span class="sxs-lookup"><span data-stu-id="0f295-303">From the `Pressed` state to the `MouseOver` state.</span></span>  
  
-   <span data-ttu-id="0f295-304">从 `MouseOver` 状态转换为 `Normal` 状态。</span><span class="sxs-lookup"><span data-stu-id="0f295-304">From the `MouseOver` state to the `Normal` state.</span></span>  
  
 [!code-xaml[VSMButtonTemplate#VisualTransitions](../../../../samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/buttonstages.xaml#visualtransitions)]  
  
<a name="customizing_other_controls_by_understanding_the_control_contract"></a>   
## <a name="customizing-other-controls-by-understanding-the-control-contract"></a><span data-ttu-id="0f295-305">通过了解控件协定自定义其他控件</span><span class="sxs-lookup"><span data-stu-id="0f295-305">Customizing Other Controls by Understanding the Control Contract</span></span>  
 <span data-ttu-id="0f295-306">使用的控件<xref:System.Windows.Controls.ControlTemplate>指定其可视结构 (通过使用<xref:System.Windows.FrameworkElement>对象) 和可视行为 (通过使用<xref:System.Windows.VisualState>对象) 使用部件控件模型。</span><span class="sxs-lookup"><span data-stu-id="0f295-306">A control that uses a <xref:System.Windows.Controls.ControlTemplate> to specify its visual structure (by using <xref:System.Windows.FrameworkElement> objects) and visual behavior (by using <xref:System.Windows.VisualState> objects) uses the parts control model.</span></span> <span data-ttu-id="0f295-307">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 4 附带的许多控件均使用此模型。</span><span class="sxs-lookup"><span data-stu-id="0f295-307">Many of the controls that are included with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 4 use this model.</span></span> <span data-ttu-id="0f295-308">部件的<xref:System.Windows.Controls.ControlTemplate>作者需要注意的通过控件协定。</span><span class="sxs-lookup"><span data-stu-id="0f295-308">The parts that a <xref:System.Windows.Controls.ControlTemplate> author needs to be aware of are communicated through the control contract.</span></span> <span data-ttu-id="0f295-309">了解控件协定的各个部件后，可以自定义使用部件控件模型的任意控件的外观。</span><span class="sxs-lookup"><span data-stu-id="0f295-309">When you understand the parts of a control contract, you can customize the appearance of any control that uses the parts control model.</span></span>  
  
 <span data-ttu-id="0f295-310">控件协定具有三个元素：</span><span class="sxs-lookup"><span data-stu-id="0f295-310">A control contract has three elements:</span></span>  
  
-   <span data-ttu-id="0f295-311">控件逻辑使用的可视元素。</span><span class="sxs-lookup"><span data-stu-id="0f295-311">The visual elements that the control's logic uses.</span></span>  
  
-   <span data-ttu-id="0f295-312">控件状态和每种状态所属的组。</span><span class="sxs-lookup"><span data-stu-id="0f295-312">The states of the control and the group each state belongs to.</span></span>  
  
-   <span data-ttu-id="0f295-313">以可视方式影响控件的公共属性。</span><span class="sxs-lookup"><span data-stu-id="0f295-313">The public properties that visually affect the control.</span></span>  
  
### <a name="visual-elements-in-the-control-contract"></a><span data-ttu-id="0f295-314">控件协定中的可视元素</span><span class="sxs-lookup"><span data-stu-id="0f295-314">Visual Elements in the Control Contract</span></span>  
 <span data-ttu-id="0f295-315">控件的逻辑有时与交互<xref:System.Windows.FrameworkElement>，位于<xref:System.Windows.Controls.ControlTemplate>。</span><span class="sxs-lookup"><span data-stu-id="0f295-315">Sometimes a control's logic interacts with a <xref:System.Windows.FrameworkElement> that is in the <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="0f295-316">例如，控件可能会处理它的其中一个元素的事件。</span><span class="sxs-lookup"><span data-stu-id="0f295-316">For example, the control might handle an event of one of its elements.</span></span> <span data-ttu-id="0f295-317">如果控件期望若要查找特定<xref:System.Windows.FrameworkElement>中<xref:System.Windows.Controls.ControlTemplate>，它必须给提供该信息<xref:System.Windows.Controls.ControlTemplate>作者。</span><span class="sxs-lookup"><span data-stu-id="0f295-317">When a control expects to find a particular <xref:System.Windows.FrameworkElement> in the <xref:System.Windows.Controls.ControlTemplate>, it must convey that information to the <xref:System.Windows.Controls.ControlTemplate> author.</span></span> <span data-ttu-id="0f295-318">该控件使用<xref:System.Windows.TemplatePartAttribute>传达预期的元素和元素的名称应为的类型。</span><span class="sxs-lookup"><span data-stu-id="0f295-318">The control uses the <xref:System.Windows.TemplatePartAttribute> to convey the type of element that is expected, and what the name of the element should be.</span></span> <span data-ttu-id="0f295-319"><xref:System.Windows.Controls.Button>没有<xref:System.Windows.FrameworkElement>中其控件协定，但其他控件，如部件<xref:System.Windows.Controls.ComboBox>，执行操作。</span><span class="sxs-lookup"><span data-stu-id="0f295-319">The <xref:System.Windows.Controls.Button> does not have <xref:System.Windows.FrameworkElement> parts in its control contract, but other controls, such as the <xref:System.Windows.Controls.ComboBox>, do.</span></span>  
  
 <span data-ttu-id="0f295-320">下面的示例演示<xref:System.Windows.TemplatePartAttribute>指定的对象<xref:System.Windows.Controls.ComboBox>类。</span><span class="sxs-lookup"><span data-stu-id="0f295-320">The following example shows the <xref:System.Windows.TemplatePartAttribute> objects that are specified on the <xref:System.Windows.Controls.ComboBox> class.</span></span> <span data-ttu-id="0f295-321">逻辑<xref:System.Windows.Controls.ComboBox>期望找到<xref:System.Windows.Controls.TextBox>名为`PART_EditableTextBox`和<xref:System.Windows.Controls.Primitives.Popup>名为`PART_Popup`中其<xref:System.Windows.Controls.ControlTemplate>。</span><span class="sxs-lookup"><span data-stu-id="0f295-321">The logic of <xref:System.Windows.Controls.ComboBox> expects to find a <xref:System.Windows.Controls.TextBox> named `PART_EditableTextBox` and a <xref:System.Windows.Controls.Primitives.Popup> named `PART_Popup` in its <xref:System.Windows.Controls.ControlTemplate>.</span></span>  
  
 [!code-csharp[VSMButtonTemplate#ComboBoxContract](../../../../samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/controlcontracts.cs#comboboxcontract)]
 [!code-vb[VSMButtonTemplate#ComboBoxContract](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/vsmbuttontemplate/visualbasic/window1.xaml.vb#comboboxcontract)]  
  
 <span data-ttu-id="0f295-322">下面的示例演示一个简单<xref:System.Windows.Controls.ControlTemplate>为<xref:System.Windows.Controls.ComboBox>包括由指定的元素<xref:System.Windows.TemplatePartAttribute>对象上<xref:System.Windows.Controls.ComboBox>类。</span><span class="sxs-lookup"><span data-stu-id="0f295-322">The following example shows a simplified <xref:System.Windows.Controls.ControlTemplate> for the <xref:System.Windows.Controls.ComboBox> that includes the elements that are specified by the <xref:System.Windows.TemplatePartAttribute> objects on the <xref:System.Windows.Controls.ComboBox> class.</span></span>  
  
 [!code-xaml[VSMButtonTemplate#ComboBoxTemplate](../../../../samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/window1.xaml#comboboxtemplate)]  
  
### <a name="states-in-the-control-contract"></a><span data-ttu-id="0f295-323">控件协定中的状态</span><span class="sxs-lookup"><span data-stu-id="0f295-323">States in the Control Contract</span></span>  
 <span data-ttu-id="0f295-324">控件状态也属于控件协定。</span><span class="sxs-lookup"><span data-stu-id="0f295-324">The states of a control are also a part of the control contract.</span></span> <span data-ttu-id="0f295-325">创建的示例<xref:System.Windows.Controls.ControlTemplate>为<xref:System.Windows.Controls.Button>演示如何指定的外观<xref:System.Windows.Controls.Button>取决于其状态。</span><span class="sxs-lookup"><span data-stu-id="0f295-325">The example of creating a <xref:System.Windows.Controls.ControlTemplate> for a <xref:System.Windows.Controls.Button> shows how to specify the appearance of a <xref:System.Windows.Controls.Button> depending on its states.</span></span> <span data-ttu-id="0f295-326">你创建<xref:System.Windows.VisualState>每个指定状态并使所有<xref:System.Windows.VisualState>对象该共享<xref:System.Windows.TemplateVisualStateAttribute.GroupName%2A>中<xref:System.Windows.VisualStateGroup>中所述，[更改外观的控件根据其状态](#changing_the_appearance_of_a_control_depending_on_its_state)前面的这主题。</span><span class="sxs-lookup"><span data-stu-id="0f295-326">You create a <xref:System.Windows.VisualState> for each specified state and put all <xref:System.Windows.VisualState> objects that share a <xref:System.Windows.TemplateVisualStateAttribute.GroupName%2A> in a <xref:System.Windows.VisualStateGroup>, as described in [Changing the Appearance of a Control Depending on Its State](#changing_the_appearance_of_a_control_depending_on_its_state) earlier in this topic.</span></span> <span data-ttu-id="0f295-327">第三方控件应通过使用指定状态<xref:System.Windows.TemplateVisualStateAttribute>，从而使设计器工具，如 Expression Blend，公开用于创作控件模板的控件的状态。</span><span class="sxs-lookup"><span data-stu-id="0f295-327">Third-party controls should specify states by using the <xref:System.Windows.TemplateVisualStateAttribute>, which enables designer tools, such as Expression Blend, to expose the control's states for authoring control templates.</span></span>  
  
 <span data-ttu-id="0f295-328">若要查找 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 中随附的控件的控件协定，请参阅 [Control 样式和模板](../../../../docs/framework/wpf/controls/control-styles-and-templates.md)。</span><span class="sxs-lookup"><span data-stu-id="0f295-328">To find the control contract for controls that are included with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Control Styles and Templates](../../../../docs/framework/wpf/controls/control-styles-and-templates.md).</span></span>  
  
### <a name="properties-in-the-control-contract"></a><span data-ttu-id="0f295-329">控件协定中的属性</span><span class="sxs-lookup"><span data-stu-id="0f295-329">Properties in the Control Contract</span></span>  
 <span data-ttu-id="0f295-330">以可视方式影响控件的公共属性也包含在控件协定中。</span><span class="sxs-lookup"><span data-stu-id="0f295-330">The public properties that visually affect the control are also included in the control contract.</span></span> <span data-ttu-id="0f295-331">你可以设置这些属性以更改控件的外观，而无需创建一个新<xref:System.Windows.Controls.ControlTemplate>。</span><span class="sxs-lookup"><span data-stu-id="0f295-331">You can set these properties to change the appearance of the control without creating a new <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="0f295-332">你还可以使用[TemplateBinding](../../../../docs/framework/wpf/advanced/templatebinding-markup-extension.md)绑定中的元素的属性的标记扩展<xref:System.Windows.Controls.ControlTemplate>由定义的公共属性到<xref:System.Windows.Controls.Button>。</span><span class="sxs-lookup"><span data-stu-id="0f295-332">You can also use the [TemplateBinding](../../../../docs/framework/wpf/advanced/templatebinding-markup-extension.md) markup extension to bind properties of elements that are in the <xref:System.Windows.Controls.ControlTemplate> to public properties that are defined by the <xref:System.Windows.Controls.Button>.</span></span>  
  
 <span data-ttu-id="0f295-333">以下示例展示了按钮的控件协定。</span><span class="sxs-lookup"><span data-stu-id="0f295-333">The following example shows the control contract for the button.</span></span>  
  
 [!code-csharp[VSMButtonTemplate#ButtonContract](../../../../samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/controlcontracts.cs#buttoncontract)]
 [!code-vb[VSMButtonTemplate#ButtonContract](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/vsmbuttontemplate/visualbasic/window1.xaml.vb#buttoncontract)]  
  
 <span data-ttu-id="0f295-334">在创建时<xref:System.Windows.Controls.ControlTemplate>，通常很容易与现有开始<xref:System.Windows.Controls.ControlTemplate>和对其进行更改。</span><span class="sxs-lookup"><span data-stu-id="0f295-334">When creating a <xref:System.Windows.Controls.ControlTemplate>, it is often easiest to begin with an existing <xref:System.Windows.Controls.ControlTemplate> and make changes to it.</span></span> <span data-ttu-id="0f295-335">你可以执行的操作来更改现有<xref:System.Windows.Controls.ControlTemplate>:</span><span class="sxs-lookup"><span data-stu-id="0f295-335">You can do one of the following to change an existing <xref:System.Windows.Controls.ControlTemplate>:</span></span>  
  
-   <span data-ttu-id="0f295-336">使用设计器（例如 Expression Blend），它可以提供用于创建控件模板的图形用户界面。</span><span class="sxs-lookup"><span data-stu-id="0f295-336">Use a designer, such as Expression Blend, which provides a graphical user interface for creating control templates.</span></span> <span data-ttu-id="0f295-337">有关详细信息，请参阅[设置支持模板的控件的样式](http://go.microsoft.com/fwlink/?LinkId=161153)。</span><span class="sxs-lookup"><span data-stu-id="0f295-337">For more information, see [Styling a control that supports templates](http://go.microsoft.com/fwlink/?LinkId=161153).</span></span>  
  
-   <span data-ttu-id="0f295-338">获取默认<xref:System.Windows.Controls.ControlTemplate>和对其进行编辑。</span><span class="sxs-lookup"><span data-stu-id="0f295-338">Get the default <xref:System.Windows.Controls.ControlTemplate> and edit it.</span></span> <span data-ttu-id="0f295-339">若要查找 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 随附的默认控件模板，请参阅[默认 WPF 主题](http://go.microsoft.com/fwlink/?LinkID=158252)。</span><span class="sxs-lookup"><span data-stu-id="0f295-339">To find the default control templates that are included with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Default WPF Themes](http://go.microsoft.com/fwlink/?LinkID=158252).</span></span>  
  
<a name="complete_example"></a>   
## <a name="complete-example"></a><span data-ttu-id="0f295-340">完整的示例</span><span class="sxs-lookup"><span data-stu-id="0f295-340">Complete Example</span></span>  
 <span data-ttu-id="0f295-341">下面的示例演示完整<xref:System.Windows.Controls.Button><xref:System.Windows.Controls.ControlTemplate>本主题中讨论。</span><span class="sxs-lookup"><span data-stu-id="0f295-341">The following example shows the complete <xref:System.Windows.Controls.Button><xref:System.Windows.Controls.ControlTemplate> that is discussed in this topic.</span></span>  
  
 [!code-xaml[VSMButtonTemplate#3](../../../../samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/skinnedbutton.xaml#3)]  
  
## <a name="see-also"></a><span data-ttu-id="0f295-342">请参阅</span><span class="sxs-lookup"><span data-stu-id="0f295-342">See Also</span></span>  
 [<span data-ttu-id="0f295-343">样式设置和模板化</span><span class="sxs-lookup"><span data-stu-id="0f295-343">Styling and Templating</span></span>](../../../../docs/framework/wpf/controls/styling-and-templating.md)
