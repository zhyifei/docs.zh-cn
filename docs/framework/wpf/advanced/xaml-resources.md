---
title: "XAML 资源"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-wpf
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- reusing resources [WPF]
- resources [WPF], reusing
- reusing commonly defined objects [WPF]
- XAML [WPF], reusing resources
ms.assetid: 91580b89-a0a8-4889-aecb-fddf8e63175f
caps.latest.revision: "33"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 1f9d0ff535d0784343b36d0b2df48b123ff3beef
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/21/2017
---
# <a name="xaml-resources"></a><span data-ttu-id="4ac3a-102">XAML 资源</span><span class="sxs-lookup"><span data-stu-id="4ac3a-102">XAML Resources</span></span>
<span data-ttu-id="4ac3a-103">资源是可以在应用程序中的不同位置重复使用的对象。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-103">A resource is an object that can be reused in different places in your application.</span></span> <span data-ttu-id="4ac3a-104">资源的示例包括画笔和样式。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-104">Examples of resources include brushes and styles.</span></span> <span data-ttu-id="4ac3a-105">本概述介绍如何使用中的资源[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-105">This overview describes how to use resources in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span> <span data-ttu-id="4ac3a-106">你还可以创建和使用代码，或者通过互换使用代码访问资源和[!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-106">You can also create and access resources by using code, or interchangeably between code and [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)].</span></span> <span data-ttu-id="4ac3a-107">有关详细信息，请参阅[资源和代码](../../../../docs/framework/wpf/advanced/resources-and-code.md)。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-107">For more information, see [Resources and Code](../../../../docs/framework/wpf/advanced/resources-and-code.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="4ac3a-108">本主题中所述的资源文件是不同于资源文件中所述[WPF 应用程序资源、 内容和数据文件](../../../../docs/framework/wpf/app-development/wpf-application-resource-content-and-data-files.md)和不同于中所述的嵌入或链接资源[管理应用程序资源 (.NET)](http://msdn.microsoft.com/library/f2582734-8ada-4baa-8a7c-e2ef943ddf7e)。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-108">The resource files described in this topic are different than the resource files described in [WPF Application Resource, Content, and Data Files](../../../../docs/framework/wpf/app-development/wpf-application-resource-content-and-data-files.md) and different than the embedded or linked resources described in [Managing Application Resources (.NET)](http://msdn.microsoft.com/library/f2582734-8ada-4baa-8a7c-e2ef943ddf7e).</span></span>  
  
  
<a name="usingresources"></a>   
## <a name="using-resources-in-xaml"></a><span data-ttu-id="4ac3a-109">在 XAML 中使用资源</span><span class="sxs-lookup"><span data-stu-id="4ac3a-109">Using Resources in XAML</span></span>  
 <span data-ttu-id="4ac3a-110">下面的示例定义<xref:System.Windows.Media.SolidColorBrush>作为页面的根元素上的资源。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-110">The following example defines a <xref:System.Windows.Media.SolidColorBrush> as a resource on the root element of a page.</span></span> <span data-ttu-id="4ac3a-111">该示例然后引用该资源，并使用它来设置属性的多个子元素，包括<xref:System.Windows.Shapes.Ellipse>、 <xref:System.Windows.Controls.TextBlock>，和一个<xref:System.Windows.Controls.Button>。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-111">The example then references the resource and uses it to set properties of several child elements, including an <xref:System.Windows.Shapes.Ellipse>, a <xref:System.Windows.Controls.TextBlock>, and a <xref:System.Windows.Controls.Button>.</span></span>  
  
 [!code-xaml[FEResourceSH_snip#XAML](../../../../samples/snippets/csharp/VS_Snippets_Wpf/FEResourceSH_snip/CS/page1.xaml#xaml)]  
  
 <span data-ttu-id="4ac3a-112">框架级别的每个元素 (<xref:System.Windows.FrameworkElement>或<xref:System.Windows.FrameworkContentElement>) 具有<xref:System.Windows.FrameworkElement.Resources%2A>属性，它是包含的资源的属性 (作为<xref:System.Windows.ResourceDictionary>) 资源定义。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-112">Every framework-level element (<xref:System.Windows.FrameworkElement> or <xref:System.Windows.FrameworkContentElement>) has a <xref:System.Windows.FrameworkElement.Resources%2A> property, which is the property that contains the resources (as a <xref:System.Windows.ResourceDictionary>) that a resource defines.</span></span> <span data-ttu-id="4ac3a-113">您可以在任意元素上定义资源。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-113">You can define resources on any element.</span></span> <span data-ttu-id="4ac3a-114">但是，在根元素，它是最常定义资源<xref:System.Windows.Controls.Page>在示例中。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-114">However, resources are most often defined on the root element, which is <xref:System.Windows.Controls.Page> in the example.</span></span>  
  
 <span data-ttu-id="4ac3a-115">资源字典中的每个资源都必须具有唯一键。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-115">Each resource in a resource dictionary must have a unique key.</span></span> <span data-ttu-id="4ac3a-116">当在标记中定义资源时，你分配通过唯一密钥[X:key 指令](../../../../docs/framework/xaml-services/x-key-directive.md)。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-116">When you define resources in markup, you assign the unique key through the [x:Key Directive](../../../../docs/framework/xaml-services/x-key-directive.md).</span></span> <span data-ttu-id="4ac3a-117">通常情况下，这个键是一个字符串；但是，也可使用相应的标记扩展将其设置为其他对象类型。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-117">Typically, the key is a string; however, you can also set it to other object types by using the appropriate markup extensions.</span></span> <span data-ttu-id="4ac3a-118">某些功能区中使用非字符串资源的键[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]、 值得注意的是有关样式、 组件资源和数据样式。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-118">Nonstring keys for resources are used by certain feature areas in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], notably for styles, component resources, and data styling.</span></span>  
  
 <span data-ttu-id="4ac3a-119">在定义好资源后，可以使用能够指定键名称的资源标记扩展语法来引用该资源以用于属性值，例如：</span><span class="sxs-lookup"><span data-stu-id="4ac3a-119">After you define a resource, you can reference the resource to be used for a property value by using a resource markup extension syntax that specifies the key name, for example:</span></span>  
  
 [!code-xaml[FEResourceSH_snip#KeyNameUsage](../../../../samples/snippets/csharp/VS_Snippets_Wpf/FEResourceSH_snip/CS/page2.xaml#keynameusage)]  
  
 <span data-ttu-id="4ac3a-120">在前面的示例中，当[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]加载程序处理值`{StaticResource MyBrush}`为<xref:System.Windows.Controls.Control.Background%2A>属性<xref:System.Windows.Controls.Button>，资源查找逻辑首先检查资源字典中是否的<xref:System.Windows.Controls.Button>元素。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-120">In the preceding example, when the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] loader processes the value `{StaticResource MyBrush}` for the <xref:System.Windows.Controls.Control.Background%2A> property on <xref:System.Windows.Controls.Button>, the resource lookup logic first checks the resource dictionary for the <xref:System.Windows.Controls.Button> element.</span></span> <span data-ttu-id="4ac3a-121">如果<xref:System.Windows.Controls.Button>没有一个定义的资源键`MyBrush`（不; 其资源集合为空），查找下一步检查的父元素<xref:System.Windows.Controls.Button>，即<xref:System.Windows.Controls.Page>。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-121">If <xref:System.Windows.Controls.Button> does not have a definition of the resource key `MyBrush` (it does not; its resource collection is empty), the lookup next checks the parent element of <xref:System.Windows.Controls.Button>, which is <xref:System.Windows.Controls.Page>.</span></span> <span data-ttu-id="4ac3a-122">因此，当你定义资源上<xref:System.Windows.Controls.Page>根元素，在逻辑树中的所有元素<xref:System.Windows.Controls.Page>可以访问它，并可以重复使用相同的资源，为设置任何属性的值时，接受<xref:System.Type>的资源表示。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-122">Thus, when you define a resource on the <xref:System.Windows.Controls.Page> root element, all the elements in the logical tree of the <xref:System.Windows.Controls.Page> can access it, and you can reuse the same resource for setting the value of any property that accepts the <xref:System.Type> that the resource represents.</span></span> <span data-ttu-id="4ac3a-123">在上一示例中，相同`MyBrush`资源设置两个不同的属性：<xref:System.Windows.Controls.Control.Background%2A>的<xref:System.Windows.Controls.Button>，和<xref:System.Windows.Shapes.Shape.Fill%2A>的<xref:System.Windows.Shapes.Rectangle>。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-123">In the previous example, the same `MyBrush` resource sets two different properties: the <xref:System.Windows.Controls.Control.Background%2A> of a <xref:System.Windows.Controls.Button>, and the <xref:System.Windows.Shapes.Shape.Fill%2A> of a <xref:System.Windows.Shapes.Rectangle>.</span></span>  
  
<a name="staticdynamic"></a>   
## <a name="static-and-dynamic-resources"></a><span data-ttu-id="4ac3a-124">静态和动态资源</span><span class="sxs-lookup"><span data-stu-id="4ac3a-124">Static and Dynamic Resources</span></span>  
 <span data-ttu-id="4ac3a-125">资源可以作为静态资源或动态资源加以引用。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-125">A resource can be referenced as either a static resource or a dynamic resource.</span></span> <span data-ttu-id="4ac3a-126">这可通过使用[否则标记扩展](../../../../docs/framework/wpf/advanced/staticresource-markup-extension.md)或[DynamicResource 标记扩展](../../../../docs/framework/wpf/advanced/dynamicresource-markup-extension.md)。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-126">This is done by using either the [StaticResource Markup Extension](../../../../docs/framework/wpf/advanced/staticresource-markup-extension.md) or the [DynamicResource Markup Extension](../../../../docs/framework/wpf/advanced/dynamicresource-markup-extension.md).</span></span> <span data-ttu-id="4ac3a-127">标记扩展是一项功能的[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]，您可以通过使用标记扩展来处理的特性字符串并返回到对象中指定的对象引用由此[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]加载程序。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-127">A markup extension is a feature of [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] whereby you can specify an object reference by having the markup extension process the attribute string and return the object to a [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] loader.</span></span> <span data-ttu-id="4ac3a-128">有关标记扩展行为的详细信息，请参阅[标记扩展和 WPF XAML](../../../../docs/framework/wpf/advanced/markup-extensions-and-wpf-xaml.md)。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-128">For more information about markup extension behavior, see [Markup Extensions and WPF XAML](../../../../docs/framework/wpf/advanced/markup-extensions-and-wpf-xaml.md).</span></span>  
  
 <span data-ttu-id="4ac3a-129">当使用标记扩展时，通常会以字符串的形式提供一个或多个参数，这些参数由该特定标记扩展来处理，而不是在所设置属性的上下文中进行计算。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-129">When you use a markup extension, you typically provide one or more parameters in string form that are processed by that particular markup extension, rather than being evaluated in the context of the property being set.</span></span> <span data-ttu-id="4ac3a-130">[否则标记扩展](../../../../docs/framework/wpf/advanced/staticresource-markup-extension.md)处理通过查找所有可用的资源字典中的键的值的键。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-130">The [StaticResource Markup Extension](../../../../docs/framework/wpf/advanced/staticresource-markup-extension.md) processes a key by looking up the value for that key in all available resource dictionaries.</span></span> <span data-ttu-id="4ac3a-131">这个操作会在加载期间执行；执行时，加载进程需要分配采用静态资源引用的属性值。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-131">This happens during loading, which is the point in time when the loading process needs to assign the property value that takes the static resource reference.</span></span> <span data-ttu-id="4ac3a-132">[DynamicResource 标记扩展](../../../../docs/framework/wpf/advanced/dynamicresource-markup-extension.md)请改为进程通过创建一个表达式和该表达式的键将一直而言未计算实际运行该应用程序，在这段时间表达式计算，并提供一个值。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-132">The [DynamicResource Markup Extension](../../../../docs/framework/wpf/advanced/dynamicresource-markup-extension.md) instead processes a key by creating an expression, and that expression remains unevaluated until the application is actually run, at which time the expression is evaluated and provides a value.</span></span>  
  
 <span data-ttu-id="4ac3a-133">在引用某个资源时，下列注意事项可能会对于使用静态资源引用还是使用动态资源引用产生影响：</span><span class="sxs-lookup"><span data-stu-id="4ac3a-133">When you reference a resource, the following considerations can influence whether you use a static resource reference or a dynamic resource reference:</span></span>  
  
-   <span data-ttu-id="4ac3a-134">如何为你的应用程序创建资源的总体设计 (每页、 在应用程序，在松散[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]中的资源的唯一程序集)。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-134">The overall design of how you create the resources for your application (per page, in the application, in loose [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], in a resource only assembly).</span></span>  
  
-   <span data-ttu-id="4ac3a-135">应用程序的功能：实时更新资源是应用程序的要求之一吗?</span><span class="sxs-lookup"><span data-stu-id="4ac3a-135">The application functionality: is updating resources in real time part of your application requirements?</span></span>  
  
-   <span data-ttu-id="4ac3a-136">该资源引用类型的相应查找行为。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-136">The respective lookup behavior of that resource reference type.</span></span>  
  
-   <span data-ttu-id="4ac3a-137">特定的属性或资源类型，以及这些类型的本机行为。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-137">The particular property or resource type, and the native behavior of those types.</span></span>  
  
### <a name="static-resources"></a><span data-ttu-id="4ac3a-138">静态资源</span><span class="sxs-lookup"><span data-stu-id="4ac3a-138">Static Resources</span></span>  
 <span data-ttu-id="4ac3a-139">在以下情况下，最适合使用静态资源引用：</span><span class="sxs-lookup"><span data-stu-id="4ac3a-139">Static resource references work best for the following circumstances:</span></span>  
  
-   <span data-ttu-id="4ac3a-140">所采用的应用程序设计将其所含的大多数资源都集中到了页面级或应用程序级资源字典中。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-140">Your application design concentrates most of all of its resources into page or application level resource dictionaries.</span></span> <span data-ttu-id="4ac3a-141">静态资源引用不会基于运行时行为（如重载页面）重新进行计算，因此可以通过以下方式在一定程度上提高性能：当资源和所采用的应用程序设计无需使用大量动态资源引用时，就避免使用。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-141">Static resource references are not reevaluated based on runtime behaviors such as reloading a page, and therefore there can be some performance benefit to avoiding large numbers of dynamic resource references when they are not necessary per your resource and application design.</span></span>  
  
-   <span data-ttu-id="4ac3a-142">设置不在属性的值<xref:System.Windows.DependencyObject>或<xref:System.Windows.Freezable>。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-142">You are setting the value of a property that is not on a <xref:System.Windows.DependencyObject> or a <xref:System.Windows.Freezable>.</span></span>  
  
-   <span data-ttu-id="4ac3a-143">正在创建的资源字典将编译成 DLL，并将打包为应用程序的一部分或在应用程序间共享。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-143">You are creating a resource dictionary that will be compiled into a DLL, and packaged as part of the application or shared between applications.</span></span>  
  
-   <span data-ttu-id="4ac3a-144">正在为自定义控件创建主题，并定义要在主题中使用的资源。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-144">You are creating a theme for a custom control, and are defining resources that are used within the themes.</span></span> <span data-ttu-id="4ac3a-145">在这种情况下，通常不希望执行动态资源引用查找行为，而是希望执行静态资源引用行为，以确保查找可预测且自包含到主题中。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-145">For this case, you typically do not want the dynamic resource reference lookup behavior, you instead want the static resource reference behavior so that the lookup is predictable and self-contained to the theme.</span></span> <span data-ttu-id="4ac3a-146">使用动态资源引用时，即使主题中的引用会保持未计算状态直至运行时，且主题可能会得到应用，但某个本地元素仍会重新定义主题正尝试引用的键，并且该本地元素在查找期间会排在主题前面。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-146">With a dynamic resource reference, even a reference within a theme is left unevaluated until runtime, and there is a chance that when the theme is applied, some local element will redefine a key that your theme is trying to reference, and the local element will fall prior to the theme itself in the lookup.</span></span> <span data-ttu-id="4ac3a-147">如果发生这种情况，主题的行为将偏离预期方式。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-147">If that happens, your theme will not behave in an expected manner.</span></span>  
  
-   <span data-ttu-id="4ac3a-148">正在使用资源设置大量依赖属性。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-148">You are using resources to set large numbers of dependency properties.</span></span> <span data-ttu-id="4ac3a-149">依赖属性会通过属性系统启用有效值缓存功能；因此，如果为可在加载时进行计算的依赖属性提供了值，则该依赖属性不必检查是否存在重新计算的表达式并可返回上一个有效值。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-149">Dependency properties have effective value caching as enabled by the property system, so if you provide a value for a dependency property that can be evaluated at load time, the dependency property does not have to check for a reevaluated expression and can return the last effective value.</span></span> <span data-ttu-id="4ac3a-150">此项技术可以提高性能。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-150">This technique can be a performance benefit.</span></span>  
  
-   <span data-ttu-id="4ac3a-151">你想要为所有使用者，更改基础资源或者你想要使用的每个使用者维护单独的可写实例[x： 共享属性](../../../../docs/framework/xaml-services/x-shared-attribute.md)。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-151">You want to change the underlying resource for all consumers, or you want to maintain separate writable instances for each consumer by using the [x:Shared Attribute](../../../../docs/framework/xaml-services/x-shared-attribute.md).</span></span>  
  
#### <a name="static-resource-lookup-behavior"></a><span data-ttu-id="4ac3a-152">静态资源查找行为</span><span class="sxs-lookup"><span data-stu-id="4ac3a-152">Static resource lookup behavior</span></span>  
  
1.  <span data-ttu-id="4ac3a-153">查找进程在用于设置属性的元素所定义的资源字典中查找请求的键。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-153">The lookup process checks for the requested key within the resource dictionary defined by the element that sets the property.</span></span>  
  
2.  <span data-ttu-id="4ac3a-154">查找进程随后会向上遍历逻辑树，以查找父元素及其资源字典。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-154">The lookup process then traverses the logical tree upward, to the parent element and its resource dictionary.</span></span> <span data-ttu-id="4ac3a-155">直至到达根元素，遍历操作才会停止。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-155">This continues until the root element is reached.</span></span>  
  
3.  <span data-ttu-id="4ac3a-156">接下来，将检查应用程序资源。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-156">Next, application resources are checked.</span></span> <span data-ttu-id="4ac3a-157">应用程序资源是由定义的资源字典中的这些资源<xref:System.Windows.Application>对象你[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]应用程序。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-157">Application resources are those resources within the resource dictionary that is defined by the <xref:System.Windows.Application> object for your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application.</span></span>  
  
 <span data-ttu-id="4ac3a-158">从资源字典中进行的静态资源引用必须引用已在资源引用前进行过词法定义的资源。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-158">Static resource references from within a resource dictionary must reference a resource that has already been defined lexically before the resource reference.</span></span> <span data-ttu-id="4ac3a-159">静态资源引用无法解析前向引用。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-159">Forward references cannot be resolved by a static resource reference.</span></span> <span data-ttu-id="4ac3a-160">因此，如果使用静态资源引用，则必须对资源字典的结构进行设计，以便在每个相应资源字典的开头或临近位置定义要按资源使用的资源。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-160">For this reason, if you use static resource references, you must design your resource dictionary structure such that resources intended for by-resource use are defined at or near the beginning of each respective resource dictionary.</span></span>  
  
 <span data-ttu-id="4ac3a-161">静态资源查找可以扩展到主题，或系统资源，但支持这种情况只是因为[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]加载程序延迟了请求。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-161">Static resource lookup can extend into themes, or into system resources, but this is supported only because the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] loader defers the request.</span></span> <span data-ttu-id="4ac3a-162">为了让页面加载时的运行时主题正确地应用至该应用程序，这种延迟是必需的。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-162">The deferral is necessary so that the runtime theme at the time the page loads applies properly to the application.</span></span> <span data-ttu-id="4ac3a-163">但是，如果某些键已知仅存在于主题中或属于系统资源，则建议不要使用针对这类键的静态资源引用。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-163">However, static resource references to keys that are known to only exist in themes or as system resources are not recommended.</span></span> <span data-ttu-id="4ac3a-164">这是因为如果用户实时更改主题，此类引用不会重新计算。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-164">This is because such references are not reevaluated if the theme is changed by the user in realtime.</span></span> <span data-ttu-id="4ac3a-165">请求主题或系统资源时，动态资源引用更为可靠。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-165">A dynamic resource reference is more reliable when you request theme or system resources.</span></span> <span data-ttu-id="4ac3a-166">例外情况是当主题元素自身请求另一个资源。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-166">The exception is when a theme element itself requests another resource.</span></span> <span data-ttu-id="4ac3a-167">出于上述原因，这些引用应该是静态资源引用。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-167">These references should be static resource references, for the reasons mentioned earlier.</span></span>  
  
 <span data-ttu-id="4ac3a-168">因找不到静态资源引用而引发的异常行为各不相同。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-168">The exception behavior if a static resource reference is not found varies.</span></span> <span data-ttu-id="4ac3a-169">如果资源被延迟，则异常会在运行时发生。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-169">If the resource was deferred, then the exception occurs at runtime.</span></span> <span data-ttu-id="4ac3a-170">如果资源未延迟，则异常会在加载时发生。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-170">If the resource was not deferred, the exception occurs at load time.</span></span>  
  
### <a name="dynamic-resources"></a><span data-ttu-id="4ac3a-171">动态资源</span><span class="sxs-lookup"><span data-stu-id="4ac3a-171">Dynamic Resources</span></span>  
 <span data-ttu-id="4ac3a-172">在以下情况下，最适合使用动态资源：</span><span class="sxs-lookup"><span data-stu-id="4ac3a-172">Dynamic resources work best for the following circumstances:</span></span>  
  
-   <span data-ttu-id="4ac3a-173">资源的值取决于直到运行时才能获悉的条件。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-173">The value of the resource depends on conditions that are not known until runtime.</span></span> <span data-ttu-id="4ac3a-174">这包括系统资源或用户可设置的资源。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-174">This includes system resources, or resources that are otherwise user settable.</span></span> <span data-ttu-id="4ac3a-175">例如，可以创建引用系统属性的 setter 值，通过公开<xref:System.Windows.SystemColors>， <xref:System.Windows.SystemFonts>，或<xref:System.Windows.SystemParameters>。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-175">For example, you can create setter values that refer to system properties, as exposed by <xref:System.Windows.SystemColors>, <xref:System.Windows.SystemFonts>, or <xref:System.Windows.SystemParameters>.</span></span> <span data-ttu-id="4ac3a-176">这些值是真正的动态值，因为它们最终来自用户和操作系统的运行时环境。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-176">These values are truly dynamic because they ultimately come from the runtime environment of the user and operating system.</span></span> <span data-ttu-id="4ac3a-177">或许还拥有可能会发生变化的应用程序级主题，而页面级资源访问也必须捕获其中的变化。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-177">You might also have application-level themes that can change, where page-level resource access must also capture the change.</span></span>  
  
-   <span data-ttu-id="4ac3a-178">正在为自定义控件创建或引用主题样式。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-178">You are creating or referencing theme styles for a custom control.</span></span>  
  
-   <span data-ttu-id="4ac3a-179">你想要调整的内容<xref:System.Windows.ResourceDictionary>在应用程序生存期内。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-179">You intend to adjust the contents of a <xref:System.Windows.ResourceDictionary> during an application lifetime.</span></span>  
  
-   <span data-ttu-id="4ac3a-180">拥有存在相互依赖关系且可能需要进行前向引用的复杂资源结构。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-180">You have a complicated resource structure that has interdependencies, where a forward reference may be required.</span></span> <span data-ttu-id="4ac3a-181">静态资源引用不支持前向引用，但动态资源引用支持，因为该资源不需要直到运行时，才计算前, 向引用因此不相关的概念。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-181">Static resource references do not support forward references, but dynamic resource references do support them because the resource does not need to be evaluated until runtime, and forward references are therefore not a relevant concept.</span></span>  
  
-   <span data-ttu-id="4ac3a-182">从编译或工作集的角度来看，所引用的资源特别大，而且该资源在页面加载时可能不会立即使用。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-182">You are referencing a resource that is particularly large from the perspective of a compile or working set, and the resource might not be used immediately when the page loads.</span></span> <span data-ttu-id="4ac3a-183">静态资源引用始终从加载[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]加载页面时，; 但是，动态资源引用不会加载直到实际使用。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-183">Static resource references always load from [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] when the page loads; however, a dynamic resource reference does not load until it is actually used.</span></span>  
  
-   <span data-ttu-id="4ac3a-184">所创建样式中的 Setter 值可能来自受主题或其他用户设置影响的其他值。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-184">You are creating a style where setter values might come from other values that are influenced by themes or other user settings.</span></span>  
  
-   <span data-ttu-id="4ac3a-185">正在将资源应用于可能会在应用程序生存期内在逻辑树中重定父级的元素。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-185">You are applying resources to elements that might be reparented in the logical tree during application lifetime.</span></span> <span data-ttu-id="4ac3a-186">父级更改后，资源查找范围也可能会随之更改；因此，如果希望重定父级的元素的资源基于新范围重新进行计算，请始终使用动态资源引用。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-186">Changing the parent also potentially changes the resource lookup scope, so if you want the resource for a reparented element to be reevaluated based on the new scope, always use a dynamic resource reference.</span></span>  
  
#### <a name="dynamic-resource-lookup-behavior"></a><span data-ttu-id="4ac3a-187">动态资源查找行为</span><span class="sxs-lookup"><span data-stu-id="4ac3a-187">Dynamic resource lookup behavior</span></span>  
 <span data-ttu-id="4ac3a-188">动态资源引用的资源查找行为与你的代码中的查找行为，如果调用<xref:System.Windows.FrameworkElement.FindResource%2A>或<xref:System.Windows.FrameworkElement.SetResourceReference%2A>。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-188">Resource lookup behavior for a dynamic resource reference parallels the lookup behavior in your code if you call <xref:System.Windows.FrameworkElement.FindResource%2A> or <xref:System.Windows.FrameworkElement.SetResourceReference%2A>.</span></span>  
  
1.  <span data-ttu-id="4ac3a-189">查找进程在用于设置属性的元素所定义的资源字典中查找请求的键。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-189">The lookup process checks for the requested key within the resource dictionary defined by the element that sets the property.</span></span>  
  
    -   <span data-ttu-id="4ac3a-190">如果该元素定义<xref:System.Windows.FrameworkElement.Style%2A>属性，<xref:System.Windows.Style.Resources%2A>字典内的<xref:System.Windows.Style>已选中。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-190">If the element defines a <xref:System.Windows.FrameworkElement.Style%2A> property, the <xref:System.Windows.Style.Resources%2A> dictionary within the <xref:System.Windows.Style> is checked.</span></span>  
  
    -   <span data-ttu-id="4ac3a-191">如果该元素定义<xref:System.Windows.Controls.Control.Template%2A>属性，<xref:System.Windows.FrameworkTemplate.Resources%2A>字典内的<xref:System.Windows.FrameworkTemplate>已选中。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-191">If the element defines a <xref:System.Windows.Controls.Control.Template%2A> property, the <xref:System.Windows.FrameworkTemplate.Resources%2A> dictionary within the <xref:System.Windows.FrameworkTemplate> is checked.</span></span>  
  
2.  <span data-ttu-id="4ac3a-192">查找进程随后会向上遍历逻辑树，以查找父元素及其资源字典。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-192">The lookup process then traverses the logical tree upward, to the parent element and its resource dictionary.</span></span> <span data-ttu-id="4ac3a-193">直至到达根元素，遍历操作才会停止。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-193">This continues until the root element is reached.</span></span>  
  
3.  <span data-ttu-id="4ac3a-194">接下来，将检查应用程序资源。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-194">Next, application resources are checked.</span></span> <span data-ttu-id="4ac3a-195">应用程序资源是由定义的资源字典中的这些资源<xref:System.Windows.Application>对象你[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]应用程序。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-195">Application resources are those resources within the resource dictionary that is defined by the <xref:System.Windows.Application> object for your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application.</span></span>  
  
4.  <span data-ttu-id="4ac3a-196">在主题资源字典中查找当前处于活动状态的主题。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-196">Theme resource dictionary is checked, for the currently active theme.</span></span> <span data-ttu-id="4ac3a-197">如果主题在运行时发生更改，则会重新计算值。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-197">If the theme changes at runtime, the value is reevaluated.</span></span>  
  
5.  <span data-ttu-id="4ac3a-198">检查系统资源。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-198">System resources are checked.</span></span>  
  
 <span data-ttu-id="4ac3a-199">异常行为（如果有）各不相同：</span><span class="sxs-lookup"><span data-stu-id="4ac3a-199">Exception behavior (if any) varies:</span></span>  
  
-   <span data-ttu-id="4ac3a-200">如果资源请求了<xref:System.Windows.FrameworkElement.FindResource%2A>调用，但未找到，则引发异常。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-200">If a resource was requested by a <xref:System.Windows.FrameworkElement.FindResource%2A> call, and was not found, an exception is raised.</span></span>  
  
-   <span data-ttu-id="4ac3a-201">如果资源请求了<xref:System.Windows.FrameworkElement.TryFindResource%2A>调用，但未找到，会引发任何异常，但返回的值是`null`。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-201">If a resource was requested by a <xref:System.Windows.FrameworkElement.TryFindResource%2A> call, and was not found, no exception is raised, but the returned value is `null`.</span></span> <span data-ttu-id="4ac3a-202">如果要设置的属性不接受`null`，则仍有可能会引发更深的异常 （这取决于要设置的单个属性）。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-202">If the property being set does not accept `null`, then it is still possible that a deeper exception will be raised (this depends on the individual property being set).</span></span>  
  
-   <span data-ttu-id="4ac3a-203">如果资源请求中的动态资源引用了[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]，和未找到，然后的行为取决于在常规属性系统上，而其常规行为就像在资源所在的级别发生任何属性设置操作。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-203">If a resource was requested by a dynamic resource reference in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], and was not found, then the behavior depends on the general property system, but the general behavior is as if no property setting operation occurred at the level where the resource exists.</span></span> <span data-ttu-id="4ac3a-204">例如，如果尝试使用无法计算的资源来设置个别按钮元素上的背景，则值设置操作不会产生任何结果，但是有效的值可能仍来自属性系统和值优先级中的其他参与者。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-204">For instance, if you attempt to set the background on a an individual button element using a resource that could not be evaluated, then no value set results, but the effective value can still come from other participants in the property system and value precedence.</span></span> <span data-ttu-id="4ac3a-205">例如，背景值可能仍来自在本地定义的某个按钮样式，或来自主题样式。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-205">For instance, the background value might still come from a locally defined button style, or from the theme style.</span></span> <span data-ttu-id="4ac3a-206">对于并非由主题样式定义的属性，资源计算失败后的有效值可能来自属性元数据中的默认值。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-206">For properties that are not defined by theme styles, the effective value after a failed resource evaluation might come from the default value in the property metadata.</span></span>  
  
#### <a name="restrictions"></a><span data-ttu-id="4ac3a-207">限制</span><span class="sxs-lookup"><span data-stu-id="4ac3a-207">Restrictions</span></span>  
 <span data-ttu-id="4ac3a-208">动态资源引用存在一些重要限制。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-208">Dynamic resource references have some notable restrictions.</span></span> <span data-ttu-id="4ac3a-209">必须至少满足以下条件之一：</span><span class="sxs-lookup"><span data-stu-id="4ac3a-209">At least one of the following must be true:</span></span>  
  
-   <span data-ttu-id="4ac3a-210">要设置的属性必须是属性上<xref:System.Windows.FrameworkElement>或<xref:System.Windows.FrameworkContentElement>。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-210">The property being set must be a property on a <xref:System.Windows.FrameworkElement> or <xref:System.Windows.FrameworkContentElement>.</span></span> <span data-ttu-id="4ac3a-211">属性必须为后盾<xref:System.Windows.DependencyProperty>。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-211">That property must be backed by a <xref:System.Windows.DependencyProperty>.</span></span>  
  
-   <span data-ttu-id="4ac3a-212">引用是对内的某个值<xref:System.Windows.Style> <xref:System.Windows.Setter>。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-212">The reference is for a value within a <xref:System.Windows.Style><xref:System.Windows.Setter>.</span></span>  
  
-   <span data-ttu-id="4ac3a-213">要设置的属性必须是属性上<xref:System.Windows.Freezable>作为值提供<xref:System.Windows.FrameworkElement>或<xref:System.Windows.FrameworkContentElement>属性，或<xref:System.Windows.Setter>值。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-213">The property being set must be a property on a <xref:System.Windows.Freezable> that is provided as a value of either a <xref:System.Windows.FrameworkElement> or <xref:System.Windows.FrameworkContentElement> property, or a <xref:System.Windows.Setter> value.</span></span>  
  
 <span data-ttu-id="4ac3a-214">因为要设置的属性必须为<xref:System.Windows.DependencyProperty>或<xref:System.Windows.Freezable>属性，大多数属性更改可以传播到 UI，因为属性更改 （更改的动态资源值） 时确认了属性系统。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-214">Because the property being set must be a <xref:System.Windows.DependencyProperty> or <xref:System.Windows.Freezable> property, most property changes can propagate to UI because a property change (the changed dynamic resource value) is acknowledged by the property system.</span></span> <span data-ttu-id="4ac3a-215">大多数控件包含逻辑，用于将强制另一个控件布局，如果<xref:System.Windows.DependencyProperty>更改和属性，可能会影响布局。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-215">Most controls include logic that will force another layout of a control if a <xref:System.Windows.DependencyProperty> changes and that property might affect layout.</span></span> <span data-ttu-id="4ac3a-216">但是，并非所有属性都具有[DynamicResource 标记扩展](../../../../docs/framework/wpf/advanced/dynamicresource-markup-extension.md)作为其值保证提供他们在 UI 中的实时更新的方式的值。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-216">However, not all properties that have a [DynamicResource Markup Extension](../../../../docs/framework/wpf/advanced/dynamicresource-markup-extension.md) as their value are guaranteed to provide the value in such a way that they update in realtime in the UI.</span></span> <span data-ttu-id="4ac3a-217">此功能可能仍会因属性、属性所属的类型，甚至因应用程序的逻辑结果而异。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-217">That functionality still might vary depending on the property, as well as depending on the type that owns the property, or even the logical structure of your application.</span></span>  
  
<a name="stylesimplicitkeys"></a>   
## <a name="styles-datatemplates-and-implicit-keys"></a><span data-ttu-id="4ac3a-218">样式、数据模板和隐式键</span><span class="sxs-lookup"><span data-stu-id="4ac3a-218">Styles, DataTemplates, and Implicit Keys</span></span>  
 <span data-ttu-id="4ac3a-219">前面曾提到中的所有项<xref:System.Windows.ResourceDictionary>必须有一个关键字。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-219">Earlier, it was stated that all items in a <xref:System.Windows.ResourceDictionary> must have a key.</span></span> <span data-ttu-id="4ac3a-220">但是，这不并不意味着所有资源必须都具有显式`x:Key`。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-220">However, that does not mean that all resources must have an explicit `x:Key`.</span></span> <span data-ttu-id="4ac3a-221">多种对象类型在定义为资源时都支持隐式键，其键值会与另一属性的值绑定。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-221">Several object types support an implicit key when defined as a resource, where the key value is tied to the value of another property.</span></span> <span data-ttu-id="4ac3a-222">这称为隐式键，而`x:Key`属性是显式的密钥。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-222">This is known as an implicit key, whereas an `x:Key` attribute is an explicit key.</span></span> <span data-ttu-id="4ac3a-223">任何隐式键都可通过指定显式键来覆盖。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-223">You can overwrite any implicit key by specifying an explicit key.</span></span>  
  
 <span data-ttu-id="4ac3a-224">资源的一个非常重要的方案是定义时<xref:System.Windows.Style>。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-224">One very important scenario for resources is when you define a <xref:System.Windows.Style>.</span></span> <span data-ttu-id="4ac3a-225">事实上，<xref:System.Windows.Style>几乎始终定义为将项记入资源字典中，因为样式本质上是适合于重复使用。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-225">In fact, a <xref:System.Windows.Style> is almost always defined as an entry in a resource dictionary, because styles are inherently intended for reuse.</span></span> <span data-ttu-id="4ac3a-226">有关样式的详细信息，请参阅[样式和模板化](../../../../docs/framework/wpf/controls/styling-and-templating.md)。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-226">For more information about styles, see [Styling and Templating](../../../../docs/framework/wpf/controls/styling-and-templating.md).</span></span>  
  
 <span data-ttu-id="4ac3a-227">控件样式可通过隐式键来创建和引用。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-227">Styles for controls can be both created with and referenced with an implicit key.</span></span> <span data-ttu-id="4ac3a-228">用于定义控件默认外观的主题样式依赖于该隐式键。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-228">The theme styles that define the default appearance of a control rely on this implicit key.</span></span> <span data-ttu-id="4ac3a-229">从请求该的角度来看，隐式键是<xref:System.Type>该控件本身。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-229">The implicit key from the standpoint of requesting it is the <xref:System.Type> of the control itself.</span></span> <span data-ttu-id="4ac3a-230">从定义资源的角度来看，隐式键是<xref:System.Windows.Style.TargetType%2A>的样式。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-230">The implicit key from the standpoint of defining the resource is the <xref:System.Windows.Style.TargetType%2A> of the style.</span></span> <span data-ttu-id="4ac3a-231">因此，如果要创建自定义控件的主题，创建交互的样式具有现有主题样式，你不必指定[X:key 指令](../../../../docs/framework/xaml-services/x-key-directive.md)该<xref:System.Windows.Style>。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-231">Therefore, if you are creating themes for custom controls, creating styles that interact with existing theme styles, you do not need to specify an [x:Key Directive](../../../../docs/framework/xaml-services/x-key-directive.md) for that <xref:System.Windows.Style>.</span></span> <span data-ttu-id="4ac3a-232">另外，如果想要使用主题样式，则根本无需指定任何样式。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-232">And if you want to use the themed styles, you do not need to specify any style at all.</span></span> <span data-ttu-id="4ac3a-233">例如，下面的样式定义可以正常工作，即使<xref:System.Windows.Style>资源似乎不具有键：</span><span class="sxs-lookup"><span data-stu-id="4ac3a-233">For instance, the following style definition works, even though the <xref:System.Windows.Style> resource does not appear to have a key:</span></span>  
  
 [!code-xaml[FEResourceSH_snip#ImplicitStyle](../../../../samples/snippets/csharp/VS_Snippets_Wpf/FEResourceSH_snip/CS/page2.xaml#implicitstyle)]  
  
 <span data-ttu-id="4ac3a-234">样式实际上具有密钥： 隐式键`typeof(` <xref:System.Windows.Controls.Button> `)`。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-234">That style really does have a key: the implicit key `typeof(`<xref:System.Windows.Controls.Button>`)`.</span></span> <span data-ttu-id="4ac3a-235">在标记中，你可以指定<xref:System.Windows.Style.TargetType%2A>直接作为类型名称 (或你可以选择使用[{x: Type...}](../../../../docs/framework/xaml-services/x-type-markup-extension.md)</span><span class="sxs-lookup"><span data-stu-id="4ac3a-235">In markup, you can specify a <xref:System.Windows.Style.TargetType%2A> directly as the type name (or you can optionally use [{x:Type...}](../../../../docs/framework/xaml-services/x-type-markup-extension.md)</span></span> <span data-ttu-id="4ac3a-236">若要返回<xref:System.Type>。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-236">to return a <xref:System.Type>.</span></span>  
  
 <span data-ttu-id="4ac3a-237">通过使用的默认主题样式机制[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]，作为运行时样式的应用样式<xref:System.Windows.Controls.Button>在页上，即使<xref:System.Windows.Controls.Button>本身不会尝试将指定其<xref:System.Windows.FrameworkElement.Style%2A>属性或特定的资源引用样式。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-237">Through the default theme style mechanisms used by [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], that style is applied as the runtime style of a <xref:System.Windows.Controls.Button> on the page, even though the <xref:System.Windows.Controls.Button> itself does not attempt to specify its <xref:System.Windows.FrameworkElement.Style%2A> property or a specific resource reference to the style.</span></span> <span data-ttu-id="4ac3a-238">在页面中定义的样式位于查找序列中的靠前位置（在主题字典样式之前），其所用的键与主题字典样式的键相同。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-238">Your style defined in the page is found earlier in the lookup sequence earlier than the theme dictionary style, using the same key that the theme dictionary style has.</span></span> <span data-ttu-id="4ac3a-239">你可能只需指定`<Button>Hello</Button>`页上，并使用定义的样式中的任何位置<xref:System.Windows.Style.TargetType%2A>的`Button`会应用到该按钮。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-239">You could just specify `<Button>Hello</Button>` anywhere in the page, and the style you defined with <xref:System.Windows.Style.TargetType%2A> of `Button` would apply to that button.</span></span> <span data-ttu-id="4ac3a-240">如果你想，你可以仍显式密钥使用相同的类型值的样式<xref:System.Windows.Style.TargetType%2A>、 清楚起见，在标记中，但这是可选的。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-240">If you want, you can still explicitly key the style with the same type value as <xref:System.Windows.Style.TargetType%2A>, for clarity in your markup, but that is optional.</span></span>  
  
 <span data-ttu-id="4ac3a-241">如果不在控件上适用的样式隐式键<xref:System.Windows.FrameworkElement.OverridesDefaultStyle%2A>是`true`(另请注意，<xref:System.Windows.FrameworkElement.OverridesDefaultStyle%2A>可能设置为本机控件类，而不是显式的控件实例上的行为的一部分)。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-241">Implicit keys for styles do not apply on a control if <xref:System.Windows.FrameworkElement.OverridesDefaultStyle%2A> is `true` (also note that <xref:System.Windows.FrameworkElement.OverridesDefaultStyle%2A> might be set as part of native behavior for the control class, rather than explicitly on an instance of the control).</span></span> <span data-ttu-id="4ac3a-242">此外，为了对派生的类方案支持隐式键，控件必须重写<xref:System.Windows.FrameworkElement.DefaultStyleKey%2A>(作为的一部分提供的所有现有控件[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]执行此操作)。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-242">Also, in order to support implicit keys for derived class scenarios, the control must override <xref:System.Windows.FrameworkElement.DefaultStyleKey%2A> (all existing controls provided as part of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] do this).</span></span> <span data-ttu-id="4ac3a-243">有关样式、 主题和控件设计的详细信息，请参阅[准则设计样式化控件](../../../../docs/framework/wpf/controls/guidelines-for-designing-stylable-controls.md)。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-243">For more information about styles, themes, and control design, see [Guidelines for Designing Stylable Controls](../../../../docs/framework/wpf/controls/guidelines-for-designing-stylable-controls.md).</span></span>  
  
 <span data-ttu-id="4ac3a-244"><xref:System.Windows.DataTemplate>也有一个隐式键。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-244"><xref:System.Windows.DataTemplate> also has an implicit key.</span></span> <span data-ttu-id="4ac3a-245">隐式密钥<xref:System.Windows.DataTemplate>是<xref:System.Windows.DataTemplate.DataType%2A>属性值。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-245">The implicit key for a <xref:System.Windows.DataTemplate> is the <xref:System.Windows.DataTemplate.DataType%2A> property value.</span></span> <span data-ttu-id="4ac3a-246"><xref:System.Windows.DataTemplate.DataType%2A>此外可以指定为类型的名称，而不是使用显式[{x: Type...}](../../../../docs/framework/xaml-services/x-type-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="4ac3a-246"><xref:System.Windows.DataTemplate.DataType%2A> can also be specified as the name of the type rather than explicitly using [{x:Type...}](../../../../docs/framework/xaml-services/x-type-markup-extension.md).</span></span> <span data-ttu-id="4ac3a-247">有关详细信息，请参阅[数据模板化概述](../../../../docs/framework/wpf/data/data-templating-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="4ac3a-247">For details, see [Data Templating Overview](../../../../docs/framework/wpf/data/data-templating-overview.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="4ac3a-248">另请参阅</span><span class="sxs-lookup"><span data-stu-id="4ac3a-248">See Also</span></span>  
 <xref:System.Windows.ResourceDictionary>  
 [<span data-ttu-id="4ac3a-249">应用程序资源</span><span class="sxs-lookup"><span data-stu-id="4ac3a-249">Application Resources</span></span>](../../../../docs/framework/wpf/advanced/optimizing-performance-application-resources.md)  
 [<span data-ttu-id="4ac3a-250">资源和代码</span><span class="sxs-lookup"><span data-stu-id="4ac3a-250">Resources and Code</span></span>](../../../../docs/framework/wpf/advanced/resources-and-code.md)  
 [<span data-ttu-id="4ac3a-251">定义和引用资源</span><span class="sxs-lookup"><span data-stu-id="4ac3a-251">Define and Reference a Resource</span></span>](../../../../docs/framework/wpf/advanced/how-to-define-and-reference-a-resource.md)  
 [<span data-ttu-id="4ac3a-252">应用程序管理概述</span><span class="sxs-lookup"><span data-stu-id="4ac3a-252">Application Management Overview</span></span>](../../../../docs/framework/wpf/app-development/application-management-overview.md)  
 [<span data-ttu-id="4ac3a-253">x:Type 标记扩展</span><span class="sxs-lookup"><span data-stu-id="4ac3a-253">x:Type Markup Extension</span></span>](../../../../docs/framework/xaml-services/x-type-markup-extension.md)  
 [<span data-ttu-id="4ac3a-254">StaticResource 标记扩展</span><span class="sxs-lookup"><span data-stu-id="4ac3a-254">StaticResource Markup Extension</span></span>](../../../../docs/framework/wpf/advanced/staticresource-markup-extension.md)  
 [<span data-ttu-id="4ac3a-255">DynamicResource 标记扩展</span><span class="sxs-lookup"><span data-stu-id="4ac3a-255">DynamicResource Markup Extension</span></span>](../../../../docs/framework/wpf/advanced/dynamicresource-markup-extension.md)
