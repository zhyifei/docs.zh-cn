---
title: WPF 中的文档
ms.date: 03/30/2017
helpviewer_keywords:
- documents [WPF], packaging
- documents [WPF], text layout
- documents [WPF], XPS
- 'XPS documents [WPF], , '
- documents [WPF], controls
- documents [WPF], types of
- documents [WPF], browser-viewable
ms.assetid: 6e8db7bc-050a-4070-aa72-bb8c46e87ff8
ms.openlocfilehash: 36704d56b66de977ac7f63fd7e766c925ef9023b
ms.sourcegitcommit: f348c84443380a1959294cdf12babcb804cfa987
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/12/2019
ms.locfileid: "73974687"
---
# <a name="documents-in-wpf"></a><span data-ttu-id="1218d-102">WPF 中的文档</span><span class="sxs-lookup"><span data-stu-id="1218d-102">Documents in WPF</span></span>
[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] <span data-ttu-id="1218d-103">提供各种文档功能，使创建的高保真内容更易于访问和读取，而不是在以前的 Windows 版本中使用。</span><span class="sxs-lookup"><span data-stu-id="1218d-103">offers a wide range of document features that enable the creation of high-fidelity content that is designed to be more easily accessed and read than in previous generations of Windows.</span></span> <span data-ttu-id="1218d-104">除增强功能和质量外，[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 还对文档显示、打包和安全性能提供集成服务。</span><span class="sxs-lookup"><span data-stu-id="1218d-104">In addition to enhanced capabilities and quality, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] also provides integrated services for document display, packaging, and security.</span></span> <span data-ttu-id="1218d-105">本主题介绍 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 文档类型和文档打包。</span><span class="sxs-lookup"><span data-stu-id="1218d-105">This topic provides an introduction to [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] document types and document packaging.</span></span>  

<a name="types_of_documents"></a>   
## <a name="types-of-documents"></a><span data-ttu-id="1218d-106">文档类型</span><span class="sxs-lookup"><span data-stu-id="1218d-106">Types of Documents</span></span>  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="1218d-107">基于文档用途将文档分成两大类别；这些文档类别分别称为“固定文档”和“流文档”。</span><span class="sxs-lookup"><span data-stu-id="1218d-107">divides documents into two broad categories based on their intended use; these document categories are termed "fixed documents" and "flow documents."</span></span>  
  
 <span data-ttu-id="1218d-108">固定文档适用于需要精确的 "所见即所得" （WYSIWYG）表示形式的应用程序，而与所用的显示器或打印机硬件无关。</span><span class="sxs-lookup"><span data-stu-id="1218d-108">Fixed documents are intended for applications that require a precise "what you see is what you get" (WYSIWYG) presentation, independent of the display or printer hardware used.</span></span> <span data-ttu-id="1218d-109">固定文档的典型用途包括桌面发布、字处理和窗体布局，在这些情况下，遵循原始页面设计非常关键。</span><span class="sxs-lookup"><span data-stu-id="1218d-109">Typical uses for fixed documents include desktop publishing, word processing, and form layout, where adherence to the original page design is critical.</span></span> <span data-ttu-id="1218d-110">作为其布局的一部分，固定文档独立于所使用的显示或打印设备来对内容元素进行精确地定位安放。</span><span class="sxs-lookup"><span data-stu-id="1218d-110">As part of its layout, a fixed document maintains the precise positional placement of content elements independent of the display or print device in use.</span></span> <span data-ttu-id="1218d-111">例如，一个固定文档页面在 96 dpi 显示器上显示的效果与在 600 dpi 激光打印机或 4800 dpi 照相排字机上输出的效果是完全一样的。</span><span class="sxs-lookup"><span data-stu-id="1218d-111">For example, a fixed document page viewed on 96 dpi display will appear exactly the same when it is output to a 600 dpi laser printer as when it is output to a 4800 dpi phototypesetter.</span></span> <span data-ttu-id="1218d-112">虽然文档质量会根据每台设备的功能达到最优化，但是页面布局在所有情况下都保持不变。</span><span class="sxs-lookup"><span data-stu-id="1218d-112">The page layout remains the same in all cases, while the document quality maximizes to the capabilities of each device.</span></span>  
  
 <span data-ttu-id="1218d-113">比较而言，流文档旨在优化查看和可读性，因此，当易读性是文档的主要使用要求时，最适合使用流文档。</span><span class="sxs-lookup"><span data-stu-id="1218d-113">By comparison, flow documents are designed to optimize viewing and readability and are best utilized when ease of reading is the primary document consumption scenario.</span></span> <span data-ttu-id="1218d-114">流文档根据运行时变量（例如，窗口大小、设备分辨率和可选的用户首选项）来动态调整和重新排列内容，而不是设置为一个预定义的布局。</span><span class="sxs-lookup"><span data-stu-id="1218d-114">Rather than being set to one predefined layout, flow documents dynamically adjust and reflow their content based on run-time variables such as window size, device resolution, and optional user preferences.</span></span> <span data-ttu-id="1218d-115">网页就是流文档的一个简单示例，网页上的页面内容会动态调整格式以适应当前窗口。</span><span class="sxs-lookup"><span data-stu-id="1218d-115">A Web page is a simple example of a flow document where the page content is dynamically formatted to fit the current window.</span></span> <span data-ttu-id="1218d-116">流文档会基于运行时环境来优化用户的查看和阅读体验。</span><span class="sxs-lookup"><span data-stu-id="1218d-116">Flow documents optimize the viewing and reading experience for the user, based on the runtime environment.</span></span> <span data-ttu-id="1218d-117">例如，在高分辨率的 19 英寸显示器上或小型 2x3 英寸 PDA 屏幕上，同一流文档会动态调整格式以实现最佳可读性。</span><span class="sxs-lookup"><span data-stu-id="1218d-117">For example, the same flow document will dynamically reformat for optimal readability on either high-resolution 19-inch display or a small 2x3-inch PDA screen.</span></span> <span data-ttu-id="1218d-118">此外，流文档还具有很多内置功能，包括搜索、能够优化可读性的查看模式以及更改字体大小和外观的功能。</span><span class="sxs-lookup"><span data-stu-id="1218d-118">In addition, flow documents have a number of built in features including search, viewing modes that optimize readability, and the ability to change the size and appearance of fonts.</span></span>  <span data-ttu-id="1218d-119">有关流文档的演示、示例和详细信息，请参阅[流文档概述](flow-document-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="1218d-119">See [Flow Document Overview](flow-document-overview.md) for illustrations, examples, and in-depth information on flow documents.</span></span>  
  
<a name="document_viewer"></a>   
## <a name="document-controls-and-text-layout"></a><span data-ttu-id="1218d-120">文档控件和文本布局</span><span class="sxs-lookup"><span data-stu-id="1218d-120">Document Controls and Text Layout</span></span>  
 <span data-ttu-id="1218d-121">.NET Framework 提供了一组预建的控件，这些控件可简化在应用程序中使用固定文档、流文档和常规文本。</span><span class="sxs-lookup"><span data-stu-id="1218d-121">The .NET Framework provides a set of pre-built controls that simplify using fixed documents, flow documents, and general text within your application.</span></span>  <span data-ttu-id="1218d-122">使用 <xref:System.Windows.Controls.DocumentViewer> 控件支持显示固定文档内容。</span><span class="sxs-lookup"><span data-stu-id="1218d-122">The display of fixed document content is supported using the <xref:System.Windows.Controls.DocumentViewer> control.</span></span>  <span data-ttu-id="1218d-123">流文档内容的显示由三个不同的控件支持： <xref:System.Windows.Controls.FlowDocumentReader>、<xref:System.Windows.Controls.FlowDocumentPageViewer>和映射到不同用户方案的 <xref:System.Windows.Controls.FlowDocumentScrollViewer> （请参阅以下部分）。</span><span class="sxs-lookup"><span data-stu-id="1218d-123">Display of flow document content is supported by three different controls: <xref:System.Windows.Controls.FlowDocumentReader>, <xref:System.Windows.Controls.FlowDocumentPageViewer>, and <xref:System.Windows.Controls.FlowDocumentScrollViewer> which map to different user scenarios (see sections below).</span></span>  <span data-ttu-id="1218d-124">其他 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 控件提供简化的布局以支持常规文本使用（请参阅下面的[用户界面中的文本](#text_in_the_user_interface)）。</span><span class="sxs-lookup"><span data-stu-id="1218d-124">Other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] controls provide simplified layout to support general text uses (see [Text in the User Interface](#text_in_the_user_interface), below).</span></span>  
  
### <a name="fixed-document-control---documentviewer"></a><span data-ttu-id="1218d-125">固定文档控件 - DocumentViewer</span><span class="sxs-lookup"><span data-stu-id="1218d-125">Fixed Document Control - DocumentViewer</span></span>  
 <span data-ttu-id="1218d-126"><xref:System.Windows.Controls.DocumentViewer> 控件旨在显示 <xref:System.Windows.Documents.FixedDocument> 内容。</span><span class="sxs-lookup"><span data-stu-id="1218d-126">The <xref:System.Windows.Controls.DocumentViewer> control is designed to display <xref:System.Windows.Documents.FixedDocument> content.</span></span> <span data-ttu-id="1218d-127"><xref:System.Windows.Controls.DocumentViewer> 控件提供了一个直观的用户界面，该界面为常见操作（包括打印输出、复制到剪贴板、缩放和文本搜索功能）提供内置支持。</span><span class="sxs-lookup"><span data-stu-id="1218d-127">The <xref:System.Windows.Controls.DocumentViewer> control provides an intuitive user interface that provides built-in support for common operations including print output, copy to clipboard, zoom, and text search features.</span></span> <span data-ttu-id="1218d-128">此控件通过常见的滚动机制提供对页面内容的访问。</span><span class="sxs-lookup"><span data-stu-id="1218d-128">The control provides access to pages of content through a familiar scrolling mechanism.</span></span> <span data-ttu-id="1218d-129">与所有 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 控件一样，<xref:System.Windows.Controls.DocumentViewer> 支持完整或部分 restyling，这使得控件能够直观地集成到几乎任何应用程序或环境中。</span><span class="sxs-lookup"><span data-stu-id="1218d-129">Like all [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] controls, <xref:System.Windows.Controls.DocumentViewer> supports complete or partial restyling, which enables the control to be visually integrated into virtually any application or environment.</span></span>  
  
 <span data-ttu-id="1218d-130"><xref:System.Windows.Controls.DocumentViewer> 旨在以只读方式显示内容;编辑或修改内容不可用，因此不受支持。</span><span class="sxs-lookup"><span data-stu-id="1218d-130"><xref:System.Windows.Controls.DocumentViewer> is designed to display content in a read-only manner; editing or modification of content is not available and is not supported.</span></span>  
  
<a name="flow_document"></a>   
### <a name="flow-document-controls"></a><span data-ttu-id="1218d-131">流文档概述</span><span class="sxs-lookup"><span data-stu-id="1218d-131">Flow Document Controls</span></span>  

> [!NOTE]
> <span data-ttu-id="1218d-132">有关流文档功能以及如何创建它们的详细信息，请参阅[流文档概述](flow-document-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="1218d-132">For more detailed information on flow document features and how to create them, see [Flow Document Overview](flow-document-overview.md).</span></span>  
  
 <span data-ttu-id="1218d-133">以下三个控件支持流文档内容的显示： <xref:System.Windows.Controls.FlowDocumentReader>、<xref:System.Windows.Controls.FlowDocumentPageViewer>和 <xref:System.Windows.Controls.FlowDocumentScrollViewer>。</span><span class="sxs-lookup"><span data-stu-id="1218d-133">Display of flow document content is supported by three controls: <xref:System.Windows.Controls.FlowDocumentReader>, <xref:System.Windows.Controls.FlowDocumentPageViewer>, and <xref:System.Windows.Controls.FlowDocumentScrollViewer>.</span></span>  
  
#### <a name="flowdocumentreader"></a><span data-ttu-id="1218d-134">FlowDocumentReader</span><span class="sxs-lookup"><span data-stu-id="1218d-134">FlowDocumentReader</span></span>  
 <span data-ttu-id="1218d-135"><xref:System.Windows.Controls.FlowDocumentReader> 包括允许用户在各种查看模式之间进行动态选择的功能，包括单页（一次一页）查看模式、一次两页（书本阅读格式）查看模式和连续滚动（无限）查看模式。</span><span class="sxs-lookup"><span data-stu-id="1218d-135"><xref:System.Windows.Controls.FlowDocumentReader> includes features that enable the user to dynamically choose between various viewing modes, including a single-page (page-at-a-time) viewing mode, a two-page-at-a-time (book reading format) viewing mode, and a continuous scrolling (bottomless) viewing mode.</span></span>  <span data-ttu-id="1218d-136">有关这些查看模式的详细信息，请参阅 <xref:System.Windows.Controls.FlowDocumentReaderViewingMode>。</span><span class="sxs-lookup"><span data-stu-id="1218d-136">For more information about these viewing modes, see <xref:System.Windows.Controls.FlowDocumentReaderViewingMode>.</span></span>  <span data-ttu-id="1218d-137">如果不需要在不同查看模式之间动态切换的功能，请 <xref:System.Windows.Controls.FlowDocumentPageViewer> 和 <xref:System.Windows.Controls.FlowDocumentScrollViewer> 提供在特定查看模式下固定的轻型流内容查看器。</span><span class="sxs-lookup"><span data-stu-id="1218d-137">If you do not need the ability to dynamically switch between different viewing modes, <xref:System.Windows.Controls.FlowDocumentPageViewer> and <xref:System.Windows.Controls.FlowDocumentScrollViewer> provide lighter-weight flow content viewers that are fixed in a particular viewing mode.</span></span>  
  
#### <a name="flowdocumentpageviewer-and-flowdocumentscrollviewer"></a><span data-ttu-id="1218d-138">FlowDocumentPageViewer 和 FlowDocumentScrollViewer</span><span class="sxs-lookup"><span data-stu-id="1218d-138">FlowDocumentPageViewer and FlowDocumentScrollViewer</span></span>  
 <span data-ttu-id="1218d-139"><xref:System.Windows.Controls.FlowDocumentPageViewer> 以一次一页的查看模式显示内容，而 <xref:System.Windows.Controls.FlowDocumentScrollViewer> 以连续滚动模式显示内容。</span><span class="sxs-lookup"><span data-stu-id="1218d-139"><xref:System.Windows.Controls.FlowDocumentPageViewer> shows content in page-at-a-time viewing mode, while <xref:System.Windows.Controls.FlowDocumentScrollViewer> shows content in continuous scrolling mode.</span></span>  <span data-ttu-id="1218d-140"><xref:System.Windows.Controls.FlowDocumentPageViewer> 和 <xref:System.Windows.Controls.FlowDocumentScrollViewer> 都固定到特定的查看模式。</span><span class="sxs-lookup"><span data-stu-id="1218d-140">Both <xref:System.Windows.Controls.FlowDocumentPageViewer> and <xref:System.Windows.Controls.FlowDocumentScrollViewer> are fixed to a particular viewing mode.</span></span> <span data-ttu-id="1218d-141">与 <xref:System.Windows.Controls.FlowDocumentReader>比较，其中包括允许用户在各种查看模式（由 <xref:System.Windows.Controls.FlowDocumentReaderViewingMode> 枚举提供）之间进行动态选择的功能，成本比 <xref:System.Windows.Controls.FlowDocumentPageViewer> 或 <xref:System.Windows.Controls.FlowDocumentScrollViewer>更多的资源。</span><span class="sxs-lookup"><span data-stu-id="1218d-141">Compare to <xref:System.Windows.Controls.FlowDocumentReader>, which includes features that enable the user to dynamically choose between various viewing modes (as provided by the <xref:System.Windows.Controls.FlowDocumentReaderViewingMode> enumeration), at the cost of being more resource intensive than <xref:System.Windows.Controls.FlowDocumentPageViewer> or <xref:System.Windows.Controls.FlowDocumentScrollViewer>.</span></span>  
  
 <span data-ttu-id="1218d-142">默认情况下，总是显示垂直滚动条，而水平滚动条则在需要时显示。</span><span class="sxs-lookup"><span data-stu-id="1218d-142">By default, a vertical scrollbar is always shown, and a horizontal scrollbar becomes visible if needed.</span></span> <span data-ttu-id="1218d-143"><xref:System.Windows.Controls.FlowDocumentScrollViewer> 的默认 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 不包括工具栏;但 <xref:System.Windows.Controls.FlowDocumentScrollViewer.IsToolBarVisible%2A> 属性可用于启用内置工具栏。</span><span class="sxs-lookup"><span data-stu-id="1218d-143">The default [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] for <xref:System.Windows.Controls.FlowDocumentScrollViewer> does not include a toolbar; however, the <xref:System.Windows.Controls.FlowDocumentScrollViewer.IsToolBarVisible%2A> property can be used to enable a built-in toolbar.</span></span>  
  
<a name="text_in_the_user_interface"></a>   
### <a name="text-in-the-user-interface"></a><span data-ttu-id="1218d-144">用户界面中的文本</span><span class="sxs-lookup"><span data-stu-id="1218d-144">Text in the User Interface</span></span>  
 <span data-ttu-id="1218d-145">除可将文本添加到文档外，文本显然还可以用于应用程序 UI（如窗体）中。</span><span class="sxs-lookup"><span data-stu-id="1218d-145">Besides adding text to documents, text can obviously be used in application UI such as forms.</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="1218d-146">包括多个用于在屏幕中绘制文本的控件。</span><span class="sxs-lookup"><span data-stu-id="1218d-146">includes multiple controls for drawing text to the screen.</span></span> <span data-ttu-id="1218d-147">每个控件都面向不同的方案，并具有自己的功能和限制列表。</span><span class="sxs-lookup"><span data-stu-id="1218d-147">Each control is targeted to a different scenario and has its own list of features and limitations.</span></span> <span data-ttu-id="1218d-148">通常情况下，当需要有限的文本支持时，应使用 <xref:System.Windows.Controls.TextBlock> 元素，例如 [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]中的 brief 句子。</span><span class="sxs-lookup"><span data-stu-id="1218d-148">In general, the <xref:System.Windows.Controls.TextBlock> element should be used when limited text support is required, such as a brief sentence in a [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)].</span></span> <span data-ttu-id="1218d-149">需要最少文本支持时，可以使用 <xref:System.Windows.Controls.Label>。</span><span class="sxs-lookup"><span data-stu-id="1218d-149"><xref:System.Windows.Controls.Label> can be used when minimal text support is required.</span></span> <span data-ttu-id="1218d-150">有关详细信息，请参阅 [TextBlock 概述](../controls/textblock-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="1218d-150">For more information, see [TextBlock Overview](../controls/textblock-overview.md).</span></span>  
  
<a name="packaging"></a>   
## <a name="document-packaging"></a><span data-ttu-id="1218d-151">文档打包</span><span class="sxs-lookup"><span data-stu-id="1218d-151">Document Packaging</span></span>  
 <span data-ttu-id="1218d-152"><xref:System.IO.Packaging> Api 提供了一种高效的方法，可用于将应用程序数据、文档内容和相关资源组织到一个易于访问、可移植且易于分发的容器中。</span><span class="sxs-lookup"><span data-stu-id="1218d-152">The <xref:System.IO.Packaging> APIs provide an efficient means to organize application data, document content, and related resources in a single container that is simple to access, portable, and easy to distribute.</span></span> <span data-ttu-id="1218d-153">ZIP 文件是支持将多个对象作为单个单元进行保存的 <xref:System.IO.Packaging.Package> 类型的示例。</span><span class="sxs-lookup"><span data-stu-id="1218d-153">A ZIP file is an example of a <xref:System.IO.Packaging.Package> type capable of holding multiple objects as a single unit.</span></span> <span data-ttu-id="1218d-154">打包 Api 提供了一个默认的 <xref:System.IO.Packaging.ZipPackage> 实现，它使用 XML 和 ZIP 文件体系结构的开放打包约定标准。</span><span class="sxs-lookup"><span data-stu-id="1218d-154">The packaging APIs provide a default <xref:System.IO.Packaging.ZipPackage> implementation designed using an Open Packaging Conventions standard with XML and ZIP file architecture.</span></span> <span data-ttu-id="1218d-155">使用 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 打包 Api，可以轻松地创建包，并存储和访问这些包中的对象。</span><span class="sxs-lookup"><span data-stu-id="1218d-155">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] packaging APIs make it simple to create packages, and to store and access objects within them.</span></span> <span data-ttu-id="1218d-156">存储在 <xref:System.IO.Packaging.Package> 中的对象称为 <xref:System.IO.Packaging.PackagePart> （"part"）。</span><span class="sxs-lookup"><span data-stu-id="1218d-156">An object stored in a <xref:System.IO.Packaging.Package> is referred to as a <xref:System.IO.Packaging.PackagePart> ("part").</span></span> <span data-ttu-id="1218d-157">包还可包括已签名的数字证书，这些证书可用于标识部件的发信方以及验证包内容是否尚未修改。</span><span class="sxs-lookup"><span data-stu-id="1218d-157">Packages can also include signed digital certificates that can be used to identify the originator of a part and to validate that the contents of a package have not been modified.</span></span>  <span data-ttu-id="1218d-158">包还包括一项 <xref:System.IO.Packaging.PackageRelationship> 功能，该功能允许将附加信息添加到包或与特定部分关联，而无需实际修改现有部件的内容。</span><span class="sxs-lookup"><span data-stu-id="1218d-158">Packages also include a <xref:System.IO.Packaging.PackageRelationship> feature that allows additional information to be added to a package or associated with specific parts without actually modifying the content of existing parts.</span></span>  <span data-ttu-id="1218d-159">包服务还支持 Microsoft Windows Rights Management （RM）。</span><span class="sxs-lookup"><span data-stu-id="1218d-159">Package services also support Microsoft Windows Rights Management (RM).</span></span>  
  
 <span data-ttu-id="1218d-160">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 包体系结构用作大量关键技术的基础：</span><span class="sxs-lookup"><span data-stu-id="1218d-160">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Package architecture serves as the foundation for a number of key technologies:</span></span>  
  
- <span data-ttu-id="1218d-161">符合 XML 纸张规范（XPS）的 XPS 文档。</span><span class="sxs-lookup"><span data-stu-id="1218d-161">XPS documents conforming to the XML Paper Specification (XPS).</span></span>  
  
- <span data-ttu-id="1218d-162">Microsoft Office“12”开放式 XML 格式文档 (.docx)。</span><span class="sxs-lookup"><span data-stu-id="1218d-162">Microsoft Office "12" open XML format documents (.docx).</span></span>  
  
- <span data-ttu-id="1218d-163">用于个人应用程序设计的自定义存储格式。</span><span class="sxs-lookup"><span data-stu-id="1218d-163">Custom storage formats for your own application design.</span></span>  
  
 <span data-ttu-id="1218d-164">根据打包 Api，<xref:System.Windows.Xps.Packaging.XpsDocument> 专门为存储 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 固定内容文档而设计。</span><span class="sxs-lookup"><span data-stu-id="1218d-164">Based on the packaging APIs, an <xref:System.Windows.Xps.Packaging.XpsDocument> is specifically designed for storing [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] fixed content documents.</span></span> <span data-ttu-id="1218d-165"><xref:System.Windows.Xps.Packaging.XpsDocument> 是一种自包含文档，可在查看器中打开、显示在 <xref:System.Windows.Controls.DocumentViewer> 控件中、路由到打印假脱机或直接输出到 XPS 兼容的打印机。</span><span class="sxs-lookup"><span data-stu-id="1218d-165">An <xref:System.Windows.Xps.Packaging.XpsDocument> is a self-contained document that can be opened in a viewer, displayed in a <xref:System.Windows.Controls.DocumentViewer> control, routed to a print spool, or output directly to an XPS-compatible printer.</span></span>  
  
 <span data-ttu-id="1218d-166">以下各节提供了有关 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]提供的 <xref:System.IO.Packaging.Package> 和 <xref:System.Windows.Xps.Packaging.XpsDocument> Api 的其他信息。</span><span class="sxs-lookup"><span data-stu-id="1218d-166">The following sections provide additional information on the <xref:System.IO.Packaging.Package> and <xref:System.Windows.Xps.Packaging.XpsDocument> APIs provided with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span>  
  
<a name="packages"></a>   
### <a name="package-components"></a><span data-ttu-id="1218d-167">包组件</span><span class="sxs-lookup"><span data-stu-id="1218d-167">Package Components</span></span>  
 <span data-ttu-id="1218d-168">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 打包 API 允许将应用程序数据和文档组织成单个可移植单元。</span><span class="sxs-lookup"><span data-stu-id="1218d-168">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] packaging APIs allow application data and documents to be organized into a single portable unit.</span></span> <span data-ttu-id="1218d-169">ZIP 文件是最常见的包类型之一，并且是 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 附带的默认包类型。</span><span class="sxs-lookup"><span data-stu-id="1218d-169">A ZIP file is one of the most common types of packages and is the default package type provided with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span>  <span data-ttu-id="1218d-170"><xref:System.IO.Packaging.Package> 本身是一个抽象类，其中使用开放式标准 XML 和 ZIP 文件体系结构来实现 <xref:System.IO.Packaging.ZipPackage>。</span><span class="sxs-lookup"><span data-stu-id="1218d-170"><xref:System.IO.Packaging.Package> itself is an abstract class from which <xref:System.IO.Packaging.ZipPackage> is implemented using an open standard XML and ZIP file architecture.</span></span>  <span data-ttu-id="1218d-171">默认情况下，<xref:System.IO.Packaging.Package.Open%2A> 方法使用 <xref:System.IO.Packaging.ZipPackage> 创建和使用 ZIP 文件。</span><span class="sxs-lookup"><span data-stu-id="1218d-171">The <xref:System.IO.Packaging.Package.Open%2A> method uses <xref:System.IO.Packaging.ZipPackage> to create and use ZIP files by default.</span></span> <span data-ttu-id="1218d-172">包可以包含三种基本类型的项：</span><span class="sxs-lookup"><span data-stu-id="1218d-172">A package can contain three basic types of items:</span></span>  
  
|||  
|-|-|  
|<xref:System.IO.Packaging.PackagePart>|<span data-ttu-id="1218d-173">应用程序内容、数据、文档和资源文件。</span><span class="sxs-lookup"><span data-stu-id="1218d-173">Application content, data, documents, and resource files.</span></span>|  
|<xref:System.IO.Packaging.PackageDigitalSignature>|<span data-ttu-id="1218d-174">[X.509 证书] 用于标识、身份验证和验证。</span><span class="sxs-lookup"><span data-stu-id="1218d-174">[X.509 Certificate] for identification, authentication and validation.</span></span>|  
|<xref:System.IO.Packaging.PackageRelationship>|<span data-ttu-id="1218d-175">与包或特定部件相关的补充信息。</span><span class="sxs-lookup"><span data-stu-id="1218d-175">Added information related to the package or a specific part.</span></span>|  
  
<a name="PackageParts"></a>   
#### <a name="packageparts"></a><span data-ttu-id="1218d-176">PackageParts</span><span class="sxs-lookup"><span data-stu-id="1218d-176">PackageParts</span></span>  
 <span data-ttu-id="1218d-177"><xref:System.IO.Packaging.PackagePart> （"part"）是一个抽象类，它引用存储在 <xref:System.IO.Packaging.Package>中的对象。</span><span class="sxs-lookup"><span data-stu-id="1218d-177">A <xref:System.IO.Packaging.PackagePart> ("part") is an abstract class that refers to an object stored in a <xref:System.IO.Packaging.Package>.</span></span> <span data-ttu-id="1218d-178">在 ZIP 文件中，包的各个部件与存储在 ZIP 文件中的各个文件相对应。</span><span class="sxs-lookup"><span data-stu-id="1218d-178">In a ZIP file, the package parts correspond to the individual files stored within the ZIP file.</span></span>  <span data-ttu-id="1218d-179"><xref:System.IO.Packaging.ZipPackagePart> 提供 <xref:System.IO.Packaging.ZipPackage>中存储的可序列化对象的默认实现。</span><span class="sxs-lookup"><span data-stu-id="1218d-179"><xref:System.IO.Packaging.ZipPackagePart> provides the default implementation for serializable objects stored in a <xref:System.IO.Packaging.ZipPackage>.</span></span>  <span data-ttu-id="1218d-180">与文件系统类似，包中包含的部件存储在分层目录或“文件夹样式”组织中。</span><span class="sxs-lookup"><span data-stu-id="1218d-180">Like a file system, parts contained in the package are stored in hierarchical directory or "folder-style" organization.</span></span>  <span data-ttu-id="1218d-181">使用 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 打包 Api，应用程序可以使用单个 ZIP 文件容器来编写、存储和读取多个 <xref:System.IO.Packaging.PackagePart> 对象。</span><span class="sxs-lookup"><span data-stu-id="1218d-181">Using the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] packaging APIs, applications can write, store, and read multiple <xref:System.IO.Packaging.PackagePart> objects using a single ZIP file container.</span></span>  
  
<a name="PackageDigitalSignatures"></a>   
#### <a name="packagedigitalsignatures"></a><span data-ttu-id="1218d-182">PackageDigitalSignatures</span><span class="sxs-lookup"><span data-stu-id="1218d-182">PackageDigitalSignatures</span></span>  
 <span data-ttu-id="1218d-183">为安全，<xref:System.IO.Packaging.PackageDigitalSignature> （"数字签名"）可与包中的部件相关联。</span><span class="sxs-lookup"><span data-stu-id="1218d-183">For security, a <xref:System.IO.Packaging.PackageDigitalSignature> ("digital signature") can be associated with parts within a package.</span></span> <span data-ttu-id="1218d-184"><xref:System.IO.Packaging.PackageDigitalSignature> 包含了一个提供以下两个功能的 [509]：</span><span class="sxs-lookup"><span data-stu-id="1218d-184">A <xref:System.IO.Packaging.PackageDigitalSignature> incorporates a [509] that provides two features:</span></span>  
  
1. <span data-ttu-id="1218d-185">标识部件的发信方并对其进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="1218d-185">Identifies and authenticates the originator of the part.</span></span>  
  
2. <span data-ttu-id="1218d-186">验证部件是否尚未被修改。</span><span class="sxs-lookup"><span data-stu-id="1218d-186">Validates that the part has not been modified.</span></span>  
  
 <span data-ttu-id="1218d-187">数字签名不会阻止修改部件，但如果该部件已经以任何方式发生改变，则对该数字签名的验证检查将失败。</span><span class="sxs-lookup"><span data-stu-id="1218d-187">The digital signature does not preclude a part from being modified, but a validation check against the digital signature will fail if the part is altered in any way.</span></span> <span data-ttu-id="1218d-188">然后应用程序可采取适当的操作（例如，阻止打开部件，或通知用户该部件已修改，是不安全的）。</span><span class="sxs-lookup"><span data-stu-id="1218d-188">The application can then take appropriate action—for example, block opening the part or notify the user that the part has been modified and is not secure.</span></span>  
  
<a name="PackageRelationships"></a>   
#### <a name="packagerelationships"></a><span data-ttu-id="1218d-189">PackageRelationships</span><span class="sxs-lookup"><span data-stu-id="1218d-189">PackageRelationships</span></span>  
 <span data-ttu-id="1218d-190"><xref:System.IO.Packaging.PackageRelationship> （"关系"）提供了一种机制，用于将附加信息与包或包中的部件相关联。</span><span class="sxs-lookup"><span data-stu-id="1218d-190">A <xref:System.IO.Packaging.PackageRelationship> ("relationship") provides a mechanism for associating additional information with the package or a part within the package.</span></span> <span data-ttu-id="1218d-191">关系是一种包级别的设备，可以在未修改实际部件内容的情况下将其他信息与部件关联。</span><span class="sxs-lookup"><span data-stu-id="1218d-191">A relationship is a package-level facility that can associate additional information with a part without modifying the actual part content.</span></span> <span data-ttu-id="1218d-192">在许多情况下，直接向部件内容中插入新数据通常是不可行的：</span><span class="sxs-lookup"><span data-stu-id="1218d-192">Inserting new data directly into the part content of is usually not practical in many cases:</span></span>  
  
- <span data-ttu-id="1218d-193">部件及其内容架构的实际类型未知。</span><span class="sxs-lookup"><span data-stu-id="1218d-193">The actual type of the part and its content schema is not known.</span></span>  
  
- <span data-ttu-id="1218d-194">即使已知，内容架构可能也不会提供添加新信息的方式。</span><span class="sxs-lookup"><span data-stu-id="1218d-194">Even if known, the content schema might not provide a means for adding new information.</span></span>  
  
- <span data-ttu-id="1218d-195">部件可能已进行数字签名或加密，不能进行任何修改。</span><span class="sxs-lookup"><span data-stu-id="1218d-195">The part might be digitally signed or encrypted, precluding any modification.</span></span>  
  
 <span data-ttu-id="1218d-196">包关系提供一种可检测到的方式，用于添加其他信息并将该信息与各个部件或整个包关联。</span><span class="sxs-lookup"><span data-stu-id="1218d-196">Package relationships provide a discoverable means for adding and associating additional information with individual parts or with the entire package.</span></span> <span data-ttu-id="1218d-197">包关系具有两种主要功能：</span><span class="sxs-lookup"><span data-stu-id="1218d-197">Package relationships are used for two primary functions:</span></span>  
  
1. <span data-ttu-id="1218d-198">定义一个部件与另一个部件之间的依赖关系。</span><span class="sxs-lookup"><span data-stu-id="1218d-198">Defining dependency relationships from one part to another part.</span></span>  
  
2. <span data-ttu-id="1218d-199">定义添加注释或与部件相关的其他数据的信息关系。</span><span class="sxs-lookup"><span data-stu-id="1218d-199">Defining information relationships that add notes or other data related to the part.</span></span>  
  
 <span data-ttu-id="1218d-200"><xref:System.IO.Packaging.PackageRelationship> 提供了一种快速、可发现的方式来定义依赖项，并添加与包或包的一部分相关的其他信息。</span><span class="sxs-lookup"><span data-stu-id="1218d-200">A <xref:System.IO.Packaging.PackageRelationship> provides a quick, discoverable means to define dependencies and add other information associated with a part of the package or the package as a whole.</span></span>  
  
<a name="Dependency_Relationships"></a>   
##### <a name="dependency-relationships"></a><span data-ttu-id="1218d-201">依赖关系</span><span class="sxs-lookup"><span data-stu-id="1218d-201">Dependency Relationships</span></span>  
 <span data-ttu-id="1218d-202">依赖关系用于描述一个部件对其他部件的依赖性。</span><span class="sxs-lookup"><span data-stu-id="1218d-202">Dependency relationships are used to describe dependencies that one part makes to other parts.</span></span> <span data-ttu-id="1218d-203">例如，一个包可能包含一个 HTML 部件，该部件包括一个或多个 \<img> 图像标记。</span><span class="sxs-lookup"><span data-stu-id="1218d-203">For example, a package might contain an HTML part that includes one or more \<img> image tags.</span></span> <span data-ttu-id="1218d-204">此图像标记指的是作为包的其他内部部件或外部部件（可通过 Internet 访问）定位的图像。</span><span class="sxs-lookup"><span data-stu-id="1218d-204">The image tags refer to images that are located either as other parts internal to the package or external to the package (such as accessible over the Internet).</span></span> <span data-ttu-id="1218d-205">创建与 HTML 文件相关联的 <xref:System.IO.Packaging.PackageRelationship>，可以快速轻松地发现和访问从属资源。</span><span class="sxs-lookup"><span data-stu-id="1218d-205">Creating a <xref:System.IO.Packaging.PackageRelationship> associated with HTML file makes discovering and accessing the dependent resources quick and easy.</span></span> <span data-ttu-id="1218d-206">浏览器或查看器应用程序可以直接访问部件关系，并在无需了解架构或未分析文档的情况下立即开始汇编从属资源。</span><span class="sxs-lookup"><span data-stu-id="1218d-206">A browser or viewer application can directly access the part relationships and immediately begin assembling the dependent resources without knowing the schema or parsing the document.</span></span>  
  
<a name="Information_Relationships"></a>   
##### <a name="information-relationships"></a><span data-ttu-id="1218d-207">信息关系</span><span class="sxs-lookup"><span data-stu-id="1218d-207">Information Relationships</span></span>  
 <span data-ttu-id="1218d-208">与注释或批注类似，<xref:System.IO.Packaging.PackageRelationship> 还可用于存储其他类型的信息，以与部件关联，而无需实际修改部件内容本身。</span><span class="sxs-lookup"><span data-stu-id="1218d-208">Similar to a note or annotation, a <xref:System.IO.Packaging.PackageRelationship> can also be used to store other types of information to be associated with a part without having to actually modify the part content itself.</span></span>  
  
<a name="XPS_Documents"></a>   
## <a name="xps-documents"></a><span data-ttu-id="1218d-209">XPS 文档</span><span class="sxs-lookup"><span data-stu-id="1218d-209">XPS Documents</span></span>  
 <span data-ttu-id="1218d-210">XML 纸张规范（XPS）文档是一个包，其中包含一个或多个固定文档以及呈现所需的所有资源和信息。</span><span class="sxs-lookup"><span data-stu-id="1218d-210">XML Paper Specification (XPS) document is a package that contains one or more fixed-documents along with all the resources and information required for rendering.</span></span>  <span data-ttu-id="1218d-211">XPS 也是本机 Windows Vista 打印假脱机文件格式。</span><span class="sxs-lookup"><span data-stu-id="1218d-211">XPS is also the native Windows Vista print spool file format.</span></span>  <span data-ttu-id="1218d-212"><xref:System.Windows.Xps.Packaging.XpsDocument> 存储在标准 ZIP 数据集中，可以包含 XML 和二进制组件（如图像和字体文件）的组合。</span><span class="sxs-lookup"><span data-stu-id="1218d-212">An <xref:System.Windows.Xps.Packaging.XpsDocument> is stored in standard ZIP dataset, and can include a combination of XML and binary components, such as image and font files.</span></span> <span data-ttu-id="1218d-213">[PackageRelationships](#PackageRelationships) 用于定义内容和完全呈现文档所需的资源之间的依赖关系。</span><span class="sxs-lookup"><span data-stu-id="1218d-213">[PackageRelationships](#PackageRelationships) are used to define the dependencies between the content and the resources required to fully render the document.</span></span>  <span data-ttu-id="1218d-214"><xref:System.Windows.Xps.Packaging.XpsDocument> 的设计提供了支持多种用途的单个高保真文档解决方案：</span><span class="sxs-lookup"><span data-stu-id="1218d-214">The <xref:System.Windows.Xps.Packaging.XpsDocument> design provides a single, high-fidelity document solution that supports multiple uses:</span></span>  
  
- <span data-ttu-id="1218d-215">将固定文档内容和资源读取、写入和存储为单个可移植且易于分发的文件。</span><span class="sxs-lookup"><span data-stu-id="1218d-215">Reading, writing, and storing fixed-document content and resources as a single, portable, and easy-to-distribute file.</span></span>  
  
- <span data-ttu-id="1218d-216">显示包含 XPS 查看器应用程序的文档。</span><span class="sxs-lookup"><span data-stu-id="1218d-216">Displaying documents with the XPS Viewer application.</span></span>  
  
- <span data-ttu-id="1218d-217">以 Windows Vista 的本机打印后台输出格式输出文档。</span><span class="sxs-lookup"><span data-stu-id="1218d-217">Outputting documents in the native print spool output format of Windows Vista.</span></span>  
  
- <span data-ttu-id="1218d-218">将文档直接路由到与 XPS 兼容的打印机。</span><span class="sxs-lookup"><span data-stu-id="1218d-218">Routing documents directly to an XPS-compatible printer.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1218d-219">请参阅</span><span class="sxs-lookup"><span data-stu-id="1218d-219">See also</span></span>

- <xref:System.Windows.Documents.FixedDocument>
- <xref:System.Windows.Documents.FlowDocument>
- <xref:System.Windows.Xps.Packaging.XpsDocument>
- <xref:System.IO.Packaging.ZipPackage>
- <xref:System.IO.Packaging.ZipPackagePart>
- <xref:System.IO.Packaging.PackageRelationship>
- <xref:System.Windows.Controls.DocumentViewer>
- [<span data-ttu-id="1218d-220">文本</span><span class="sxs-lookup"><span data-stu-id="1218d-220">Text</span></span>](optimizing-performance-text.md)
- [<span data-ttu-id="1218d-221">流文档概述</span><span class="sxs-lookup"><span data-stu-id="1218d-221">Flow Document Overview</span></span>](flow-document-overview.md)
- [<span data-ttu-id="1218d-222">打印概述</span><span class="sxs-lookup"><span data-stu-id="1218d-222">Printing Overview</span></span>](printing-overview.md)
- [<span data-ttu-id="1218d-223">文档序列化和存储</span><span class="sxs-lookup"><span data-stu-id="1218d-223">Document Serialization and Storage</span></span>](document-serialization-and-storage.md)
