---
title: UI 自动化概述
ms.date: 03/30/2017
helpviewer_keywords:
- UI Automation, overview
- user interface, see UI
- accessibility, UI automation
ms.assetid: 65847654-9994-4a9e-b36d-2dd5d998770b
author: Xansky
ms.author: mhopkins
ms.openlocfilehash: 4c1b52622ccd70a591af3134642d4e0528bd32fb
ms.sourcegitcommit: 6b308cf6d627d78ee36dbbae8972a310ac7fd6c8
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 01/23/2019
ms.locfileid: "54681685"
---
# <a name="ui-automation-overview"></a><span data-ttu-id="f4de7-102">UI 自动化概述</span><span class="sxs-lookup"><span data-stu-id="f4de7-102">UI Automation Overview</span></span>
> [!NOTE]
>  <span data-ttu-id="f4de7-103">本文档适用于想要使用 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 命名空间中定义的托管 <xref:System.Windows.Automation> 类的 .NET Framework 开发人员。</span><span class="sxs-lookup"><span data-stu-id="f4de7-103">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="f4de7-104">有关最新信息[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]，请参阅[Windows 自动化 API:UI 自动化](https://go.microsoft.com/fwlink/?LinkID=156746)。</span><span class="sxs-lookup"><span data-stu-id="f4de7-104">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).</span></span>  
  
 [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] <span data-ttu-id="f4de7-105">是 [!INCLUDE[TLA#tla_win](../../../includes/tlasharptla-win-md.md)]的全新辅助功能框架，在所有支持 [!INCLUDE[TLA#tla_winclient](../../../includes/tlasharptla-winclient-md.md)]的操作系统上可用。</span><span class="sxs-lookup"><span data-stu-id="f4de7-105">is the new accessibility framework for [!INCLUDE[TLA#tla_win](../../../includes/tlasharptla-win-md.md)], available on all operating systems that support [!INCLUDE[TLA#tla_winclient](../../../includes/tlasharptla-winclient-md.md)].</span></span>  
  
 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="f4de7-106">提供对桌面上大多数 [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] 元素的编程访问，使辅助技术产品（如屏幕阅读器）能够使用标准输入以外的其他方式向最终用户提供有关 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 的信息并操纵 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="f4de7-106">provides programmatic access to most [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] elements on the desktop, enabling assistive technology products such as screen readers to provide information about the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] to end users and to manipulate the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] by means other than standard input.</span></span> [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="f4de7-107">也使自动化的测试脚本能够与 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]进行交互。</span><span class="sxs-lookup"><span data-stu-id="f4de7-107">also allows automated test scripts to interact with the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
> [!NOTE]
>  [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="f4de7-108">不会启用由不同用户通过“Run as”  命令启动的进程之间的通信。</span><span class="sxs-lookup"><span data-stu-id="f4de7-108">does not enable communication between processes started by different users through the **Run as** command.</span></span>  
  
 <span data-ttu-id="f4de7-109">UI 自动化客户端应用程序可在保证其将在多个框架上运行的情况下进行编写。</span><span class="sxs-lookup"><span data-stu-id="f4de7-109">UI Automation client applications can be written with the assurance that they will work on multiple frameworks.</span></span> <span data-ttu-id="f4de7-110">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 核心掩盖位于 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]各组成部分之下的框架中的任何差异。</span><span class="sxs-lookup"><span data-stu-id="f4de7-110">The [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] core masks any differences in the frameworks that underlie various pieces of [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="f4de7-111">例如在 `Content` 视图中， [!INCLUDE[TLA2#tla_winclient](../../../includes/tla2sharptla-winclient-md.md)] 按钮的 `Caption` 属性、 [!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)] 按钮的 `ALT` 属性、HTML 图像的 <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.Name%2A>属性全部映射到单个属性， [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="f4de7-111">For example, the `Content` property of a [!INCLUDE[TLA2#tla_winclient](../../../includes/tla2sharptla-winclient-md.md)] button, the `Caption` property of a [!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)] button, and the `ALT` property of an HTML image are all mapped to a single property, <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.Name%2A>, in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] view.</span></span>  
  
 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="f4de7-112">在 [!INCLUDE[TLA#tla_longhorn](../../../includes/tlasharptla-longhorn-md.md)]、 [!INCLUDE[TLA#tla_winxp](../../../includes/tlasharptla-winxp-md.md)]和 [!INCLUDE[TLA2#tla_winnetsvrfam](../../../includes/tla2sharptla-winnetsvrfam-md.md)]中提供完整功能。</span><span class="sxs-lookup"><span data-stu-id="f4de7-112">provides full functionality in [!INCLUDE[TLA#tla_longhorn](../../../includes/tlasharptla-longhorn-md.md)], [!INCLUDE[TLA#tla_winxp](../../../includes/tlasharptla-winxp-md.md)], and [!INCLUDE[TLA2#tla_winnetsvrfam](../../../includes/tla2sharptla-winnetsvrfam-md.md)].</span></span>  
  
 <span data-ttu-id="f4de7-113">UI 自动化提供程序通过内置的桥接服务提供了一些对 [!INCLUDE[TLA#tla_aa](../../../includes/tlasharptla-aa-md.md)] 客户端应用程序的支持。</span><span class="sxs-lookup"><span data-stu-id="f4de7-113">UI Automation providers offer some support for [!INCLUDE[TLA#tla_aa](../../../includes/tlasharptla-aa-md.md)] client applications, through a built-in bridging service.</span></span>  
  
<a name="Providers_and_Clients"></a>   
## <a name="providers-and-clients"></a><span data-ttu-id="f4de7-114">提供程序和客户端</span><span class="sxs-lookup"><span data-stu-id="f4de7-114">Providers and Clients</span></span>  
 <span data-ttu-id="f4de7-115">如下表所示，[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 具有四个主要组件。</span><span class="sxs-lookup"><span data-stu-id="f4de7-115">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] has four main components, as shown in the following table.</span></span>  
  
|<span data-ttu-id="f4de7-116">组件</span><span class="sxs-lookup"><span data-stu-id="f4de7-116">Component</span></span>|<span data-ttu-id="f4de7-117">描述</span><span class="sxs-lookup"><span data-stu-id="f4de7-117">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="f4de7-118">提供程序 [!INCLUDE[TLA#tla_api](../../../includes/tlasharptla-api-md.md)] （UIAutomationProvider.dll 和 UIAutomationTypes.dll）</span><span class="sxs-lookup"><span data-stu-id="f4de7-118">Provider [!INCLUDE[TLA#tla_api](../../../includes/tlasharptla-api-md.md)] (UIAutomationProvider.dll and UIAutomationTypes.dll)</span></span>|<span data-ttu-id="f4de7-119">一组接口定义，它们由 UI 自动化提供程序、提供关于 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 元素信息并响应编程输入的对象来实现。</span><span class="sxs-lookup"><span data-stu-id="f4de7-119">A set of interface definitions that are implemented by UI Automation providers, objects that provide information about [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] elements and respond to programmatic input.</span></span>|  
|<span data-ttu-id="f4de7-120">客户端 API（UIAutomationClient.dll 和 UIAutomationTypes.dll）</span><span class="sxs-lookup"><span data-stu-id="f4de7-120">Client API (UIAutomationClient.dll and UIAutomationTypes.dll)</span></span>|<span data-ttu-id="f4de7-121">一组托管代码的类型，它们使 UI 自动化客户端应用程序可以获取有关 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 的信息，并将输入发送到控件。</span><span class="sxs-lookup"><span data-stu-id="f4de7-121">A set of types for managed code that enables UI Automation client applications to obtain information about the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] and to send input to controls.</span></span>|  
|<span data-ttu-id="f4de7-122">UiAutomationCore.dll</span><span class="sxs-lookup"><span data-stu-id="f4de7-122">UiAutomationCore.dll</span></span>|<span data-ttu-id="f4de7-123">用于处理提供程序和客户端之间通信的基础代码（有时称为 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 核心）。</span><span class="sxs-lookup"><span data-stu-id="f4de7-123">The underlying code (sometimes called the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] core) that handles communication between providers and clients.</span></span>|  
|<span data-ttu-id="f4de7-124">UIAutomationClientsideProviders.dll</span><span class="sxs-lookup"><span data-stu-id="f4de7-124">UIAutomationClientsideProviders.dll</span></span>|<span data-ttu-id="f4de7-125">一组用于标准旧版本控件的 UI 自动化提供程序。</span><span class="sxs-lookup"><span data-stu-id="f4de7-125">A set of UI Automation providers for standard legacy controls.</span></span> <span data-ttu-id="f4de7-126">（[!INCLUDE[TLA2#tla_winclient](../../../includes/tla2sharptla-winclient-md.md)] 控件具有对 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 的本机支持。）此支持自动提供给客户端应用程序。</span><span class="sxs-lookup"><span data-stu-id="f4de7-126">([!INCLUDE[TLA2#tla_winclient](../../../includes/tla2sharptla-winclient-md.md)] controls have native support for [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].) This support is automatically available to client applications.</span></span>|  
  
 <span data-ttu-id="f4de7-127">从软件开发人员的角度来看，有以下两种使用 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]的方式：创建对自定义控件的支持（使用提供程序 API），创建使用 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 核心以与 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 元素通信的应用程序（使用客户端 API）。</span><span class="sxs-lookup"><span data-stu-id="f4de7-127">From the software developer's perspective, there are two ways of using [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]: to create support for custom controls (using the provider API), and creating applications that use the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] core to communicate with [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] elements (using the client API).</span></span> <span data-ttu-id="f4de7-128">具体取决于侧重点，你应参考文档中的其他部分。</span><span class="sxs-lookup"><span data-stu-id="f4de7-128">Depending on your focus, you should refer to different parts of the documentation.</span></span> <span data-ttu-id="f4de7-129">你可在以下各节中进一步了解概念并获得实际操作知识。</span><span class="sxs-lookup"><span data-stu-id="f4de7-129">You can learn more about the concepts and gain practical how-to knowledge in the following sections.</span></span>  
  
|<span data-ttu-id="f4de7-130">节</span><span class="sxs-lookup"><span data-stu-id="f4de7-130">Section</span></span>|<span data-ttu-id="f4de7-131">行业专家</span><span class="sxs-lookup"><span data-stu-id="f4de7-131">Subject matter</span></span>|<span data-ttu-id="f4de7-132">读者</span><span class="sxs-lookup"><span data-stu-id="f4de7-132">Audience</span></span>|  
|-------------|--------------------|--------------|  
|<span data-ttu-id="f4de7-133">[UI 自动化基础知识](../../../docs/framework/ui-automation/index.md)（本节）</span><span class="sxs-lookup"><span data-stu-id="f4de7-133">[UI Automation Fundamentals](../../../docs/framework/ui-automation/index.md) (this section)</span></span>|<span data-ttu-id="f4de7-134">对概念的广泛概述。</span><span class="sxs-lookup"><span data-stu-id="f4de7-134">Broad overviews of the concepts.</span></span>|<span data-ttu-id="f4de7-135">全部。</span><span class="sxs-lookup"><span data-stu-id="f4de7-135">All.</span></span>|  
|[<span data-ttu-id="f4de7-136">托管代码的 UI 自动化提供程序</span><span class="sxs-lookup"><span data-stu-id="f4de7-136">UI Automation Providers for Managed Code</span></span>](../../../docs/framework/ui-automation/ui-automation-providers-for-managed-code.md)|<span data-ttu-id="f4de7-137">可帮助你使用提供程序 API 的概述和帮助主题。</span><span class="sxs-lookup"><span data-stu-id="f4de7-137">Overviews and how-to topics to help you use the provider API.</span></span>|<span data-ttu-id="f4de7-138">控件开发人员。</span><span class="sxs-lookup"><span data-stu-id="f4de7-138">Control developers.</span></span>|  
|[<span data-ttu-id="f4de7-139">托管代码的 UI 自动化客户端</span><span class="sxs-lookup"><span data-stu-id="f4de7-139">UI Automation Clients for Managed Code</span></span>](../../../docs/framework/ui-automation/ui-automation-clients-for-managed-code.md)|<span data-ttu-id="f4de7-140">可帮助你使用客户端 API 的概述和帮助主题。</span><span class="sxs-lookup"><span data-stu-id="f4de7-140">Overviews and how-to topics to help you use the client API.</span></span>|<span data-ttu-id="f4de7-141">客户端应用程序开发人员。</span><span class="sxs-lookup"><span data-stu-id="f4de7-141">Client application developers.</span></span>|  
|[<span data-ttu-id="f4de7-142">UI 自动化控件模式</span><span class="sxs-lookup"><span data-stu-id="f4de7-142">UI Automation Control Patterns</span></span>](../../../docs/framework/ui-automation/ui-automation-control-patterns.md)|<span data-ttu-id="f4de7-143">有关提供程序应如何实现控件模式以及哪些功能可供客户端使用的信息。</span><span class="sxs-lookup"><span data-stu-id="f4de7-143">Information about how control patterns should be implemented by providers, and what functionality is available to clients.</span></span>|<span data-ttu-id="f4de7-144">全部。</span><span class="sxs-lookup"><span data-stu-id="f4de7-144">All.</span></span>|  
|[<span data-ttu-id="f4de7-145">UI 自动化文本模式</span><span class="sxs-lookup"><span data-stu-id="f4de7-145">UI Automation Text Pattern</span></span>](../../../docs/framework/ui-automation/ui-automation-text-pattern.md)|<span data-ttu-id="f4de7-146">有关提供程序应如何实现 Text 控件模式以及哪些功能可供客户端使用的信息。</span><span class="sxs-lookup"><span data-stu-id="f4de7-146">Information about how the Text control pattern should be implemented by providers, and what functionality is available to clients.</span></span>|<span data-ttu-id="f4de7-147">全部。</span><span class="sxs-lookup"><span data-stu-id="f4de7-147">All.</span></span>|  
|[<span data-ttu-id="f4de7-148">UI Automation Control Types</span><span class="sxs-lookup"><span data-stu-id="f4de7-148">UI Automation Control Types</span></span>](../../../docs/framework/ui-automation/ui-automation-control-types.md)|<span data-ttu-id="f4de7-149">有关不同控件类型支持的属性和控件模式的信息。</span><span class="sxs-lookup"><span data-stu-id="f4de7-149">Information about the properties and control patterns supported by different control types.</span></span>|<span data-ttu-id="f4de7-150">全部。</span><span class="sxs-lookup"><span data-stu-id="f4de7-150">All.</span></span>|  
  
 <span data-ttu-id="f4de7-151">下表列出 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 命名空间、包含这些命名空间的 DLL 以及使用它们的受众。</span><span class="sxs-lookup"><span data-stu-id="f4de7-151">The following table lists [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] namespaces, the DLLs that contain them, and the audience that uses them.</span></span>  
  
|<span data-ttu-id="f4de7-152">命名空间</span><span class="sxs-lookup"><span data-stu-id="f4de7-152">Namespace</span></span>|<span data-ttu-id="f4de7-153">被引用的 DLL</span><span class="sxs-lookup"><span data-stu-id="f4de7-153">Referenced DLLs</span></span>|<span data-ttu-id="f4de7-154">读者</span><span class="sxs-lookup"><span data-stu-id="f4de7-154">Audience</span></span>|  
|---------------|---------------------|--------------|  
|<xref:System.Windows.Automation>|<span data-ttu-id="f4de7-155">UIAutomationClientUIAutomationTypes</span><span class="sxs-lookup"><span data-stu-id="f4de7-155">UIAutomationClientUIAutomationTypes</span></span>|<span data-ttu-id="f4de7-156">UI 自动化客户端开发人员；用于查找 <xref:System.Windows.Automation.AutomationElement> 对象、注册 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 事件，并使用 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 控件模式。</span><span class="sxs-lookup"><span data-stu-id="f4de7-156">UI Automation client developers; used to find <xref:System.Windows.Automation.AutomationElement> objects, register for [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] events, and work with [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] control patterns.</span></span>|  
|<xref:System.Windows.Automation.Provider>|<span data-ttu-id="f4de7-157">UIAutomationProviderUIAutomationTypes</span><span class="sxs-lookup"><span data-stu-id="f4de7-157">UIAutomationProviderUIAutomationTypes</span></span>|<span data-ttu-id="f4de7-158">[!INCLUDE[TLA2#tla_winclient](../../../includes/tla2sharptla-winclient-md.md)]以外的其他框架的 UI 自动化提供程序的开发人员。</span><span class="sxs-lookup"><span data-stu-id="f4de7-158">Developers of UI Automation providers for frameworks other than [!INCLUDE[TLA2#tla_winclient](../../../includes/tla2sharptla-winclient-md.md)].</span></span>|  
|<xref:System.Windows.Automation.Text>|<span data-ttu-id="f4de7-159">UIAutomationClientUIAutomationTypes</span><span class="sxs-lookup"><span data-stu-id="f4de7-159">UIAutomationClientUIAutomationTypes</span></span>|<span data-ttu-id="f4de7-160">[!INCLUDE[TLA2#tla_winclient](../../../includes/tla2sharptla-winclient-md.md)]以外的其他框架的 UI 自动化提供程序的开发人员；用于实现 TextPattern 控件模式。</span><span class="sxs-lookup"><span data-stu-id="f4de7-160">Developers of UI Automation providers for frameworks other than [!INCLUDE[TLA2#tla_winclient](../../../includes/tla2sharptla-winclient-md.md)]; used to implement the TextPattern control pattern.</span></span>|  
|<xref:System.Windows.Automation.Peers>|<span data-ttu-id="f4de7-161">PresentationFramework</span><span class="sxs-lookup"><span data-stu-id="f4de7-161">PresentationFramework</span></span>|<span data-ttu-id="f4de7-162">[!INCLUDE[TLA2#tla_winclient](../../../includes/tla2sharptla-winclient-md.md)]的 UI 自动化提供程序的开发人员。</span><span class="sxs-lookup"><span data-stu-id="f4de7-162">Developers of UI Automation providers for [!INCLUDE[TLA2#tla_winclient](../../../includes/tla2sharptla-winclient-md.md)].</span></span>|  
  
<a name="UI_Automation_Model"></a>   
## <a name="ui-automation-model"></a><span data-ttu-id="f4de7-163">UI 自动化模型</span><span class="sxs-lookup"><span data-stu-id="f4de7-163">UI Automation Model</span></span>  
 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="f4de7-164">将 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 的每个部分向客户端应用程序公开为 <xref:System.Windows.Automation.AutomationElement>。</span><span class="sxs-lookup"><span data-stu-id="f4de7-164">exposes every piece of the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] to client applications as an <xref:System.Windows.Automation.AutomationElement>.</span></span> <span data-ttu-id="f4de7-165">元素包含在树状结构，而桌面作为根元素。</span><span class="sxs-lookup"><span data-stu-id="f4de7-165">Elements are contained in a tree structure, with the desktop as the root element.</span></span> <span data-ttu-id="f4de7-166">客户端可将树的原始视图筛选为控件视图或内容视图。</span><span class="sxs-lookup"><span data-stu-id="f4de7-166">Clients can filter the raw view of the tree as a control view or a content view.</span></span> <span data-ttu-id="f4de7-167">应用程序还可以创建自定义视图。</span><span class="sxs-lookup"><span data-stu-id="f4de7-167">Applications can also create custom views.</span></span>  
  
 <span data-ttu-id="f4de7-168"><xref:System.Windows.Automation.AutomationElement> 对象公开它们所代表的 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 元素的公共属性。</span><span class="sxs-lookup"><span data-stu-id="f4de7-168"><xref:System.Windows.Automation.AutomationElement> objects expose common properties of the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] elements they represent.</span></span> <span data-ttu-id="f4de7-169">这些属性之一则是控件类型，它将其基本外观和功能定义为单个可识别的实体：如按钮或复选框。</span><span class="sxs-lookup"><span data-stu-id="f4de7-169">One of these properties is the control type, which defines its basic appearance and functionality as a single recognizable entity: for example, a button or check box.</span></span>  
  
 <span data-ttu-id="f4de7-170">此外，元素公开向其控件类型提供特定属性的控件模式。</span><span class="sxs-lookup"><span data-stu-id="f4de7-170">In addition, elements expose control patterns that provide properties specific to their control types.</span></span> <span data-ttu-id="f4de7-171">控件模式还公开方法，使客户端获取有关该元素的详细信息，并提供输入。</span><span class="sxs-lookup"><span data-stu-id="f4de7-171">Control patterns also expose methods that enable clients to get further information about the element and to provide input.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="f4de7-172">控件类型和控件模式之间并无一一对应关系。</span><span class="sxs-lookup"><span data-stu-id="f4de7-172">There is not a one-to-one correspondence between control types and control patterns.</span></span> <span data-ttu-id="f4de7-173">一个控件模式可被多个控件类型支持，且一个控件可支持多个控件模式，两者均公开其行为的不同方面。</span><span class="sxs-lookup"><span data-stu-id="f4de7-173">A control pattern may be supported by multiple control types, and a control may support multiple control patterns, each of which exposes different aspects of its behavior.</span></span> <span data-ttu-id="f4de7-174">例如，组合框中至少具有两个控件模式：一个表示可展开和折叠的功能，另一个代表选择机制。</span><span class="sxs-lookup"><span data-stu-id="f4de7-174">For example, a combo box has at least two control patterns: one that represents its ability to expand and collapse, and another that represents the selection mechanism.</span></span> <span data-ttu-id="f4de7-175">有关详细信息，请参阅 [UI Automation Control Types](../../../docs/framework/ui-automation/ui-automation-control-types.md)。</span><span class="sxs-lookup"><span data-stu-id="f4de7-175">For specifics, see [UI Automation Control Types](../../../docs/framework/ui-automation/ui-automation-control-types.md).</span></span>  
  
 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="f4de7-176">同样通过事件向客户端应用程序提供信息。</span><span class="sxs-lookup"><span data-stu-id="f4de7-176">also provides information to client applications through events.</span></span> <span data-ttu-id="f4de7-177">与 [!INCLUDE[TLA2#tla_winevents](../../../includes/tla2sharptla-winevents-md.md)]不同， [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 事件不基于广播的机制。</span><span class="sxs-lookup"><span data-stu-id="f4de7-177">Unlike [!INCLUDE[TLA2#tla_winevents](../../../includes/tla2sharptla-winevents-md.md)], [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] events are not based on a broadcast mechanism.</span></span> [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="f4de7-178">客户端注册特定的事件通知且可以请求将特定 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 属性和控件模式信息传递给其事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="f4de7-178">clients register for specific event notifications and can request that specific [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] properties and control pattern information be passed into their event handlers.</span></span> <span data-ttu-id="f4de7-179">此外， [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 事件包含对引发它的元素的引用。</span><span class="sxs-lookup"><span data-stu-id="f4de7-179">In addition, a [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] event contains a reference to the element that raised it.</span></span> <span data-ttu-id="f4de7-180">提供程序可以通过有选择地引发事件来提高性能，具体取决于任一客户端是否正在进行侦听。</span><span class="sxs-lookup"><span data-stu-id="f4de7-180">Providers can improve performance by raising events selectively, depending on whether any clients are listening.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f4de7-181">请参阅</span><span class="sxs-lookup"><span data-stu-id="f4de7-181">See also</span></span>
- [<span data-ttu-id="f4de7-182">UI 自动化树概述</span><span class="sxs-lookup"><span data-stu-id="f4de7-182">UI Automation Tree Overview</span></span>](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)
- [<span data-ttu-id="f4de7-183">UI 自动化控件模式概述</span><span class="sxs-lookup"><span data-stu-id="f4de7-183">UI Automation Control Patterns Overview</span></span>](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)
- [<span data-ttu-id="f4de7-184">UI 自动化属性概述</span><span class="sxs-lookup"><span data-stu-id="f4de7-184">UI Automation Properties Overview</span></span>](../../../docs/framework/ui-automation/ui-automation-properties-overview.md)
- [<span data-ttu-id="f4de7-185">UI 自动化事件概述</span><span class="sxs-lookup"><span data-stu-id="f4de7-185">UI Automation Events Overview</span></span>](../../../docs/framework/ui-automation/ui-automation-events-overview.md)
- [<span data-ttu-id="f4de7-186">UI 自动化安全性概述</span><span class="sxs-lookup"><span data-stu-id="f4de7-186">UI Automation Security Overview</span></span>](../../../docs/framework/ui-automation/ui-automation-security-overview.md)
