---
title: UI 自动化树概述
ms.date: 03/30/2017
helpviewer_keywords:
- automation tree
- UI Automation, tree
ms.assetid: 03b98058-bdb3-47a0-8ff7-45e6cdf67166
ms.openlocfilehash: 19e416271e0c6e717a46821569983a250ef0ae0b
ms.sourcegitcommit: 58fc0e6564a37fa1b9b1b140a637e864c4cf696e
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/08/2019
ms.locfileid: "57675571"
---
# <a name="ui-automation-tree-overview"></a><span data-ttu-id="315e0-102">UI 自动化树概述</span><span class="sxs-lookup"><span data-stu-id="315e0-102">UI Automation Tree Overview</span></span>
> [!NOTE]
>  <span data-ttu-id="315e0-103">本文档适用于想要使用 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 命名空间中定义的托管 <xref:System.Windows.Automation> 类的 .NET Framework 开发人员。</span><span class="sxs-lookup"><span data-stu-id="315e0-103">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="315e0-104">有关最新信息[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]，请参阅[Windows 自动化 API:UI 自动化](https://go.microsoft.com/fwlink/?LinkID=156746)。</span><span class="sxs-lookup"><span data-stu-id="315e0-104">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).</span></span>  
  
 <span data-ttu-id="315e0-105">辅助技术产品和测试脚本通过在 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 树中导航来收集有关 [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] 及其元素的信息。</span><span class="sxs-lookup"><span data-stu-id="315e0-105">Assistive technology products and test scripts navigate the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree to gather information about the [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] and its elements.</span></span>  
  
 <span data-ttu-id="315e0-106">内[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]存在树是根元素 (<xref:System.Windows.Automation.AutomationElement.RootElement%2A>)，它表示当前桌面和元素的子元素表示应用程序窗口。</span><span class="sxs-lookup"><span data-stu-id="315e0-106">Within the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree there is a root element (<xref:System.Windows.Automation.AutomationElement.RootElement%2A>) that represents the current desktop and whose child elements represent application windows.</span></span> <span data-ttu-id="315e0-107">其中的每个子元素都可以包含表示 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 的各个部分（如菜单、按钮、工具栏和列表框）的元素。</span><span class="sxs-lookup"><span data-stu-id="315e0-107">Each of these child elements can contain elements representing pieces of [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] such as menus, buttons, toolbars, and list boxes.</span></span> <span data-ttu-id="315e0-108">这些子元素又可以包含列表项之类的元素。</span><span class="sxs-lookup"><span data-stu-id="315e0-108">These elements in turn can contain elements such as list items.</span></span>  
  
 <span data-ttu-id="315e0-109">
  [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 树的结构不固定，由于它可能包含数千个元素，因此它很少全部显示出来。</span><span class="sxs-lookup"><span data-stu-id="315e0-109">The [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree is not a fixed structure and is seldom seen in its totality because it might contain thousands of elements.</span></span> <span data-ttu-id="315e0-110">可以根据需要生成树的某些部分，添加、移动或删除元素时，树也会发生相应更改。</span><span class="sxs-lookup"><span data-stu-id="315e0-110">Parts of it are built as they are needed, and it can undergo changes as elements are added, moved, or removed.</span></span>  
  
 <span data-ttu-id="315e0-111">UI 自动化提供程序通过实现片段（由一个通常承载在窗口中的根元素和一个子树组成）中各项之间的导航来支持 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 树。</span><span class="sxs-lookup"><span data-stu-id="315e0-111">UI Automation providers support the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree by implementing navigation among items within a fragment, which consists of a root (usually hosted in a window) and a subtree.</span></span> <span data-ttu-id="315e0-112">但是，提供程序并不参与控件之间的导航。</span><span class="sxs-lookup"><span data-stu-id="315e0-112">However, providers are not concerned with navigation from one control to another.</span></span> <span data-ttu-id="315e0-113">控件之间的导航是由 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 核心借助于默认窗口提供程序中的信息来管理的。</span><span class="sxs-lookup"><span data-stu-id="315e0-113">This is managed by the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] core, using information from the default window providers.</span></span>  
  
<a name="uiautomation_tree_view"></a>   
## <a name="views-of-the-automation-tree"></a><span data-ttu-id="315e0-114">自动化树的视图</span><span class="sxs-lookup"><span data-stu-id="315e0-114">Views of the Automation Tree</span></span>  
 <span data-ttu-id="315e0-115">可以对 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 树进行筛选，以便创建仅包含与特定客户端相关的 <xref:System.Windows.Automation.AutomationElement> 对象的视图。</span><span class="sxs-lookup"><span data-stu-id="315e0-115">The [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree can be filtered to create views that contain only those <xref:System.Windows.Automation.AutomationElement> objects relevant for a particular client.</span></span> <span data-ttu-id="315e0-116">此方法允许客户端根据各自的具体需求来自定义通过 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 表示的结构。</span><span class="sxs-lookup"><span data-stu-id="315e0-116">This approach allows clients to customize the structure presented through [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] to their particular needs.</span></span>  
  
 <span data-ttu-id="315e0-117">客户端可以通过以下两种方法来自定义视图：设置范围和筛选。</span><span class="sxs-lookup"><span data-stu-id="315e0-117">The client has two ways of customizing the view: by scoping and by filtering.</span></span> <span data-ttu-id="315e0-118">设置范围是指从基元素开始定义视图的范围，例如，应用程序可能希望仅查找桌面的直接子级，或者查找某个应用程序窗口的所有后代。</span><span class="sxs-lookup"><span data-stu-id="315e0-118">Scoping is defining the extent of the view, starting from a base element: for example, the application might want to find only direct children of the desktop, or all descendants of an application window.</span></span> <span data-ttu-id="315e0-119">筛选是指定义要包括在视图中的元素类型。</span><span class="sxs-lookup"><span data-stu-id="315e0-119">Filtering is defining the types of elements that are to be included in the view.</span></span>  
  
 <span data-ttu-id="315e0-120">UI 自动化提供程序通过定义元素的属性（包括 <xref:System.Windows.Automation.AutomationElementIdentifiers.IsControlElementProperty> 和 <xref:System.Windows.Automation.AutomationElementIdentifiers.IsContentElementProperty> 属性）来支持筛选。</span><span class="sxs-lookup"><span data-stu-id="315e0-120">UI Automation providers support filtering by defining properties on elements, including the <xref:System.Windows.Automation.AutomationElementIdentifiers.IsControlElementProperty> and <xref:System.Windows.Automation.AutomationElementIdentifiers.IsContentElementProperty> properties.</span></span>  
  
 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="315e0-121">提供三个默认视图。</span><span class="sxs-lookup"><span data-stu-id="315e0-121">provides three default views.</span></span> <span data-ttu-id="315e0-122">这些视图由所执行筛选的类型定义；任何视图的范围都是由应用程序定义的。</span><span class="sxs-lookup"><span data-stu-id="315e0-122">These views are defined by the type of filtering performed; the scope of any view is defined by the application.</span></span> <span data-ttu-id="315e0-123">另外，应用程序可以向属性应用其他筛选器，例如，在控件视图中仅包含已启用的控件。</span><span class="sxs-lookup"><span data-stu-id="315e0-123">In addition, the application can apply other filters on properties; for example, to include only enabled controls in a control view.</span></span>  
  
<a name="uiautomation_raw_view"></a>   
### <a name="raw-view"></a><span data-ttu-id="315e0-124">原始视图</span><span class="sxs-lookup"><span data-stu-id="315e0-124">Raw View</span></span>  
 <span data-ttu-id="315e0-125">
  [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 树的原始视图是 <xref:System.Windows.Automation.AutomationElement> 对象的完整树，该树的根元素是桌面。</span><span class="sxs-lookup"><span data-stu-id="315e0-125">The raw view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree is the full tree of <xref:System.Windows.Automation.AutomationElement> objects for which the desktop is the root.</span></span> <span data-ttu-id="315e0-126">原始视图完全遵循应用程序的本机编程结构，因此是最详细的可用视图。</span><span class="sxs-lookup"><span data-stu-id="315e0-126">The raw view closely follows the native programmatic structure of an application and therefore is the most detailed view available.</span></span> <span data-ttu-id="315e0-127">原始视图还是其他树视图的生成基础。</span><span class="sxs-lookup"><span data-stu-id="315e0-127">It is also the base on which the other views of the tree are built.</span></span> <span data-ttu-id="315e0-128">由于原始视图取决于基础 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 框架，因此 [!INCLUDE[TLA2#tla_winclient](../../../includes/tla2sharptla-winclient-md.md)] 按钮的原始视图将与 [!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)] 按钮的原始视图不同。</span><span class="sxs-lookup"><span data-stu-id="315e0-128">Because this view depends on the underlying [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] framework, the raw view of a [!INCLUDE[TLA2#tla_winclient](../../../includes/tla2sharptla-winclient-md.md)] button will have a different raw view than a [!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)] button.</span></span>  
  
 <span data-ttu-id="315e0-129">原始视图是通过以下方法来获取的：在不指定属性的情况下搜索元素，或者使用 <xref:System.Windows.Automation.TreeWalker.RawViewWalker> 在树中导航。</span><span class="sxs-lookup"><span data-stu-id="315e0-129">The raw view is obtained by searching for elements without specifying properties or by using the <xref:System.Windows.Automation.TreeWalker.RawViewWalker> to navigate the tree.</span></span>  
  
<a name="uiautomation_control_view"></a>   
### <a name="control-view"></a><span data-ttu-id="315e0-130">控件视图</span><span class="sxs-lookup"><span data-stu-id="315e0-130">Control View</span></span>  
 <span data-ttu-id="315e0-131">由于 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 树的控件视图紧密映射到由最终用户查看的 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 结构，因此它能使辅助技术产品更轻松地完成向最终用户描述 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 并帮助最终用户与应用程序交互的任务。</span><span class="sxs-lookup"><span data-stu-id="315e0-131">The control view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree simplifies the assistive technology product's task of describing the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] to the end user and helping that end user interact with the application because it closely maps to the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] structure perceived by an end user.</span></span>  
  
 <span data-ttu-id="315e0-132">控件视图是原始视图的子集。</span><span class="sxs-lookup"><span data-stu-id="315e0-132">The control view is a subset of the raw view.</span></span> <span data-ttu-id="315e0-133">它包括原始视图中的所有 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 项，最终用户会将这些项理解为 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 中控件逻辑结构的交互式项或构成项。</span><span class="sxs-lookup"><span data-stu-id="315e0-133">It includes all [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] items from the raw view that an end user would understand as interactive or contributing to the logical structure of the control in the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="315e0-134">例如，列表视图标题、工具栏、菜单和状态栏等项容器构成了 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 的逻辑结构，但其本身并不是交互式 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 项。</span><span class="sxs-lookup"><span data-stu-id="315e0-134">Examples of [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] items that contribute to the logical structure of the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)], but are not interactive themselves, are item containers such as list view headers, toolbars, menus, and the status bar.</span></span> <span data-ttu-id="315e0-135">仅针对布局或修饰目的而使用的非交互式项将不会显示在控件视图中。</span><span class="sxs-lookup"><span data-stu-id="315e0-135">Non-interactive items used simply for layout or decorative purposes will not be seen in the control view.</span></span> <span data-ttu-id="315e0-136">仅为了将控件放置在对话框中而本身不包含任何信息的面板就是这样的项。</span><span class="sxs-lookup"><span data-stu-id="315e0-136">An example is a panel that was used only to lay out the controls in a dialog but does not itself contain any information.</span></span> <span data-ttu-id="315e0-137">对话框中包含信息和静态文本的图形是在控件视图中显示的非交互式项。</span><span class="sxs-lookup"><span data-stu-id="315e0-137">Non-interactive items that will be seen in the control view are graphics with information and static text in a dialog.</span></span> <span data-ttu-id="315e0-138">控件视图中包括的非交互式项不能接收键盘焦点。</span><span class="sxs-lookup"><span data-stu-id="315e0-138">Non-interactive items that are included in the control view cannot receive keyboard focus.</span></span>  
  
 <span data-ttu-id="315e0-139">控件视图是通过以下方法获取的：搜索 <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> 属性设置为 `true` 的元素，或者使用 <xref:System.Windows.Automation.TreeWalker.ControlViewWalker> 在树中导航。</span><span class="sxs-lookup"><span data-stu-id="315e0-139">The control view is obtained by searching for elements that have the <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> property set to `true`, or by using the <xref:System.Windows.Automation.TreeWalker.ControlViewWalker> to navigate the tree.</span></span>  
  
<a name="uiautomation_content_view"></a>   
### <a name="content-view"></a><span data-ttu-id="315e0-140">内容视图</span><span class="sxs-lookup"><span data-stu-id="315e0-140">Content View</span></span>  
 <span data-ttu-id="315e0-141">
  [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 树的内容视图是控件视图的子集。</span><span class="sxs-lookup"><span data-stu-id="315e0-141">The content view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree is a subset of the control view.</span></span> <span data-ttu-id="315e0-142">内容视图中包含用来在用户界面中传达真正信息的 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 项（包括可以接收键盘焦点的 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 项，以及一些不是 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 项标签的文本）。</span><span class="sxs-lookup"><span data-stu-id="315e0-142">It contains [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] items that convey the true information in a user interface, including [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] items that can receive keyboard focus and some text that is not a label on a [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] item.</span></span> <span data-ttu-id="315e0-143">例如，下拉组合框中的值将出现在内容视图中，因为它们表示正由最终用户使用的信息。</span><span class="sxs-lookup"><span data-stu-id="315e0-143">For example, the values in a drop-down combo box will appear in the content view because they represent the information being used by an end user.</span></span> <span data-ttu-id="315e0-144">在内容视图中，组合框和列表框均表示为 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 项的集合，在该集合中，可以有一项（或多项）处于选中状态。</span><span class="sxs-lookup"><span data-stu-id="315e0-144">In the content view, a combo box and list box are both represented as a collection of [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] items where one, or perhaps more than one, item can be selected.</span></span> <span data-ttu-id="315e0-145">由于内容视图旨在显示要呈现给用户的数据或内容，因此，内容视图中不存在如下情况：始终有一项处于打开状态，而另有一项是可以展开和折叠的。</span><span class="sxs-lookup"><span data-stu-id="315e0-145">The fact that one is always open and one can expand and collapse is irrelevant in the content view because it is designed to show the data, or content, that is being presented to the user.</span></span>  
  
 <span data-ttu-id="315e0-146">内容视图是通过以下方法获取的：搜索 <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> 属性设置为 `true` 的元素，或者使用 <xref:System.Windows.Automation.TreeWalker.ContentViewWalker> 在树中导航。</span><span class="sxs-lookup"><span data-stu-id="315e0-146">The content view is obtained by searching for elements that have the <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> property set to `true`, or by using the <xref:System.Windows.Automation.TreeWalker.ContentViewWalker> to navigate the tree.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="315e0-147">请参阅</span><span class="sxs-lookup"><span data-stu-id="315e0-147">See also</span></span>
- <xref:System.Windows.Automation.AutomationElement>
- [<span data-ttu-id="315e0-148">UI 自动化概述</span><span class="sxs-lookup"><span data-stu-id="315e0-148">UI Automation Overview</span></span>](../../../docs/framework/ui-automation/ui-automation-overview.md)
