---
title: 将容器作为 DevOps 协作的基础
description: 了解容器在简化 DevOps 方面的关键作用。
ms.date: 02/15/2019
ms.openlocfilehash: 37faf00f270414df363f36894317f31f81a2937e
ms.sourcegitcommit: 5bc85ad81d96b8dc2a90ce53bada475ee5662c44
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/13/2019
ms.locfileid: "65641285"
---
# <a name="containers-as-the-foundation-for-devops-collaboration"></a>将容器作为 DevOps 协作的基础

根据容器和 Docker 技术的本质，开发人员可以轻松地与 IT 操作和生产环境共享他们的软件和依赖项，同时消除典型的“适用于计算机”的借口。 容器可解决不同环境之间的应用程序冲突。 容器和 Docker 间接地将开发人员和 IT 运营更紧密地结合在一起，使他们更能高效地协作。 采用容器工作流可为许多客户提供他们所寻求的 DevOps 连续性，但之前必须通过更复杂的配置来实现发布和生成管道。 容器可简化 DevOps 中的生成/测试/部署管道。

![Docker 为开发人员和架构师在开发/设计工作负载和运行/监视/管理工作负载中的 IT 运营方面提供了便利。](./media/image1.png)

**图 2-1.** 容器化 Docker 应用程序生命周期中每个“角色”的主要工作负载

使用 Docker 容器，开发人员拥有容器内的内容（应用程序和服务，以及对框架和组件的依赖项）以及容器和服务如何作为由一组服务组成的应用程序一起运行。 多个容器的相互依赖项在 `docker-compose.yml` 文件中定义，或者可以称为部署清单  。 同时，IT 运营团队（IT 专业人员和管理人员）可以专注于生产环境的管理、基础设施、可伸缩性、监视，并最终确保将应用程序正确交付给最终用户，而无需知道各种容器的内容。 因此“容器”一词就好比现实世界的运输容器。 容器内容的所有者不需要考虑容器的运算方式，运输公司会将容器从其原点运输到其目的地，而无需了解或关注容器的内容。 以类似的方式，开发人员可以在 Docker 容器中创建和拥有内容，而无需在意“传输”机制。

在图 2-1 左侧的支柱中，开发人员在本地使用用于 Windows 或 Mac 的 Docker 在 Docker 容器中编写和运行代码。 它们通过使用指定要运行的基本操作系统的 Dockerfile 以及将代码构建到 Docker 映像的构建步骤来定义代码的操作环境。 开发人员使用上述 `docker-compose.yml` 文件部署清单定义一个或多个映像的交互操作方式。 完成本地开发后，他们将应用程序代码和 Docker 配置文件推送到所选择的代码库（即 Git 存储库）中。

DevOps 支柱使用代码存储库中提供的 Dockerfile 定义构建 - 持续集成 (CI) 管道。 CI 系统从选定的 Docker 注册表中提取基础容器映像，并为应用程序构建自定义 Docker 映像。 然后验证这些映像，并将其推送到用于部署到多个环境的 Docker 注册表。

在右侧的支柱中，运营团队管理生产中部署的应用程序和基础结构，同时监视环境和应用程序，以便他们可以向开发团队提供有关如何改进应用程序的反馈和见解。 容器应用通常使用容器业务流程协调程序在生产环境中运行。

这两个团队通过将关注点分离为协定的基础平台（Docker 容器）进行协作，同时极大地提高了两个团队在应用程序生命周期中的协作能力。 开发人员拥有容器内容、其操作环境和容器相互依赖项，而运营团队将构建的映像与清单一起使用，并在其业务流程系统中加以执行。

## <a name="challenges-in-application-life-cycle-when-using-docker"></a>使用 Docker 时，应用程序生命周期中存在的难题。

在未来几年中，有多种原因导致容器化应用程序数量的增加，其中一个原因是基于微服务创建应用程序。

在过去的 15 年中，使用 Web 服务是构建数千个应用程序的基础，并且可能在几年之后，我们将发现在 Docker 容器上运行的基于微服务的应用程序具有相同的情况。

还值得一提的是，也可以将 Docker 容器用于整体式应用程序，且仍可获得 Docker 的大部分好处。 容器并非仅面向微服务。

使用 Docker 容器化和微服务会给组织的开发过程带来新的挑战。因此，需要使用一个可靠的策略，才能维护在生产系统上运行的多个容器和微服务。 最终，企业应用程序将在生产中运行数百或数千个容器/实例。

这些挑战在使用 DevOps 工具时创造了新的需求，因此必须在 DevOps 活动中定义新流程，并找到此类问题的答案：

- 可以使用哪些工具进行开发、CI/CD、管理和运营？

- 公司如何在生产中运行时管理容器中的错误？

- 如何在最短的停机时间内更改生产中的软件？

- 如何缩放和监视生产系统？

- 如何在发布管道中包含容器的测试和部署？

- 如何在 Microsoft Azure 中为容器使用开放源代码工具/平台？

如果可以回答所有这些问题，那么你已做好充分准备将应用程序（现有或新应用）移动到 Docker 容器。 

## <a name="introduction-to-a-generic-end-to-end-docker-application-life-cycle-workflow"></a>泛型端到端 Docker 应用程序生命周期工作流的简介

图 2-2 详细介绍了 Docker 应用程序生命周期工作流，在本示例中，重点介绍了特定 DevOps 活动和资产。

![下图显示了 DevOps 的“外部循环”。 将代码推送到存储库时，将启动 CI 管道，然后启动 CD 管道，在该管道中部署应用程序。 从已部署的应用程序中收集的指标将反馈到在其中发生“内部循环”的开发工作负载中，因此开发团队拥有实际数据来响应用户和业务需求。](./media/image2.png)

**图 2-2。** Docker 容器化应用程序生命周期的高级工作流

一切都始于开发人员，该人员开始在内部循环工作流中编写代码。 内部循环阶段即开发人员在将代码推送到代码存储库之前定义发生的所有事情（例如，Git 等源代码管理系统）。 提交后，存储库触发持续集成 (CI) 和工作流的其余部分。

内部循环基本上包括典型的步骤（“代码”、“运行”、“测试”和“调试”等）以及在本地运行应用之前所需的其他步骤。 这是开发人员运行和测试作为 Docker 容器的应用的过程。 内部循环工作流将在后面的章节中介绍。

回过头来查看端到端工作流，DevOps 工作流不只是一项技术或工具集：它是一种需要文化演变的思维方式。 它是人员、流程和恰当工具，可以使应用程序生命周期更快且更可预测。 采用容器化工作流的企业通常会对其组织进行重组，以表示与容器化工作流相匹配的人员和流程。

实践 DevOps 可以帮助团队更快地响应竞争压力，方法是以自动化功能替代容易出错的手动流程，从而改进可追溯性和可重复的工作流。 通过结合本地和云资源以及紧密集成的工具，组织还可以更加有效地管理环境并实现成本节约。

在为 Docker 应用程序实现 DevOps 工作流时，你将看到 Docker 技术几乎存在于工作流的每个阶段。在处理内部循环（代码、运行、调试）时，从开发框开始，构建测试 CI 阶段，最后将这些容器部署到暂存和生产环境。

质量做法的改进有助于在开发周期的早期识别缺陷，从而降低修复它们的成本。 通过在映像中包含环境和依赖项并采用在多个环境中部署相同映像的理念，可以促进提取特定于环境的配置的规则，从而使部署更加可靠。

通过有效的仪器（监视和诊断）获得的丰富数据可以深入了解性能问题和用户行为，从而指导未来的优先事项和投资。

DevOps 应视为旅程，而不是目的地。 它应通过适当范围的项目逐步实施，其中可以展示成功、学习和发展。

## <a name="benefits-of-devops-for-containerized-applications"></a>容器化应用程序 DevOps 的优势

以下是可靠的 DevOps 工作流提供的一些最重要的好处：

- 更快地提供更高质量的软件且符合性更加。

- 更早、更经济实惠地推动持续改进和调整。

- 提高参与交付和运营软件的利益干系人之间的透明度和协作。

- 控制成本且更有效地利用预配资源，同时将安全风险降至最低。

- 即插即用多个现有 DevOps 投资，包括对开放源代码的投资。

>[!div class="step-by-step"]
>[上一页](index.md)
>[下一页](../Microsoft-platform-tools-containerized-apps/index.md)
